==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=20, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/pretrained/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='logs/dbscan/market2duke', log_name='', HC=True, UCIS=True)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
/hgst/longdn/UCF-main/data/market1501/Market-1501-v15.09.15/bounding_box_test
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/pretrained/market2duke/model_best.pth.tar'
missing keys in state_dict: {'classifier0_32621.weight'}
missing keys in state_dict: {'classifier0_32621.weight'}
load pretrain model:/hgst/longdn/UCF-main/logs/pretrained/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.170)	Data 0.000 (0.003)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.77267861366272
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.154 (0.158)	Data 0.000 (0.003)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.80538535118103
The orignal cluster result: num cluster = 1038(model) // 1038(model_ema) 	 num outliers = 4076(model) // 4076(model_ema)
Applying hierarchical clustering
[859 615 734 ...  -1 573 922]
(16522,)
(array([    3,     4,     6, ..., 16509, 16515, 16519]),)
(16522, 16522)
(12446, 16522)
(12446, 12446)
reCluster!use silhouette score and tao=0.0
each uncer num= [21, 6, 12] average= 13.0 uncer_average= -0.1537261
reCluster!use silhouette score and tao=0.0
each uncer num= [21, 6, 12] average= 13.0 uncer_average= -0.1537261
HC finish! Cost time=1.4358458518981934s
The HC Re-cluster result: num cluster = 1038(model) // 1038(model_ema) 	 num outliers = 4076(model) // 4076(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.6633102893829346s
The UCIS result: num clean cluster = 1038(model) 	 num outliers = 4076(model)
mdoel:new class are [1039], length of new dataset is 12446
Epoch: [0][0/300]	Time 4.691 (4.691)	Data 0.126 (0.126)	Loss_ce_clean 1.048 	Loss_ct_clean 0.945 	Prec 84.38%
Epoch: [0][50/300]	Time 0.769 (0.848)	Data 0.101 (0.103)	Loss_ce_clean 0.754 	Loss_ct_clean 0.978 	Prec 89.14%
Epoch: [0][100/300]	Time 0.772 (0.809)	Data 0.103 (0.102)	Loss_ce_clean 0.665 	Loss_ct_clean 1.120 	Prec 90.86%
Epoch: [0][150/300]	Time 0.771 (0.796)	Data 0.101 (0.102)	Loss_ce_clean 0.613 	Loss_ct_clean 1.096 	Prec 91.85%
Epoch: [0][200/300]	Time 0.765 (0.790)	Data 0.096 (0.102)	Loss_ce_clean 0.576 	Loss_ct_clean 1.059 	Prec 92.53%
Epoch: [0][250/300]	Time 0.769 (0.786)	Data 0.100 (0.102)	Loss_ce_clean 0.551 	Loss_ct_clean 1.026 	Prec 93.00%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.876393795013428
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.982349157333374
The orignal cluster result: num cluster = 1192(model) // 1159(model_ema) 	 num outliers = 2397(model) // 2685(model_ema)
Applying hierarchical clustering
[  -1 1109  669 ...   -1  698 1043]
(16522,)
(array([    0,     4,     6, ..., 16495, 16515, 16519]),)
(16522, 16522)
(14125, 16522)
(14125, 14125)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=1.78936767578125s
The HC Re-cluster result: num cluster = 1192(model) // 1159(model_ema) 	 num outliers = 2397(model) // 2685(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8240487575531006s
The UCIS result: num clean cluster = 1076(model) 	 num outliers = 4454(model)
mdoel:new class are [1077], length of new dataset is 12068
Epoch: [1][0/300]	Time 0.831 (0.831)	Data 0.157 (0.157)	Loss_ce_clean 0.248 	Loss_ct_clean 0.205 	Prec 96.09%
Epoch: [1][50/300]	Time 0.799 (0.812)	Data 0.130 (0.143)	Loss_ce_clean 0.264 	Loss_ct_clean 0.382 	Prec 96.74%
Epoch: [1][100/300]	Time 0.780 (0.801)	Data 0.111 (0.132)	Loss_ce_clean 0.252 	Loss_ct_clean 0.551 	Prec 97.12%
Epoch: [1][150/300]	Time 0.791 (0.795)	Data 0.122 (0.126)	Loss_ce_clean 0.242 	Loss_ct_clean 0.583 	Prec 97.29%
Epoch: [1][200/300]	Time 0.784 (0.791)	Data 0.114 (0.122)	Loss_ce_clean 0.237 	Loss_ct_clean 0.594 	Prec 97.34%
Epoch: [1][250/300]	Time 0.775 (0.788)	Data 0.106 (0.119)	Loss_ce_clean 0.228 	Loss_ct_clean 0.585 	Prec 97.49%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.91498351097107
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.164)	Data 0.000 (0.009)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.031373500823975
The orignal cluster result: num cluster = 1232(model) // 1206(model_ema) 	 num outliers = 1818(model) // 2251(model_ema)
Applying hierarchical clustering
[  -1  591  959 ...  753  488 1118]
(16522,)
(array([    0,     4,     6, ..., 16500, 16507, 16515]),)
(16522, 16522)
(14704, 16522)
(14704, 14704)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [6] average= 6.0 uncer_average= -0.08367771
HC finish! Cost time=1.766498327255249s
The HC Re-cluster result: num cluster = 1232(model) // 1206(model_ema) 	 num outliers = 1818(model) // 2251(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8322932720184326s
The UCIS result: num clean cluster = 1106(model) 	 num outliers = 4047(model)
mdoel:new class are [1107], length of new dataset is 12475
Epoch: [2][0/300]	Time 0.785 (0.785)	Data 0.112 (0.112)	Loss_ce_clean 0.176 	Loss_ct_clean 0.138 	Prec 99.22%
Epoch: [2][50/300]	Time 0.774 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.186 	Loss_ct_clean 0.274 	Prec 98.01%
Epoch: [2][100/300]	Time 0.775 (0.773)	Data 0.106 (0.104)	Loss_ce_clean 0.186 	Loss_ct_clean 0.417 	Prec 97.89%
Epoch: [2][150/300]	Time 0.775 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.179 	Loss_ct_clean 0.454 	Prec 98.05%
Epoch: [2][200/300]	Time 0.774 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.177 	Loss_ct_clean 0.466 	Prec 98.11%
Epoch: [2][250/300]	Time 0.774 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.171 	Loss_ct_clean 0.465 	Prec 98.21%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.778390645980835
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.918249130249023
The orignal cluster result: num cluster = 1262(model) // 1223(model_ema) 	 num outliers = 1449(model) // 1917(model_ema)
Applying hierarchical clustering
[  -1  710  442 ...  845  489 1001]
(16522,)
(array([    0,     4,    19, ..., 16475, 16507, 16515]),)
(16522, 16522)
(15073, 16522)
(15073, 15073)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=1.9198026657104492s
The HC Re-cluster result: num cluster = 1262(model) // 1223(model_ema) 	 num outliers = 1449(model) // 1917(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8474626541137695s
The UCIS result: num clean cluster = 1138(model) 	 num outliers = 3595(model)
mdoel:new class are [1139], length of new dataset is 12927
Epoch: [3][0/300]	Time 0.787 (0.787)	Data 0.116 (0.116)	Loss_ce_clean 0.098 	Loss_ct_clean 0.076 	Prec 100.00%
Epoch: [3][50/300]	Time 0.775 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.165 	Loss_ct_clean 0.229 	Prec 97.96%
Epoch: [3][100/300]	Time 0.770 (0.774)	Data 0.101 (0.105)	Loss_ce_clean 0.159 	Loss_ct_clean 0.358 	Prec 97.97%
Epoch: [3][150/300]	Time 0.782 (0.773)	Data 0.113 (0.104)	Loss_ce_clean 0.155 	Loss_ct_clean 0.392 	Prec 98.10%
Epoch: [3][200/300]	Time 0.770 (0.773)	Data 0.101 (0.104)	Loss_ce_clean 0.151 	Loss_ct_clean 0.407 	Prec 98.18%
Epoch: [3][250/300]	Time 0.774 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.148 	Loss_ct_clean 0.414 	Prec 98.27%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.832860708236694
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.907621622085571
The orignal cluster result: num cluster = 1292(model) // 1237(model_ema) 	 num outliers = 1374(model) // 1709(model_ema)
Applying hierarchical clustering
[1157  238  927 ... 1110 1045 1105]
(16522,)
(array([    7,    10,    19, ..., 16474, 16507, 16515]),)
(16522, 16522)
(15148, 16522)
(15148, 15148)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=1.9061741828918457s
The HC Re-cluster result: num cluster = 1292(model) // 1237(model_ema) 	 num outliers = 1374(model) // 1709(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.844245195388794s
The UCIS result: num clean cluster = 1189(model) 	 num outliers = 3165(model)
mdoel:new class are [1190], length of new dataset is 13357
Epoch: [4][0/300]	Time 0.795 (0.795)	Data 0.124 (0.124)	Loss_ce_clean 0.146 	Loss_ct_clean 0.126 	Prec 96.88%
Epoch: [4][50/300]	Time 0.775 (0.773)	Data 0.106 (0.104)	Loss_ce_clean 0.135 	Loss_ct_clean 0.187 	Prec 98.28%
Epoch: [4][100/300]	Time 0.781 (0.773)	Data 0.112 (0.104)	Loss_ce_clean 0.135 	Loss_ct_clean 0.324 	Prec 98.41%
Epoch: [4][150/300]	Time 0.777 (0.773)	Data 0.108 (0.104)	Loss_ce_clean 0.134 	Loss_ct_clean 0.363 	Prec 98.46%
Epoch: [4][200/300]	Time 0.774 (0.773)	Data 0.104 (0.104)	Loss_ce_clean 0.132 	Loss_ct_clean 0.376 	Prec 98.52%
Epoch: [4][250/300]	Time 0.774 (0.774)	Data 0.105 (0.104)	Loss_ce_clean 0.131 	Loss_ct_clean 0.381 	Prec 98.57%
Extract Features: [100/156]	Time 0.155 (0.250)	Data 0.000 (0.096)	
Mean AP: 51.6%
CMC Scores:
  top-1          68.4%
  top-5          79.5%
  top-10         83.5%
Extract Features: [100/156]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Mean AP: 50.0%
CMC Scores:
  top-1          66.5%
  top-5          78.5%
  top-10         82.5%

 * Finished epoch   4  model no.1 mAP: 51.6% model no.2(mean-net) mAP: 50.0%  best: 51.6% *

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.163)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.775878667831421
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.879321098327637
The orignal cluster result: num cluster = 1325(model) // 1270(model_ema) 	 num outliers = 1219(model) // 1493(model_ema)
Applying hierarchical clustering
[1025  349  348 ... 1143  651 1213]
(16522,)
(array([    6,     7,    19, ..., 16474, 16507, 16515]),)
(16522, 16522)
(15303, 16522)
(15303, 15303)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.0399248600006104s
The HC Re-cluster result: num cluster = 1325(model) // 1270(model_ema) 	 num outliers = 1219(model) // 1493(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8418114185333252s
The UCIS result: num clean cluster = 1239(model) 	 num outliers = 2745(model)
mdoel:new class are [1240], length of new dataset is 13777
Epoch: [5][0/300]	Time 0.784 (0.784)	Data 0.112 (0.112)	Loss_ce_clean 0.155 	Loss_ct_clean 0.133 	Prec 99.22%
Epoch: [5][50/300]	Time 0.773 (0.774)	Data 0.104 (0.104)	Loss_ce_clean 0.136 	Loss_ct_clean 0.181 	Prec 98.33%
Epoch: [5][100/300]	Time 0.778 (0.774)	Data 0.108 (0.104)	Loss_ce_clean 0.133 	Loss_ct_clean 0.310 	Prec 98.45%
Epoch: [5][150/300]	Time 0.773 (0.774)	Data 0.104 (0.104)	Loss_ce_clean 0.128 	Loss_ct_clean 0.347 	Prec 98.58%
Epoch: [5][200/300]	Time 0.775 (0.774)	Data 0.105 (0.104)	Loss_ce_clean 0.125 	Loss_ct_clean 0.356 	Prec 98.64%
Epoch: [5][250/300]	Time 0.778 (0.774)	Data 0.108 (0.104)	Loss_ce_clean 0.123 	Loss_ct_clean 0.359 	Prec 98.72%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.803736925125122
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.914245367050171
The orignal cluster result: num cluster = 1350(model) // 1291(model_ema) 	 num outliers = 1034(model) // 1311(model_ema)
Applying hierarchical clustering
[ 916  771  757 ... 1242  763 1236]
(16522,)
(array([    7,    10,    19, ..., 16499, 16505, 16515]),)
(16522, 16522)
(15488, 16522)
(15488, 15488)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.949549674987793s
The HC Re-cluster result: num cluster = 1350(model) // 1291(model_ema) 	 num outliers = 1034(model) // 1311(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8333375453948975s
The UCIS result: num clean cluster = 1277(model) 	 num outliers = 2465(model)
mdoel:new class are [1278], length of new dataset is 14057
Epoch: [6][0/300]	Time 0.785 (0.785)	Data 0.114 (0.114)	Loss_ce_clean 0.135 	Loss_ct_clean 0.119 	Prec 96.88%
Epoch: [6][50/300]	Time 0.777 (0.774)	Data 0.107 (0.105)	Loss_ce_clean 0.120 	Loss_ct_clean 0.153 	Prec 98.58%
Epoch: [6][100/300]	Time 0.773 (0.775)	Data 0.104 (0.105)	Loss_ce_clean 0.119 	Loss_ct_clean 0.268 	Prec 98.57%
Epoch: [6][150/300]	Time 0.771 (0.774)	Data 0.101 (0.105)	Loss_ce_clean 0.118 	Loss_ct_clean 0.311 	Prec 98.61%
Epoch: [6][200/300]	Time 0.773 (0.774)	Data 0.104 (0.105)	Loss_ce_clean 0.117 	Loss_ct_clean 0.329 	Prec 98.68%
Epoch: [6][250/300]	Time 0.776 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.116 	Loss_ct_clean 0.338 	Prec 98.71%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.846162557601929
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.232235193252563
The orignal cluster result: num cluster = 1374(model) // 1319(model_ema) 	 num outliers = 982(model) // 1255(model_ema)
Applying hierarchical clustering
[ 772 1060  375 ... 1225  804 1264]
(16522,)
(array([   23,    42,    66,    68,    75,    83,    85,    97,   104,
         114,   161,   171,   188,   199,   213,   220,   241,   248,
         269,   271,   287,   341,   383,   394,   400,   412,   414,
         417,   422,   431,   436,   437,   443,   455,   460,   464,
         480,   495,   506,   513,   519,   524,   530,   546,   580,
         632,   637,   643,   672,   676,   677,   689,   714,   728,
         743,   752,   754,   799,   808,   827,   828,   832,   851,
         853,   854,   861,   905,   911,   913,   986,   997,  1020,
        1037,  1059,  1085,  1097,  1149,  1154,  1162,  1197,  1205,
        1209,  1222,  1263,  1317,  1319,  1354,  1374,  1396,  1402,
        1413,  1439,  1460,  1471,  1473,  1494,  1528,  1573,  1587,
        1605,  1618,  1631,  1644,  1654,  1672,  1675,  1685,  1734,
        1738,  1741,  1776,  1780,  1783,  1814,  1819,  1833,  1856,
        1871,  1931,  1944,  1983,  1984,  1998,  2039,  2101,  2127,
        2147,  2148,  2160,  2179,  2182,  2185,  2205,  2216,  2236,
        2241,  2248,  2282,  2297,  2299,  2300,  2330,  2356,  2385,
        2406,  2431,  2437,  2438,  2465,  2482,  2501,  2519,  2526,
        2532,  2535,  2564,  2567,  2569,  2585,  2612,  2680,  2684,
        2703,  2710,  2725,  2756,  2769,  2770,  2783,  2786,  2796,
        2814,  2818,  2819,  2822,  2871,  2876,  2880,  2889,  2897,
        2947,  2971,  2986,  3015,  3027,  3036,  3050,  3059,  3073,
        3090,  3105,  3107,  3117,  3121,  3129,  3157,  3167,  3180,
        3189,  3202,  3208,  3223,  3271,  3280,  3311,  3330,  3414,
        3426,  3434,  3437,  3446,  3448,  3454,  3492,  3502,  3544,
        3570,  3575,  3598,  3608,  3615,  3641,  3655,  3670,  3677,
        3685,  3713,  3716,  3749,  3764,  3794,  3815,  3817,  3848,
        3887,  3906,  3908,  3933,  3947,  3951,  4022,  4061,  4065,
        4094,  4105,  4106,  4143,  4156,  4160,  4199,  4209,  4221,
        4236,  4242,  4248,  4249,  4251,  4254,  4296,  4312,  4319,
        4324,  4334,  4360,  4373,  4393,  4410,  4424,  4429,  4433,
        4438,  4448,  4477,  4487,  4499,  4539,  4566,  4609,  4628,
        4632,  4637,  4638,  4651,  4657,  4676,  4682,  4685,  4695,
        4738,  4747,  4751,  4753,  4777,  4848,  4876,  4899,  4914,
        4920,  4924,  4938,  4939,  5023,  5053,  5082,  5084,  5094,
        5107,  5108,  5117,  5134,  5141,  5148,  5180,  5184,  5199,
        5220,  5232,  5239,  5265,  5267,  5277,  5298,  5304,  5306,
        5320,  5350,  5362,  5367,  5379,  5386,  5407,  5418,  5420,
        5440,  5458,  5465,  5472,  5474,  5492,  5513,  5540,  5545,
        5546,  5567,  5575,  5577,  5578,  5585,  5602,  5613,  5637,
        5659,  5669,  5702,  5712,  5730,  5777,  5795,  5813,  5816,
        5838,  5848,  5849,  5852,  5894,  5913,  5934,  5945,  5949,
        5972,  5995,  6004,  6028,  6035,  6060,  6067,  6080,  6082,
        6095,  6113,  6128,  6132,  6134,  6144,  6174,  6181,  6194,
        6208,  6225,  6238,  6253,  6271,  6316,  6319,  6366,  6385,
        6389,  6410,  6447,  6448,  6491,  6531,  6540,  6568,  6573,
        6574,  6629,  6632,  6666,  6696,  6721,  6758,  6761,  6788,
        6803,  6818,  6820,  6825,  6827,  6859,  6860,  6874,  6876,
        6898,  6946,  6956,  6964,  7035,  7045,  7069,  7071,  7105,
        7110,  7145,  7162,  7188,  7214,  7218,  7307,  7309,  7321,
        7323,  7371,  7378,  7382,  7383,  7387,  7389,  7395,  7440,
        7473,  7492,  7506,  7513,  7515,  7533,  7538,  7560,  7564,
        7565,  7575,  7595,  7612,  7625,  7630,  7631,  7632,  7655,
        7674,  7682,  7696,  7725,  7732,  7752,  7763,  7765,  7796,
        7831,  7844,  7858,  7860,  7882,  7919,  7960,  7967,  7980,
        7985,  8033,  8046,  8059,  8068,  8101,  8129,  8134,  8173,
        8203,  8215,  8222,  8227,  8232,  8237,  8263,  8285,  8299,
        8319,  8335,  8340,  8373,  8392,  8458,  8464,  8471,  8473,
        8487,  8491,  8497,  8525,  8528,  8548,  8557,  8568,  8576,
        8577,  8579,  8609,  8638,  8657,  8662,  8679,  8688,  8705,
        8746,  8756,  8775,  8778,  8780,  8787,  8799,  8818,  8821,
        8847,  8880,  8884,  8893,  8894,  8926,  8931,  8946,  8966,
        8971,  8973,  9029,  9039,  9049,  9057,  9059,  9081,  9107,
        9136,  9159,  9181,  9218,  9250,  9276,  9282,  9328,  9354,
        9360,  9398,  9404,  9416,  9471,  9483,  9485,  9486,  9497,
        9504,  9528,  9529,  9531,  9535,  9539,  9554,  9562,  9575,
        9590,  9600,  9609,  9629,  9645,  9679,  9696,  9725,  9754,
        9759,  9792,  9794,  9810,  9835,  9838,  9854,  9897,  9930,
        9936,  9941,  9944,  9961, 10007, 10034, 10035, 10047, 10052,
       10060, 10070, 10076, 10077, 10078, 10105, 10140, 10149, 10154,
       10164, 10177, 10205, 10213, 10215, 10233, 10271, 10274, 10275,
       10281, 10304, 10306, 10337, 10345, 10350, 10351, 10353, 10368,
       10408, 10435, 10445, 10453, 10457, 10459, 10460, 10479, 10482,
       10484, 10493, 10507, 10533, 10535, 10540, 10593, 10627, 10629,
       10642, 10665, 10693, 10697, 10701, 10750, 10762, 10764, 10770,
       10794, 10821, 10825, 10846, 10854, 10877, 10923, 10932, 10933,
       10946, 10973, 11002, 11009, 11049, 11059, 11090, 11092, 11112,
       11116, 11117, 11132, 11195, 11224, 11226, 11230, 11262, 11297,
       11317, 11324, 11341, 11354, 11359, 11420, 11472, 11496, 11514,
       11545, 11553, 11579, 11605, 11610, 11619, 11686, 11701, 11723,
       11724, 11790, 11830, 11845, 11849, 11858, 11869, 11874, 11883,
       11900, 11912, 11929, 11939, 11943, 11972, 12031, 12079, 12094,
       12148, 12154, 12178, 12184, 12212, 12226, 12231, 12234, 12317,
       12339, 12340, 12376, 12394, 12414, 12434, 12438, 12441, 12449,
       12453, 12458, 12466, 12472, 12477, 12478, 12510, 12513, 12550,
       12557, 12576, 12602, 12628, 12655, 12658, 12661, 12665, 12681,
       12688, 12699, 12715, 12721, 12743, 12759, 12802, 12823, 12845,
       12916, 12974, 12980, 12986, 13000, 13035, 13051, 13063, 13072,
       13076, 13082, 13102, 13110, 13120, 13136, 13159, 13160, 13162,
       13167, 13190, 13200, 13213, 13224, 13235, 13238, 13242, 13260,
       13292, 13296, 13300, 13303, 13320, 13337, 13352, 13388, 13407,
       13409, 13441, 13444, 13462, 13467, 13489, 13511, 13519, 13528,
       13558, 13597, 13601, 13615, 13619, 13620, 13625, 13644, 13648,
       13677, 13680, 13709, 13724, 13728, 13734, 13742, 13776, 13795,
       13841, 13890, 13893, 13976, 13991, 13999, 14037, 14039, 14052,
       14088, 14121, 14124, 14147, 14164, 14174, 14220, 14222, 14226,
       14255, 14258, 14266, 14284, 14327, 14349, 14371, 14374, 14412,
       14421, 14425, 14461, 14506, 14508, 14520, 14534, 14559, 14567,
       14579, 14593, 14594, 14604, 14616, 14634, 14675, 14680, 14727,
       14743, 14761, 14812, 14865, 14898, 14905, 14921, 14933, 14935,
       14970, 14974, 14982, 14983, 14985, 14988, 14997, 15005, 15037,
       15041, 15053, 15056, 15084, 15090, 15100, 15111, 15112, 15141,
       15161, 15166, 15182, 15194, 15197, 15213, 15229, 15245, 15257,
       15258, 15272, 15287, 15295, 15324, 15340, 15391, 15393, 15402,
       15406, 15424, 15427, 15443, 15482, 15484, 15524, 15575, 15592,
       15597, 15613, 15653, 15667, 15678, 15712, 15731, 15752, 15774,
       15851, 15912, 15932, 15950, 15963, 15969, 15978, 15995, 16020,
       16033, 16058, 16086, 16121, 16130, 16174, 16191, 16202, 16206,
       16211, 16218, 16235, 16238, 16240, 16251, 16259, 16290, 16292,
       16334, 16361, 16431, 16436, 16449, 16465, 16467, 16474, 16507,
       16515]),)
(16522, 16522)
(15540, 16522)
(15540, 15540)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.47633957862854s
The HC Re-cluster result: num cluster = 1374(model) // 1319(model_ema) 	 num outliers = 982(model) // 1255(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9332168102264404s
The UCIS result: num clean cluster = 1298(model) 	 num outliers = 2276(model)
mdoel:new class are [1299], length of new dataset is 14246
Epoch: [7][0/300]	Time 1.072 (1.072)	Data 0.342 (0.342)	Loss_ce_clean 0.092 	Loss_ct_clean 0.085 	Prec 99.22%
Epoch: [7][50/300]	Time 0.787 (1.197)	Data 0.112 (0.146)	Loss_ce_clean 0.114 	Loss_ct_clean 0.155 	Prec 98.77%
Epoch: [7][100/300]	Time 1.417 (1.157)	Data 0.107 (0.255)	Loss_ce_clean 0.106 	Loss_ct_clean 0.262 	Prec 98.90%
Epoch: [7][150/300]	Time 0.973 (1.130)	Data 0.116 (0.208)	Loss_ce_clean 0.107 	Loss_ct_clean 0.296 	Prec 98.82%
Epoch: [7][200/300]	Time 0.970 (1.094)	Data 0.118 (0.184)	Loss_ce_clean 0.106 	Loss_ct_clean 0.309 	Prec 98.88%
Epoch: [7][250/300]	Time 0.783 (1.077)	Data 0.113 (0.170)	Loss_ce_clean 0.104 	Loss_ct_clean 0.312 	Prec 98.93%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.177)	Data 0.000 (0.020)	
Computing jaccard distance...
Jaccard distance computing time cost: 12.591485977172852
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.161 (0.246)	Data 0.000 (0.076)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.33085036277771
The orignal cluster result: num cluster = 1394(model) // 1347(model_ema) 	 num outliers = 811(model) // 1119(model_ema)
Applying hierarchical clustering
[ 574 1265  770 ... 1304  450 1309]
(16522,)
(array([    7,    42,    66,    68,    75,    85,    97,   104,   114,
         145,   161,   171,   188,   199,   213,   220,   241,   248,
         269,   271,   287,   338,   341,   383,   390,   394,   400,
         412,   414,   417,   436,   445,   455,   460,   464,   495,
         506,   519,   545,   602,   637,   643,   651,   672,   676,
         677,   714,   724,   728,   743,   754,   779,   808,   827,
         828,   832,   851,   853,   854,   861,   899,   911,   913,
         986,   997,  1001,  1037,  1039,  1059,  1149,  1154,  1162,
        1197,  1209,  1218,  1222,  1263,  1309,  1317,  1319,  1354,
        1396,  1402,  1413,  1417,  1433,  1439,  1453,  1460,  1471,
        1473,  1494,  1528,  1573,  1587,  1618,  1631,  1654,  1672,
        1675,  1685,  1699,  1741,  1746,  1780,  1783,  1814,  1819,
        1833,  1856,  1931,  1944,  1983,  2017,  2039,  2057,  2147,
        2148,  2170,  2179,  2182,  2185,  2205,  2248,  2264,  2282,
        2297,  2299,  2300,  2307,  2330,  2406,  2430,  2431,  2438,
        2447,  2465,  2482,  2486,  2501,  2680,  2684,  2703,  2724,
        2756,  2769,  2770,  2814,  2818,  2837,  2889,  2913,  2947,
        2955,  2971,  2986,  3015,  3027,  3073,  3117,  3126,  3157,
        3180,  3189,  3202,  3208,  3219,  3245,  3249,  3272,  3280,
        3283,  3311,  3330,  3334,  3434,  3437,  3448,  3480,  3507,
        3517,  3570,  3575,  3598,  3608,  3615,  3641,  3650,  3670,
        3677,  3685,  3713,  3716,  3728,  3774,  3794,  3812,  3815,
        3896,  3908,  3933,  3941,  3947,  3951,  3958,  3961,  3995,
        4022,  4060,  4061,  4065,  4100,  4105,  4106,  4143,  4156,
        4160,  4199,  4209,  4215,  4242,  4248,  4249,  4251,  4257,
        4296,  4319,  4321,  4372,  4373,  4393,  4398,  4429,  4433,
        4438,  4448,  4487,  4498,  4499,  4515,  4539,  4566,  4597,
        4609,  4614,  4628,  4638,  4651,  4676,  4682,  4685,  4738,
        4747,  4751,  4753,  4774,  4777,  4849,  4861,  4876,  4899,
        4914,  4920,  4944,  5023,  5035,  5053,  5082,  5094,  5107,
        5129,  5134,  5141,  5180,  5184,  5220,  5239,  5253,  5265,
        5267,  5280,  5317,  5320,  5362,  5379,  5438,  5440,  5445,
        5472,  5473,  5513,  5526,  5542,  5546,  5558,  5567,  5577,
        5578,  5585,  5602,  5603,  5613,  5619,  5659,  5669,  5702,
        5739,  5816,  5838,  5848,  5849,  5852,  5926,  5945,  5946,
        6028,  6082,  6095,  6111,  6128,  6132,  6144,  6153,  6202,
        6208,  6238,  6253,  6296,  6301,  6316,  6336,  6366,  6447,
        6448,  6451,  6491,  6593,  6629,  6632,  6658,  6666,  6696,
        6697,  6713,  6744,  6761,  6788,  6818,  6820,  6825,  6827,
        6859,  6860,  6874,  6876,  6898,  6911,  6946,  6956,  6964,
        7071,  7168,  7181,  7186,  7206,  7214,  7218,  7307,  7309,
        7362,  7371,  7382,  7383,  7389,  7395,  7492,  7503,  7506,
        7513,  7515,  7516,  7538,  7560,  7564,  7565,  7575,  7604,
        7612,  7625,  7630,  7696,  7722,  7752,  7765,  7784,  7796,
        7858,  7919,  7928,  7972,  7980,  7981,  7985,  8031,  8033,
        8046,  8059,  8101,  8129,  8203,  8222,  8232,  8237,  8263,
        8285,  8299,  8309,  8381,  8392,  8471,  8487,  8510,  8525,
        8528,  8529,  8548,  8557,  8566,  8576,  8577,  8579,  8605,
        8638,  8688,  8705,  8721,  8746,  8753,  8756,  8775,  8778,
        8780,  8799,  8818,  8849,  8884,  8894,  8926,  8931,  8946,
        8973,  8974,  9029,  9039,  9057,  9059,  9081,  9085,  9107,
        9159,  9226,  9250,  9276,  9282,  9328,  9332,  9360,  9398,
        9399,  9433,  9471,  9485,  9497,  9516,  9521,  9529,  9535,
        9562,  9575,  9600,  9609,  9629,  9645,  9696,  9725,  9740,
        9746,  9754,  9794,  9835,  9838,  9930,  9936,  9941,  9944,
        9963,  9988, 10007, 10030, 10033, 10034, 10035, 10047, 10052,
       10058, 10060, 10070, 10076, 10078, 10105, 10125, 10149, 10177,
       10205, 10211, 10215, 10251, 10271, 10337, 10345, 10357, 10368,
       10369, 10408, 10435, 10445, 10453, 10460, 10479, 10482, 10533,
       10535, 10540, 10593, 10604, 10608, 10629, 10642, 10665, 10670,
       10697, 10701, 10716, 10750, 10762, 10764, 10770, 10794, 10804,
       10877, 10923, 10932, 10933, 10946, 10973, 11002, 11004, 11025,
       11090, 11092, 11112, 11116, 11172, 11210, 11224, 11230, 11274,
       11297, 11317, 11324, 11342, 11359, 11415, 11420, 11472, 11496,
       11545, 11553, 11555, 11579, 11605, 11610, 11619, 11620, 11622,
       11674, 11686, 11701, 11714, 11724, 11749, 11764, 11790, 11827,
       11830, 11845, 11849, 11912, 11915, 11929, 11939, 11972, 12031,
       12079, 12090, 12094, 12148, 12154, 12184, 12226, 12231, 12234,
       12266, 12341, 12394, 12412, 12414, 12416, 12438, 12448, 12453,
       12458, 12478, 12510, 12538, 12557, 12576, 12661, 12665, 12688,
       12699, 12715, 12721, 12743, 12749, 12759, 12823, 12845, 12916,
       12974, 12980, 12984, 13000, 13051, 13072, 13082, 13099, 13102,
       13110, 13120, 13129, 13132, 13159, 13160, 13162, 13167, 13190,
       13224, 13235, 13248, 13258, 13292, 13296, 13300, 13311, 13337,
       13340, 13388, 13409, 13441, 13444, 13462, 13489, 13511, 13519,
       13528, 13601, 13606, 13615, 13619, 13625, 13644, 13668, 13673,
       13677, 13709, 13717, 13724, 13728, 13731, 13734, 13742, 13762,
       13795, 13834, 13890, 13893, 13976, 13991, 14112, 14121, 14163,
       14174, 14220, 14222, 14255, 14258, 14260, 14266, 14284, 14339,
       14361, 14371, 14412, 14421, 14447, 14461, 14506, 14508, 14514,
       14520, 14559, 14567, 14579, 14593, 14594, 14604, 14634, 14680,
       14706, 14743, 14776, 14810, 14812, 14865, 14877, 14887, 14898,
       14950, 14970, 14982, 14983, 14985, 14997, 15005, 15037, 15090,
       15111, 15112, 15141, 15156, 15161, 15166, 15182, 15194, 15197,
       15200, 15240, 15245, 15257, 15258, 15292, 15295, 15324, 15406,
       15411, 15424, 15432, 15443, 15447, 15482, 15484, 15524, 15591,
       15592, 15597, 15613, 15626, 15667, 15712, 15717, 15725, 15752,
       15848, 15932, 15963, 15969, 15977, 15978, 15995, 16005, 16020,
       16033, 16058, 16075, 16086, 16148, 16174, 16191, 16206, 16211,
       16224, 16235, 16251, 16259, 16270, 16292, 16361, 16467, 16507,
       16515]),)
(16522, 16522)
(15711, 16522)
(15711, 15711)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.3283231258392334s
The HC Re-cluster result: num cluster = 1394(model) // 1347(model_ema) 	 num outliers = 811(model) // 1119(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.340665340423584s
The UCIS result: num clean cluster = 1338(model) 	 num outliers = 1965(model)
mdoel:new class are [1339], length of new dataset is 14557
Epoch: [8][0/300]	Time 2.189 (2.189)	Data 1.433 (1.433)	Loss_ce_clean 0.082 	Loss_ct_clean 0.075 	Prec 99.22%
Epoch: [8][50/300]	Time 2.087 (1.859)	Data 1.414 (1.188)	Loss_ce_clean 0.102 	Loss_ct_clean 0.130 	Prec 98.64%
Epoch: [8][100/300]	Time 0.883 (1.426)	Data 0.214 (0.756)	Loss_ce_clean 0.101 	Loss_ct_clean 0.239 	Prec 98.79%
Epoch: [8][150/300]	Time 0.853 (1.250)	Data 0.183 (0.579)	Loss_ce_clean 0.101 	Loss_ct_clean 0.270 	Prec 98.79%
Epoch: [8][200/300]	Time 0.867 (1.155)	Data 0.198 (0.485)	Loss_ce_clean 0.098 	Loss_ct_clean 0.285 	Prec 98.87%
Epoch: [8][250/300]	Time 0.816 (1.091)	Data 0.147 (0.420)	Loss_ce_clean 0.098 	Loss_ct_clean 0.288 	Prec 98.91%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.165 (0.167)	Data 0.000 (0.011)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.178366661071777
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.270)	Data 0.000 (0.015)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.664020538330078
The orignal cluster result: num cluster = 1413(model) // 1371(model_ema) 	 num outliers = 860(model) // 973(model_ema)
Applying hierarchical clustering
[1040 1227  756 ... 1315  190 1326]
(16522,)
(array([    7,    39,    75,    85,    97,   104,   161,   182,   188,
         197,   199,   213,   220,   241,   247,   248,   269,   277,
         287,   338,   359,   380,   383,   394,   400,   414,   417,
         422,   436,   443,   460,   464,   472,   480,   481,   486,
         495,   499,   506,   519,   573,   588,   602,   637,   643,
         676,   677,   680,   714,   724,   728,   743,   752,   759,
         770,   798,   799,   807,   808,   827,   832,   851,   853,
         854,   861,   899,   911,   927,   942,   986,   997,  1030,
        1037,  1059,  1063,  1098,  1140,  1149,  1197,  1205,  1209,
        1222,  1232,  1246,  1263,  1317,  1319,  1394,  1396,  1402,
        1413,  1430,  1473,  1526,  1573,  1587,  1613,  1618,  1635,
        1654,  1670,  1672,  1697,  1735,  1746,  1780,  1781,  1783,
        1819,  1833,  1871,  1931,  1983,  1984,  2017,  2039,  2057,
        2119,  2127,  2148,  2170,  2182,  2185,  2205,  2216,  2241,
        2264,  2282,  2284,  2297,  2299,  2300,  2307,  2330,  2332,
        2403,  2406,  2431,  2438,  2447,  2465,  2494,  2501,  2510,
        2526,  2564,  2575,  2584,  2585,  2611,  2673,  2680,  2684,
        2703,  2710,  2724,  2735,  2769,  2770,  2783,  2796,  2814,
        2818,  2837,  2871,  2876,  2889,  2913,  2922,  2947,  2955,
        2986,  3015,  3027,  3030,  3036,  3037,  3050,  3073,  3114,
        3117,  3126,  3129,  3142,  3148,  3157,  3180,  3189,  3198,
        3202,  3249,  3271,  3272,  3280,  3311,  3328,  3330,  3381,
        3434,  3448,  3454,  3475,  3480,  3496,  3534,  3570,  3571,
        3575,  3615,  3685,  3713,  3716,  3728,  3749,  3764,  3773,
        3794,  3812,  3815,  3873,  3896,  3906,  3908,  3933,  3947,
        3995,  4022,  4061,  4065,  4100,  4105,  4106,  4156,  4199,
        4247,  4248,  4251,  4257,  4311,  4321,  4334,  4360,  4372,
        4393,  4410,  4428,  4429,  4433,  4448,  4477,  4487,  4499,
        4523,  4528,  4539,  4563,  4566,  4609,  4637,  4638,  4651,
        4657,  4682,  4685,  4747,  4751,  4753,  4760,  4777,  4778,
        4798,  4848,  4876,  4902,  4908,  4914,  4920,  4924,  4944,
        5016,  5023,  5035,  5053,  5058,  5084,  5107,  5129,  5134,
        5162,  5180,  5184,  5220,  5232,  5239,  5265,  5267,  5277,
        5280,  5320,  5361,  5362,  5418,  5440,  5445,  5453,  5458,
        5492,  5513,  5526,  5545,  5558,  5567,  5578,  5585,  5602,
        5603,  5613,  5668,  5669,  5750,  5768,  5773,  5795,  5807,
        5816,  5848,  5849,  5894,  5949,  5995,  6004,  6028,  6035,
        6060,  6080,  6082,  6095,  6111,  6128,  6181,  6202,  6208,
        6253,  6296,  6301,  6316,  6319,  6324,  6336,  6389,  6442,
        6443,  6447,  6448,  6451,  6467,  6491,  6543,  6568,  6593,
        6624,  6629,  6632,  6658,  6666,  6696,  6713,  6744,  6761,
        6788,  6818,  6820,  6825,  6826,  6827,  6859,  6860,  6874,
        6876,  6887,  6898,  6946,  6957,  6964,  6965,  7105,  7110,
        7168,  7181,  7188,  7206,  7259,  7323,  7378,  7382,  7389,
        7420,  7473,  7503,  7506,  7513,  7515,  7516,  7538,  7560,
        7565,  7597,  7612,  7625,  7630,  7655,  7682,  7722,  7732,
        7752,  7765,  7772,  7796,  7919,  7928,  7972,  7980,  7981,
        8031,  8046,  8059,  8101,  8120,  8129,  8160,  8227,  8232,
        8237,  8263,  8285,  8299,  8319,  8340,  8373,  8379,  8381,
        8389,  8392,  8395,  8458,  8471,  8487,  8497,  8510,  8525,
        8528,  8529,  8548,  8557,  8577,  8579,  8605,  8609,  8638,
        8679,  8705,  8721,  8746,  8753,  8778,  8780,  8787,  8799,
        8818,  8845,  8847,  8880,  8884,  8893,  8907,  8909,  8926,
        8931,  8959,  8973,  9039,  9049,  9057,  9064,  9081,  9107,
        9159,  9184,  9226,  9282,  9360,  9365,  9398,  9399,  9416,
        9427,  9471,  9480,  9485,  9486,  9497,  9504,  9516,  9529,
        9535,  9539,  9562,  9590,  9600,  9610,  9629,  9631,  9645,
        9696,  9725,  9740,  9751,  9754,  9757,  9759,  9760,  9779,
        9792,  9794,  9810,  9835,  9854,  9897,  9936,  9939,  9941,
        9944,  9961,  9988, 10007, 10014, 10015, 10030, 10035, 10047,
       10052, 10058, 10070, 10076, 10078, 10105, 10125, 10140, 10149,
       10150, 10154, 10177, 10205, 10213, 10215, 10251, 10271, 10306,
       10337, 10350, 10369, 10435, 10445, 10453, 10457, 10460, 10482,
       10493, 10540, 10561, 10589, 10593, 10604, 10608, 10628, 10640,
       10642, 10665, 10693, 10697, 10701, 10707, 10716, 10750, 10762,
       10764, 10770, 10794, 10821, 10825, 10846, 10854, 10877, 10923,
       10932, 10933, 10946, 10973, 11004, 11049, 11059, 11090, 11112,
       11116, 11117, 11172, 11195, 11230, 11235, 11241, 11262, 11274,
       11317, 11324, 11354, 11359, 11420, 11472, 11514, 11553, 11610,
       11619, 11674, 11681, 11714, 11724, 11764, 11767, 11790, 11830,
       11849, 11890, 11900, 11912, 11929, 11939, 11943, 11972, 12031,
       12079, 12090, 12154, 12184, 12226, 12231, 12339, 12357, 12394,
       12412, 12414, 12426, 12432, 12434, 12436, 12438, 12448, 12453,
       12458, 12472, 12478, 12510, 12538, 12556, 12557, 12579, 12658,
       12665, 12681, 12688, 12699, 12715, 12721, 12749, 12759, 12763,
       12875, 12916, 12974, 12980, 12984, 13035, 13047, 13051, 13072,
       13099, 13110, 13120, 13129, 13144, 13159, 13160, 13174, 13190,
       13213, 13218, 13235, 13238, 13242, 13248, 13260, 13271, 13277,
       13292, 13320, 13352, 13382, 13407, 13409, 13441, 13444, 13462,
       13467, 13489, 13511, 13528, 13545, 13558, 13597, 13601, 13606,
       13615, 13619, 13625, 13644, 13651, 13677, 13680, 13707, 13709,
       13717, 13724, 13734, 13742, 13795, 13841, 13890, 13893, 13925,
       13976, 13991, 14052, 14079, 14101, 14121, 14124, 14147, 14164,
       14174, 14183, 14220, 14222, 14235, 14255, 14258, 14261, 14278,
       14295, 14325, 14327, 14339, 14340, 14349, 14361, 14368, 14371,
       14421, 14447, 14461, 14506, 14514, 14520, 14521, 14559, 14567,
       14579, 14604, 14616, 14634, 14647, 14675, 14708, 14812, 14822,
       14824, 14854, 14865, 14877, 14950, 14974, 14982, 14983, 14997,
       15005, 15053, 15090, 15110, 15111, 15141, 15161, 15166, 15182,
       15185, 15194, 15197, 15213, 15245, 15258, 15287, 15295, 15332,
       15352, 15406, 15424, 15427, 15443, 15447, 15454, 15482, 15484,
       15524, 15575, 15592, 15597, 15608, 15613, 15642, 15653, 15667,
       15678, 15712, 15717, 15731, 15752, 15784, 15807, 15851, 15914,
       15915, 15969, 15978, 15995, 16058, 16086, 16138, 16148, 16174,
       16191, 16202, 16211, 16240, 16251, 16259, 16292, 16431, 16465,
       16467, 16474, 16507, 16515, 16518]),)
(16522, 16522)
(15662, 16522)
(15662, 15662)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.510901689529419s
The HC Re-cluster result: num cluster = 1413(model) // 1371(model_ema) 	 num outliers = 860(model) // 973(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9138383865356445s
The UCIS result: num clean cluster = 1363(model) 	 num outliers = 1852(model)
mdoel:new class are [1364], length of new dataset is 14670
Epoch: [9][0/300]	Time 1.728 (1.728)	Data 0.133 (0.133)	Loss_ce_clean 0.147 	Loss_ct_clean 0.144 	Prec 96.88%
Epoch: [9][50/300]	Time 0.784 (1.043)	Data 0.115 (0.192)	Loss_ce_clean 0.106 	Loss_ct_clean 0.123 	Prec 98.51%
Epoch: [9][100/300]	Time 4.117 (1.486)	Data 3.445 (0.600)	Loss_ce_clean 0.101 	Loss_ct_clean 0.234 	Prec 98.68%
Epoch: [9][150/300]	Time 0.779 (1.705)	Data 0.110 (0.877)	Loss_ce_clean 0.099 	Loss_ct_clean 0.266 	Prec 98.75%
Epoch: [9][200/300]	Time 3.163 (1.998)	Data 2.492 (1.137)	Loss_ce_clean 0.099 	Loss_ct_clean 0.280 	Prec 98.75%
Epoch: [9][250/300]	Time 3.984 (2.649)	Data 3.314 (1.826)	Loss_ce_clean 0.098 	Loss_ct_clean 0.285 	Prec 98.77%
Extract Features: [100/156]	Time 0.163 (0.879)	Data 0.000 (0.718)	
Mean AP: 50.5%
CMC Scores:
  top-1          67.9%
  top-5          79.6%
  top-10         83.9%
Extract Features: [100/156]	Time 0.155 (0.166)	Data 0.000 (0.011)	
Mean AP: 53.9%
CMC Scores:
  top-1          70.0%
  top-5          81.1%
  top-10         85.3%

 * Finished epoch   9  model no.1 mAP: 50.5% model no.2(mean-net) mAP: 53.9%  best: 53.9% *

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.154 (0.302)	Data 0.000 (0.148)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.589210510253906
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.154 (0.340)	Data 0.000 (0.185)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.867340803146362
The orignal cluster result: num cluster = 1445(model) // 1387(model_ema) 	 num outliers = 796(model) // 945(model_ema)
Applying hierarchical clustering
[ 789  997  619 ... 1190 1138   -1]
(16522,)
(array([   23,    66,    68,    75,    83,    85,    97,   104,   112,
         161,   182,   188,   197,   213,   220,   241,   277,   287,
         338,   383,   394,   400,   414,   417,   431,   436,   437,
         443,   460,   464,   472,   481,   486,   519,   530,   545,
         588,   602,   637,   643,   651,   672,   676,   677,   680,
         689,   714,   715,   752,   759,   771,   807,   808,   812,
         827,   832,   851,   853,   854,   861,   899,   911,   913,
         927,   965,   986,   987,  1020,  1037,  1039,  1059,  1097,
        1098,  1154,  1222,  1246,  1263,  1288,  1317,  1319,  1324,
        1359,  1396,  1402,  1413,  1417,  1460,  1473,  1520,  1526,
        1528,  1573,  1587,  1605,  1618,  1654,  1672,  1675,  1685,
        1735,  1746,  1783,  1794,  1819,  1824,  1833,  1856,  1860,
        1916,  1931,  1998,  2017,  2057,  2101,  2119,  2127,  2147,
        2148,  2182,  2205,  2216,  2241,  2282,  2295,  2297,  2299,
        2307,  2332,  2403,  2406,  2431,  2438,  2465,  2486,  2494,
        2501,  2584,  2680,  2684,  2703,  2769,  2783,  2794,  2796,
        2814,  2818,  2819,  2880,  2913,  2935,  2947,  2955,  2986,
        3015,  3027,  3030,  3036,  3037,  3043,  3105,  3107,  3117,
        3118,  3126,  3142,  3157,  3178,  3180,  3189,  3202,  3219,
        3223,  3249,  3271,  3280,  3297,  3311,  3330,  3434,  3448,
        3454,  3480,  3502,  3507,  3570,  3571,  3575,  3582,  3598,
        3644,  3682,  3685,  3695,  3708,  3713,  3716,  3728,  3749,
        3764,  3794,  3815,  3851,  3873,  3878,  3896,  3906,  3908,
        3933,  3941,  3947,  3995,  4054,  4065,  4105,  4106,  4199,
        4209,  4221,  4242,  4247,  4248,  4251,  4311,  4321,  4334,
        4373,  4393,  4410,  4424,  4428,  4429,  4433,  4448,  4477,
        4480,  4487,  4496,  4499,  4523,  4528,  4539,  4566,  4614,
        4637,  4657,  4681,  4682,  4685,  4695,  4747,  4760,  4777,
        4798,  4848,  4876,  4902,  4920,  4939,  5023,  5053,  5082,
        5084,  5094,  5107,  5129,  5141,  5148,  5180,  5184,  5199,
        5215,  5220,  5232,  5239,  5255,  5265,  5267,  5280,  5317,
        5320,  5321,  5332,  5361,  5379,  5403,  5418,  5440,  5453,
        5534,  5577,  5578,  5580,  5583,  5585,  5589,  5603,  5659,
        5669,  5712,  5720,  5750,  5790,  5795,  5812,  5816,  5894,
        5913,  6035,  6040,  6060,  6067,  6082,  6095,  6111,  6128,
        6144,  6202,  6208,  6222,  6253,  6296,  6301,  6366,  6389,
        6442,  6443,  6447,  6448,  6451,  6465,  6467,  6491,  6556,
        6593,  6624,  6629,  6632,  6658,  6696,  6713,  6721,  6758,
        6761,  6788,  6818,  6820,  6822,  6825,  6859,  6860,  6876,
        6898,  6956,  6957,  6965,  7085,  7110,  7115,  7139,  7145,
        7162,  7168,  7188,  7206,  7259,  7307,  7362,  7387,  7389,
        7425,  7440,  7457,  7473,  7513,  7516,  7538,  7560,  7564,
        7565,  7612,  7625,  7630,  7632,  7655,  7722,  7746,  7752,
        7765,  7772,  7796,  7809,  7859,  7919,  7928,  7972,  7980,
        7981,  8014,  8033,  8059,  8101,  8120,  8129,  8178,  8186,
        8201,  8237,  8263,  8285,  8299,  8319,  8324,  8340,  8373,
        8379,  8392,  8471,  8497,  8525,  8528,  8557,  8566,  8576,
        8577,  8579,  8623,  8638,  8678,  8705,  8721,  8738,  8746,
        8753,  8778,  8780,  8787,  8818,  8847,  8884,  8893,  8926,
        8931,  8959,  8974,  8989,  9049,  9064,  9081,  9107,  9154,
        9159,  9184,  9282,  9328,  9360,  9398,  9399,  9471,  9485,
        9486,  9497,  9504,  9516,  9521,  9528,  9535,  9539,  9554,
        9562,  9575,  9590,  9600,  9645,  9675,  9679,  9725,  9740,
        9746,  9752,  9760,  9771,  9779,  9782,  9792,  9794,  9810,
        9835,  9838,  9930,  9939,  9941,  9944,  9961,  9963,  9978,
        9988, 10007, 10014, 10034, 10035, 10047, 10070, 10076, 10101,
       10105, 10125, 10140, 10149, 10177, 10181, 10205, 10213, 10215,
       10237, 10271, 10275, 10337, 10365, 10369, 10408, 10435, 10445,
       10453, 10460, 10482, 10493, 10504, 10533, 10535, 10540, 10561,
       10589, 10593, 10604, 10608, 10629, 10642, 10665, 10697, 10701,
       10716, 10725, 10750, 10762, 10770, 10794, 10825, 10877, 10933,
       10946, 10973, 11004, 11027, 11092, 11112, 11116, 11132, 11172,
       11194, 11230, 11274, 11317, 11324, 11415, 11420, 11463, 11472,
       11514, 11553, 11555, 11579, 11610, 11619, 11622, 11681, 11701,
       11723, 11724, 11767, 11790, 11818, 11827, 11845, 11890, 11912,
       11929, 11939, 11972, 12031, 12079, 12090, 12154, 12184, 12226,
       12231, 12234, 12340, 12394, 12412, 12414, 12416, 12426, 12427,
       12434, 12436, 12438, 12448, 12453, 12478, 12510, 12523, 12556,
       12557, 12658, 12665, 12688, 12699, 12715, 12721, 12728, 12749,
       12759, 12823, 12845, 12916, 12974, 12980, 12984, 12986, 13051,
       13072, 13077, 13099, 13102, 13120, 13129, 13134, 13159, 13160,
       13174, 13190, 13235, 13248, 13260, 13271, 13277, 13292, 13296,
       13320, 13337, 13352, 13382, 13387, 13388, 13399, 13409, 13444,
       13462, 13478, 13489, 13519, 13528, 13545, 13597, 13601, 13615,
       13625, 13651, 13677, 13685, 13698, 13707, 13717, 13724, 13734,
       13795, 13817, 13841, 13861, 13875, 13890, 13911, 13976, 13990,
       13991, 13996, 13999, 14052, 14079, 14121, 14164, 14174, 14183,
       14220, 14226, 14235, 14258, 14261, 14295, 14325, 14327, 14339,
       14371, 14412, 14421, 14447, 14459, 14461, 14506, 14508, 14520,
       14534, 14559, 14578, 14579, 14593, 14596, 14604, 14634, 14675,
       14708, 14761, 14780, 14812, 14848, 14854, 14865, 14877, 14898,
       14950, 14970, 14983, 14997, 15005, 15084, 15090, 15093, 15110,
       15111, 15141, 15156, 15161, 15166, 15182, 15194, 15229, 15240,
       15257, 15258, 15295, 15324, 15340, 15402, 15424, 15443, 15447,
       15454, 15474, 15575, 15592, 15613, 15626, 15642, 15674, 15678,
       15712, 15731, 15752, 15774, 15807, 15876, 15912, 15914, 15915,
       15932, 15963, 15969, 15973, 15995, 16032, 16054, 16058, 16086,
       16138, 16191, 16202, 16206, 16251, 16259, 16292, 16436, 16467,
       16474, 16507, 16515, 16521]),)
(16522, 16522)
(15726, 16522)
(15726, 15726)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2593917846679688s
The HC Re-cluster result: num cluster = 1445(model) // 1387(model_ema) 	 num outliers = 796(model) // 945(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=2.7446367740631104s
The UCIS result: num clean cluster = 1396(model) 	 num outliers = 1605(model)
mdoel:new class are [1397], length of new dataset is 14917
Epoch: [10][0/300]	Time 0.812 (0.812)	Data 0.138 (0.138)	Loss_ce_clean 0.044 	Loss_ct_clean 0.040 	Prec 100.00%
Epoch: [10][50/300]	Time 0.772 (0.784)	Data 0.103 (0.115)	Loss_ce_clean 0.098 	Loss_ct_clean 0.106 	Prec 98.77%
Epoch: [10][100/300]	Time 0.773 (0.781)	Data 0.104 (0.111)	Loss_ce_clean 0.094 	Loss_ct_clean 0.217 	Prec 98.88%
Epoch: [10][150/300]	Time 0.773 (0.780)	Data 0.104 (0.110)	Loss_ce_clean 0.093 	Loss_ct_clean 0.247 	Prec 98.93%
Epoch: [10][200/300]	Time 0.771 (0.778)	Data 0.101 (0.108)	Loss_ce_clean 0.093 	Loss_ct_clean 0.259 	Prec 98.96%
Epoch: [10][250/300]	Time 0.774 (0.778)	Data 0.104 (0.108)	Loss_ce_clean 0.093 	Loss_ct_clean 0.267 	Prec 98.97%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.164 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.76387906074524
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.164)	Data 0.000 (0.010)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.806622982025146
The orignal cluster result: num cluster = 1451(model) // 1407(model_ema) 	 num outliers = 692(model) // 851(model_ema)
Applying hierarchical clustering
[ 921 1348  176 ... 1270 1154 1301]
(16522,)
(array([   66,    75,    85,    97,   104,   112,   188,   197,   207,
         213,   220,   241,   338,   341,   383,   394,   400,   412,
         423,   437,   443,   445,   460,   464,   495,   519,   530,
         588,   637,   643,   672,   676,   677,   752,   770,   771,
         779,   799,   808,   827,   832,   851,   853,   854,   861,
         911,   965,   987,   997,  1037,  1063,  1098,  1197,  1205,
        1228,  1263,  1359,  1396,  1402,  1413,  1417,  1473,  1494,
        1520,  1528,  1573,  1587,  1631,  1634,  1654,  1672,  1676,
        1685,  1735,  1741,  1746,  1750,  1780,  1783,  1794,  1833,
        1854,  1856,  1871,  1931,  1983,  1998,  2039,  2119,  2147,
        2148,  2182,  2185,  2205,  2236,  2244,  2282,  2332,  2406,
        2431,  2438,  2441,  2447,  2465,  2486,  2494,  2501,  2505,
        2564,  2612,  2680,  2684,  2703,  2725,  2754,  2758,  2769,
        2770,  2783,  2794,  2796,  2799,  2818,  2819,  2850,  2871,
        2876,  2903,  2913,  2947,  2986,  3015,  3027,  3030,  3036,
        3037,  3050,  3105,  3117,  3121,  3126,  3129,  3142,  3143,
        3157,  3178,  3180,  3202,  3280,  3330,  3334,  3434,  3448,
        3454,  3480,  3544,  3570,  3575,  3615,  3650,  3685,  3728,
        3764,  3774,  3794,  3815,  3851,  3906,  3908,  3933,  3951,
        4060,  4061,  4105,  4106,  4143,  4156,  4161,  4209,  4221,
        4242,  4248,  4251,  4319,  4321,  4334,  4393,  4410,  4428,
        4429,  4438,  4484,  4487,  4496,  4499,  4523,  4539,  4566,
        4609,  4614,  4632,  4637,  4638,  4651,  4682,  4685,  4695,
        4738,  4747,  4751,  4777,  4848,  4899,  4902,  4914,  4921,
        4939,  5008,  5023,  5084,  5094,  5107,  5129,  5141,  5144,
        5148,  5180,  5184,  5215,  5220,  5232,  5265,  5267,  5280,
        5297,  5298,  5303,  5320,  5332,  5361,  5418,  5445,  5542,
        5558,  5577,  5578,  5583,  5589,  5602,  5603,  5659,  5669,
        5710,  5712,  5750,  5763,  5795,  5812,  5816,  5849,  5852,
        5872,  6004,  6060,  6067,  6082,  6111,  6128,  6132,  6222,
        6253,  6296,  6301,  6316,  6319,  6366,  6442,  6447,  6448,
        6450,  6467,  6491,  6556,  6568,  6593,  6629,  6658,  6666,
        6758,  6761,  6825,  6826,  6859,  6860,  6874,  6876,  6898,
        6934,  6956,  7110,  7145,  7168,  7181,  7307,  7362,  7382,
        7387,  7389,  7425,  7457,  7473,  7506,  7513,  7515,  7528,
        7538,  7560,  7565,  7612,  7625,  7630,  7632,  7655,  7722,
        7746,  7752,  7765,  7796,  7805,  7814,  7831,  7919,  7928,
        7957,  7980,  7981,  7992,  8046,  8059,  8101,  8186,  8215,
        8227,  8237,  8263,  8270,  8285,  8299,  8319,  8340,  8471,
        8497,  8510,  8525,  8548,  8568,  8576,  8577,  8579,  8688,
        8705,  8746,  8778,  8780,  8787,  8821,  8847,  8880,  8884,
        8893,  8909,  8926,  8931,  8936,  8973,  9005,  9029,  9039,
        9057,  9064,  9081,  9107,  9136,  9154,  9159,  9250,  9282,
        9328,  9354,  9365,  9398,  9399,  9416,  9471,  9485,  9497,
        9504,  9528,  9529,  9535,  9539,  9554,  9562,  9590,  9600,
        9645,  9675,  9676,  9696,  9746,  9752,  9759,  9782,  9792,
        9794,  9808,  9810,  9819,  9835,  9854,  9930,  9936,  9941,
        9944,  9961,  9963,  9988, 10007, 10015, 10033, 10034, 10035,
       10052, 10058, 10060, 10070, 10076, 10078, 10105, 10125, 10149,
       10188, 10215, 10271, 10275, 10306, 10337, 10350, 10357, 10369,
       10435, 10445, 10453, 10460, 10479, 10482, 10493, 10507, 10540,
       10589, 10593, 10604, 10608, 10629, 10640, 10665, 10701, 10716,
       10750, 10762, 10770, 10794, 10821, 10825, 10846, 10854, 10877,
       10923, 10932, 10933, 10973, 10991, 11059, 11090, 11092, 11112,
       11116, 11132, 11172, 11194, 11195, 11203, 11224, 11274, 11297,
       11317, 11324, 11420, 11472, 11553, 11555, 11579, 11606, 11610,
       11681, 11693, 11701, 11749, 11827, 11830, 11845, 11849, 11896,
       11900, 11905, 11912, 11929, 11939, 11972, 12031, 12044, 12090,
       12123, 12138, 12154, 12184, 12226, 12231, 12234, 12283, 12339,
       12412, 12414, 12426, 12448, 12453, 12458, 12478, 12510, 12550,
       12557, 12661, 12665, 12681, 12699, 12715, 12721, 12749, 12759,
       12806, 12833, 12845, 12949, 12974, 12980, 13051, 13072, 13120,
       13132, 13160, 13235, 13242, 13248, 13260, 13271, 13277, 13292,
       13300, 13320, 13337, 13352, 13382, 13388, 13409, 13441, 13444,
       13462, 13489, 13528, 13545, 13597, 13601, 13606, 13615, 13619,
       13680, 13717, 13724, 13728, 13731, 13795, 13875, 13890, 13893,
       13894, 13911, 13976, 13991, 13999, 14052, 14079, 14121, 14154,
       14164, 14174, 14220, 14222, 14235, 14255, 14278, 14295, 14301,
       14325, 14339, 14368, 14371, 14447, 14448, 14459, 14461, 14506,
       14520, 14534, 14559, 14567, 14578, 14579, 14623, 14634, 14675,
       14756, 14836, 14854, 14865, 14877, 14898, 14950, 14970, 14983,
       15005, 15090, 15141, 15156, 15161, 15166, 15182, 15229, 15257,
       15258, 15292, 15303, 15324, 15340, 15402, 15424, 15432, 15443,
       15447, 15484, 15575, 15592, 15613, 15669, 15674, 15731, 15752,
       15807, 15912, 15969, 15978, 15995, 16058, 16086, 16133, 16138,
       16148, 16151, 16174, 16191, 16202, 16211, 16225, 16235, 16238,
       16240, 16251, 16259, 16292, 16467, 16474, 16507, 16515]),)
(16522, 16522)
(15830, 16522)
(15830, 15830)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1205520629882812s
The HC Re-cluster result: num cluster = 1451(model) // 1407(model_ema) 	 num outliers = 692(model) // 851(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8570706844329834s
The UCIS result: num clean cluster = 1412(model) 	 num outliers = 1475(model)
mdoel:new class are [1413], length of new dataset is 15047
Epoch: [11][0/300]	Time 0.793 (0.793)	Data 0.118 (0.118)	Loss_ce_clean 0.045 	Loss_ct_clean 0.043 	Prec 99.22%
Epoch: [11][50/300]	Time 0.773 (0.775)	Data 0.104 (0.105)	Loss_ce_clean 0.087 	Loss_ct_clean 0.099 	Prec 98.91%
Epoch: [11][100/300]	Time 0.775 (0.775)	Data 0.104 (0.105)	Loss_ce_clean 0.084 	Loss_ct_clean 0.190 	Prec 98.91%
Epoch: [11][150/300]	Time 0.772 (0.774)	Data 0.102 (0.104)	Loss_ce_clean 0.084 	Loss_ct_clean 0.225 	Prec 99.01%
Epoch: [11][200/300]	Time 0.775 (0.774)	Data 0.104 (0.104)	Loss_ce_clean 0.085 	Loss_ct_clean 0.241 	Prec 98.99%
Epoch: [11][250/300]	Time 0.772 (0.774)	Data 0.103 (0.104)	Loss_ce_clean 0.085 	Loss_ct_clean 0.249 	Prec 99.00%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.741196870803833
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.721735715866089
The orignal cluster result: num cluster = 1463(model) // 1432(model_ema) 	 num outliers = 621(model) // 758(model_ema)
Applying hierarchical clustering
[ 888  994  105 ... 1383 1085 1434]
(16522,)
(array([   75,    85,    97,   104,   112,   182,   188,   197,   207,
         241,   269,   277,   338,   394,   400,   422,   423,   437,
         443,   445,   460,   464,   530,   563,   580,   588,   637,
         643,   676,   677,   714,   743,   770,   771,   779,   799,
         827,   851,   853,   861,   911,   965,   987,   997,  1037,
        1059,  1063,  1098,  1197,  1205,  1263,  1359,  1396,  1402,
        1430,  1460,  1473,  1494,  1520,  1526,  1528,  1573,  1587,
        1631,  1685,  1723,  1735,  1746,  1750,  1783,  1819,  1833,
        1854,  1931,  1944,  1984,  1998,  2017,  2039,  2130,  2147,
        2148,  2170,  2182,  2205,  2241,  2282,  2297,  2299,  2332,
        2374,  2406,  2431,  2438,  2441,  2447,  2465,  2501,  2505,
        2656,  2680,  2684,  2703,  2725,  2758,  2769,  2770,  2783,
        2794,  2796,  2814,  2818,  2819,  2850,  2871,  2880,  2889,
        2986,  3027,  3036,  3037,  3050,  3073,  3117,  3121,  3126,
        3142,  3143,  3157,  3180,  3202,  3223,  3273,  3280,  3330,
        3334,  3434,  3448,  3473,  3480,  3544,  3570,  3575,  3641,
        3716,  3728,  3764,  3794,  3812,  3815,  3851,  3906,  3908,
        3933,  3947,  3958,  4061,  4065,  4105,  4106,  4143,  4209,
        4221,  4251,  4321,  4410,  4428,  4429,  4433,  4487,  4496,
        4499,  4539,  4566,  4614,  4628,  4632,  4637,  4638,  4682,
        4747,  4764,  4777,  4861,  4902,  4914,  4920,  5003,  5035,
        5053,  5082,  5084,  5094,  5129,  5141,  5148,  5184,  5215,
        5220,  5239,  5265,  5267,  5280,  5320,  5332,  5361,  5412,
        5418,  5445,  5526,  5542,  5567,  5577,  5578,  5583,  5585,
        5589,  5603,  5637,  5669,  5712,  5750,  5763,  5795,  5812,
        5816,  5838,  5848,  5849,  5872,  5894,  5949,  5995,  6060,
        6067,  6082,  6095,  6111,  6128,  6132,  6208,  6253,  6296,
        6301,  6316,  6319,  6366,  6389,  6429,  6447,  6448,  6450,
        6451,  6467,  6491,  6556,  6573,  6593,  6629,  6658,  6744,
        6758,  6761,  6818,  6820,  6822,  6825,  6826,  6827,  6860,
        6874,  6876,  6898,  6934,  6946,  6956,  6965,  7110,  7111,
        7145,  7206,  7307,  7323,  7382,  7387,  7389,  7457,  7506,
        7515,  7528,  7538,  7560,  7564,  7565,  7625,  7682,  7685,
        7722,  7746,  7752,  7765,  7796,  7805,  7882,  7919,  7928,
        7980,  7981,  8059,  8064,  8101,  8186,  8215,  8237,  8270,
        8285,  8319,  8340,  8373,  8381,  8392,  8471,  8510,  8525,
        8527,  8557,  8576,  8579,  8638,  8688,  8705,  8746,  8753,
        8778,  8780,  8787,  8799,  8821,  8880,  8884,  8893,  8909,
        8926,  8931,  8966,  9039,  9057,  9059,  9064,  9081,  9107,
        9136,  9154,  9159,  9184,  9276,  9282,  9354,  9365,  9398,
        9399,  9471,  9485,  9497,  9504,  9539,  9562,  9600,  9645,
        9676,  9733,  9746,  9751,  9752,  9759,  9782,  9792,  9794,
        9810,  9835,  9838,  9897,  9936,  9939,  9941,  9944,  9988,
       10007, 10033, 10034, 10035, 10047, 10052, 10057, 10060, 10070,
       10076, 10077, 10101, 10105, 10149, 10181, 10205, 10215, 10306,
       10337, 10350, 10368, 10369, 10435, 10445, 10479, 10482, 10493,
       10540, 10561, 10589, 10593, 10604, 10608, 10629, 10642, 10693,
       10701, 10716, 10750, 10770, 10784, 10794, 10825, 10877, 10923,
       10932, 10970, 10973, 11092, 11112, 11116, 11117, 11132, 11194,
       11195, 11224, 11297, 11317, 11324, 11415, 11420, 11514, 11553,
       11579, 11610, 11674, 11681, 11686, 11693, 11701, 11723, 11798,
       11827, 11845, 11849, 11912, 11929, 11939, 11972, 12031, 12044,
       12079, 12090, 12154, 12226, 12231, 12234, 12340, 12394, 12412,
       12414, 12434, 12438, 12448, 12458, 12510, 12557, 12576, 12661,
       12665, 12699, 12715, 12721, 12749, 12759, 12806, 12823, 12845,
       12916, 12974, 12980, 13051, 13077, 13120, 13159, 13160, 13190,
       13213, 13224, 13235, 13238, 13242, 13248, 13260, 13271, 13277,
       13292, 13300, 13320, 13337, 13352, 13382, 13387, 13388, 13409,
       13441, 13444, 13462, 13489, 13511, 13519, 13528, 13601, 13615,
       13677, 13680, 13717, 13724, 13728, 13875, 13911, 13941, 13976,
       13991, 13999, 14052, 14079, 14121, 14154, 14164, 14174, 14183,
       14220, 14255, 14278, 14295, 14301, 14325, 14361, 14368, 14371,
       14447, 14459, 14461, 14506, 14539, 14559, 14578, 14579, 14593,
       14623, 14634, 14756, 14865, 14877, 14898, 15005, 15006, 15084,
       15090, 15121, 15141, 15156, 15161, 15188, 15197, 15200, 15303,
       15340, 15424, 15432, 15443, 15454, 15484, 15575, 15592, 15613,
       15642, 15712, 15731, 15752, 15807, 15932, 15963, 15969, 15978,
       15995, 15998, 16058, 16086, 16138, 16148, 16174, 16202, 16211,
       16238, 16251, 16259, 16292, 16334, 16467, 16505, 16507, 16515]),)
(16522, 16522)
(15901, 16522)
(15901, 15901)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.139335870742798s
The HC Re-cluster result: num cluster = 1463(model) // 1432(model_ema) 	 num outliers = 621(model) // 758(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8494324684143066s
The UCIS result: num clean cluster = 1426(model) 	 num outliers = 1342(model)
mdoel:new class are [1427], length of new dataset is 15180
Epoch: [12][0/300]	Time 0.800 (0.800)	Data 0.126 (0.126)	Loss_ce_clean 0.097 	Loss_ct_clean 0.095 	Prec 98.44%
Epoch: [12][50/300]	Time 0.776 (0.775)	Data 0.107 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.092 	Prec 98.96%
Epoch: [12][100/300]	Time 0.774 (0.774)	Data 0.105 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.186 	Prec 98.97%
Epoch: [12][150/300]	Time 0.773 (0.774)	Data 0.103 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.222 	Prec 99.02%
Epoch: [12][200/300]	Time 0.781 (0.774)	Data 0.111 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.237 	Prec 99.07%
Epoch: [12][250/300]	Time 0.774 (0.774)	Data 0.104 (0.105)	Loss_ce_clean 0.083 	Loss_ct_clean 0.244 	Prec 99.07%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.821177959442139
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.70072889328003
The orignal cluster result: num cluster = 1487(model) // 1447(model_ema) 	 num outliers = 532(model) // 724(model_ema)
Applying hierarchical clustering
[1028 1362  271 ... 1333 1241 1403]
(16522,)
(array([   72,    83,    85,    97,   104,   112,   182,   188,   197,
         213,   220,   241,   269,   277,   383,   394,   400,   417,
         422,   443,   460,   481,   506,   519,   580,   588,   637,
         672,   676,   677,   714,   715,   752,   754,   798,   799,
         827,   851,   854,   861,   965,   987,   997,  1001,  1037,
        1059,  1063,  1098,  1197,  1209,  1246,  1359,  1402,  1460,
        1473,  1520,  1526,  1528,  1573,  1631,  1685,  1723,  1735,
        1783,  1833,  1835,  1854,  1871,  1998,  2017,  2039,  2119,
        2147,  2148,  2170,  2205,  2236,  2241,  2282,  2330,  2374,
        2406,  2431,  2441,  2447,  2465,  2494,  2501,  2505,  2575,
        2584,  2586,  2612,  2684,  2703,  2725,  2758,  2769,  2783,
        2796,  2814,  2818,  2871,  2876,  2883,  2913,  2947,  2986,
        3015,  3027,  3036,  3037,  3073,  3117,  3129,  3142,  3157,
        3178,  3180,  3223,  3226,  3271,  3280,  3311,  3330,  3434,
        3448,  3540,  3553,  3570,  3575,  3615,  3641,  3685,  3708,
        3716,  3764,  3774,  3794,  3815,  3873,  3889,  3906,  3908,
        3933,  3972,  4022,  4143,  4221,  4247,  4251,  4257,  4393,
        4410,  4428,  4429,  4433,  4487,  4496,  4499,  4539,  4566,
        4609,  4614,  4632,  4637,  4638,  4651,  4777,  4849,  4902,
        4914,  5003,  5023,  5082,  5129,  5141,  5184,  5215,  5232,
        5239,  5265,  5267,  5279,  5280,  5332,  5361,  5418,  5567,
        5577,  5578,  5583,  5589,  5603,  5763,  5795,  5812,  5848,
        5995,  6082,  6095,  6132,  6144,  6239,  6296,  6301,  6316,
        6389,  6442,  6447,  6448,  6451,  6491,  6556,  6568,  6573,
        6593,  6629,  6761,  6818,  6822,  6825,  6826,  6827,  6859,
        6860,  6876,  6898,  6957,  7111,  7145,  7181,  7188,  7206,
        7354,  7362,  7387,  7389,  7457,  7506,  7513,  7515,  7528,
        7560,  7565,  7604,  7725,  7765,  7796,  7814,  7831,  7919,
        7928,  7980,  7981,  8059,  8063,  8101,  8114,  8134,  8186,
        8215,  8237,  8263,  8285,  8319,  8340,  8373,  8381,  8471,
        8487,  8497,  8525,  8576,  8577,  8579,  8584,  8688,  8705,
        8721,  8746,  8778,  8780,  8787,  8799,  8880,  8893,  8907,
        8909,  8926,  8931,  8966,  9005,  9044,  9057,  9081,  9107,
        9126,  9154,  9159,  9226,  9237,  9282,  9399,  9471,  9485,
        9487,  9497,  9504,  9535,  9590,  9600,  9631,  9645,  9675,
        9720,  9752,  9759,  9782,  9794,  9810,  9835,  9838,  9897,
        9939,  9941,  9944,  9961,  9988, 10007, 10015, 10047, 10057,
       10070, 10076, 10149, 10205, 10215, 10435, 10453, 10460, 10482,
       10493, 10507, 10589, 10593, 10627, 10640, 10642, 10762, 10770,
       10794, 10825, 10854, 10923, 10946, 10973, 11004, 11059, 11092,
       11112, 11116, 11132, 11224, 11274, 11317, 11324, 11354, 11420,
       11514, 11553, 11610, 11634, 11674, 11686, 11693, 11723, 11767,
       11827, 11905, 11972, 12031, 12044, 12079, 12090, 12154, 12226,
       12234, 12375, 12394, 12412, 12414, 12434, 12448, 12453, 12474,
       12478, 12510, 12550, 12557, 12643, 12655, 12661, 12681, 12688,
       12699, 12715, 12721, 12749, 12759, 12875, 12980, 12984, 13035,
       13051, 13077, 13113, 13120, 13129, 13160, 13190, 13200, 13213,
       13224, 13229, 13235, 13248, 13260, 13277, 13292, 13300, 13320,
       13388, 13409, 13441, 13444, 13462, 13489, 13511, 13519, 13528,
       13545, 13558, 13597, 13601, 13606, 13625, 13651, 13724, 13795,
       13875, 13890, 13911, 13976, 13991, 14052, 14079, 14164, 14174,
       14220, 14222, 14235, 14261, 14278, 14295, 14325, 14339, 14368,
       14371, 14425, 14431, 14447, 14459, 14461, 14508, 14559, 14578,
       14591, 14593, 14623, 14634, 14756, 14865, 14898, 14909, 14950,
       14970, 15005, 15090, 15121, 15141, 15156, 15161, 15166, 15197,
       15200, 15257, 15287, 15324, 15340, 15402, 15424, 15432, 15443,
       15447, 15454, 15484, 15575, 15592, 15608, 15653, 15731, 15851,
       15869, 15914, 15969, 15978, 15998, 16058, 16086, 16138, 16174,
       16191, 16202, 16238, 16240, 16292, 16334, 16436, 16467, 16474,
       16507]),)
(16522, 16522)
(15990, 16522)
(15990, 15990)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.124793291091919s
The HC Re-cluster result: num cluster = 1487(model) // 1447(model_ema) 	 num outliers = 532(model) // 724(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8454768657684326s
The UCIS result: num clean cluster = 1455(model) 	 num outliers = 1133(model)
mdoel:new class are [1456], length of new dataset is 15389
Epoch: [13][0/300]	Time 0.792 (0.792)	Data 0.119 (0.119)	Loss_ce_clean 0.021 	Loss_ct_clean 0.019 	Prec 100.00%
Epoch: [13][50/300]	Time 0.779 (0.775)	Data 0.110 (0.105)	Loss_ce_clean 0.083 	Loss_ct_clean 0.090 	Prec 98.88%
Epoch: [13][100/300]	Time 0.774 (0.775)	Data 0.103 (0.105)	Loss_ce_clean 0.083 	Loss_ct_clean 0.186 	Prec 98.93%
Epoch: [13][150/300]	Time 0.771 (0.774)	Data 0.102 (0.105)	Loss_ce_clean 0.083 	Loss_ct_clean 0.218 	Prec 98.98%
Epoch: [13][200/300]	Time 0.775 (0.774)	Data 0.105 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.229 	Prec 99.00%
Epoch: [13][250/300]	Time 0.776 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.081 	Loss_ct_clean 0.234 	Prec 99.04%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.752176284790039
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.641160488128662
The orignal cluster result: num cluster = 1493(model) // 1464(model_ema) 	 num outliers = 551(model) // 642(model_ema)
Applying hierarchical clustering
[ 518 1295  320 ... 1432 1344 1372]
(16522,)
(array([    6,    72,    85,    97,   104,   112,   182,   188,   220,
         241,   269,   383,   394,   412,   417,   422,   437,   443,
         445,   460,   481,   588,   637,   672,   676,   677,   689,
         714,   715,   752,   755,   808,   832,   854,   861,   874,
         911,   965,   987,   997,  1001,  1037,  1057,  1063,  1082,
        1097,  1098,  1140,  1197,  1203,  1246,  1262,  1396,  1402,
        1460,  1473,  1520,  1573,  1613,  1631,  1675,  1723,  1735,
        1746,  1833,  1835,  1938,  1998,  2039,  2147,  2148,  2170,
        2205,  2241,  2282,  2299,  2307,  2431,  2465,  2501,  2505,
        2564,  2575,  2584,  2612,  2636,  2680,  2694,  2703,  2717,
        2725,  2769,  2783,  2794,  2796,  2814,  2818,  2835,  2871,
        2876,  2935,  2986,  3027,  3037,  3050,  3059,  3073,  3117,
        3126,  3129,  3142,  3157,  3178,  3180,  3202,  3208,  3219,
        3223,  3249,  3264,  3271,  3280,  3304,  3311,  3330,  3388,
        3434,  3448,  3480,  3540,  3570,  3575,  3641,  3685,  3695,
        3716,  3720,  3728,  3764,  3794,  3815,  3873,  3908,  3933,
        3947,  3961,  4106,  4143,  4209,  4221,  4242,  4251,  4257,
        4321,  4332,  4393,  4410,  4429,  4433,  4496,  4498,  4539,
        4563,  4566,  4614,  4637,  4651,  4682,  4747,  4764,  4777,
        4798,  4902,  4914,  4939,  5082,  5084,  5184,  5239,  5255,
        5265,  5267,  5279,  5280,  5317,  5332,  5361,  5362,  5386,
        5410,  5418,  5534,  5542,  5567,  5577,  5578,  5583,  5603,
        5710,  5750,  5795,  5816,  5894,  5913,  6067,  6082,  6111,
        6132,  6144,  6239,  6296,  6301,  6316,  6319,  6389,  6448,
        6467,  6556,  6593,  6629,  6632,  6658,  6744,  6761,  6818,
        6820,  6825,  6859,  6860,  6898,  6957,  6965,  7110,  7145,
        7162,  7176,  7181,  7259,  7354,  7362,  7378,  7382,  7387,
        7389,  7440,  7446,  7457,  7506,  7513,  7515,  7516,  7528,
        7538,  7560,  7564,  7565,  7632,  7722,  7765,  7772,  7796,
        7928,  7980,  7981,  7985,  8059,  8063,  8101,  8215,  8227,
        8237,  8285,  8340,  8373,  8381,  8471,  8491,  8510,  8525,
        8576,  8577,  8579,  8594,  8609,  8688,  8705,  8746,  8778,
        8780,  8799,  8818,  8880,  8884,  8893,  8909,  8926,  8931,
        9057,  9059,  9081,  9136,  9159,  9226,  9282,  9308,  9328,
        9354,  9398,  9471,  9485,  9497,  9504,  9535,  9539,  9554,
        9562,  9600,  9645,  9675,  9699,  9720,  9728,  9746,  9752,
        9759,  9782,  9792,  9835,  9838,  9854,  9936,  9941,  9944,
        9961,  9978,  9988, 10007, 10047, 10052, 10058, 10070, 10149,
       10154, 10177, 10205, 10215, 10254, 10306, 10369, 10384, 10408,
       10425, 10435, 10445, 10453, 10460, 10465, 10482, 10540, 10556,
       10589, 10593, 10604, 10665, 10701, 10749, 10750, 10762, 10770,
       10794, 10804, 10821, 10825, 10846, 10854, 10877, 10933, 10946,
       10973, 10991, 11004, 11059, 11106, 11112, 11116, 11194, 11195,
       11224, 11274, 11297, 11317, 11324, 11354, 11407, 11415, 11420,
       11463, 11472, 11610, 11674, 11693, 11701, 11827, 11900, 11912,
       11939, 11972, 12031, 12073, 12154, 12208, 12226, 12231, 12234,
       12394, 12412, 12414, 12434, 12453, 12510, 12550, 12557, 12605,
       12655, 12658, 12688, 12699, 12703, 12715, 12721, 12749, 12759,
       12876, 12916, 12974, 12980, 12984, 13051, 13099, 13102, 13113,
       13120, 13129, 13160, 13190, 13213, 13224, 13229, 13235, 13242,
       13248, 13260, 13277, 13292, 13300, 13320, 13382, 13387, 13388,
       13409, 13441, 13444, 13489, 13528, 13545, 13597, 13601, 13606,
       13615, 13651, 13680, 13707, 13724, 13734, 13841, 13861, 13875,
       13890, 13911, 13976, 13991, 14052, 14079, 14112, 14135, 14164,
       14174, 14220, 14222, 14235, 14255, 14266, 14278, 14295, 14314,
       14327, 14339, 14371, 14429, 14447, 14459, 14461, 14508, 14534,
       14578, 14579, 14634, 14756, 14865, 14898, 14909, 14970, 15005,
       15006, 15068, 15090, 15156, 15161, 15197, 15229, 15257, 15297,
       15340, 15402, 15424, 15484, 15575, 15592, 15653, 15731, 15752,
       15807, 15851, 15912, 15914, 15969, 15978, 15998, 16023, 16058,
       16086, 16138, 16174, 16191, 16202, 16240, 16251, 16334, 16467,
       16507, 16515]),)
(16522, 16522)
(15971, 16522)
(15971, 15971)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.143733024597168s
The HC Re-cluster result: num cluster = 1493(model) // 1464(model_ema) 	 num outliers = 551(model) // 642(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8379044532775879s
The UCIS result: num clean cluster = 1465(model) 	 num outliers = 1109(model)
mdoel:new class are [1466], length of new dataset is 15413
Epoch: [14][0/300]	Time 0.797 (0.797)	Data 0.123 (0.123)	Loss_ce_clean 0.064 	Loss_ct_clean 0.064 	Prec 97.66%
Epoch: [14][50/300]	Time 0.774 (0.775)	Data 0.105 (0.105)	Loss_ce_clean 0.080 	Loss_ct_clean 0.085 	Prec 98.93%
Epoch: [14][100/300]	Time 0.775 (0.774)	Data 0.105 (0.105)	Loss_ce_clean 0.081 	Loss_ct_clean 0.184 	Prec 98.85%
Epoch: [14][150/300]	Time 0.778 (0.774)	Data 0.104 (0.105)	Loss_ce_clean 0.078 	Loss_ct_clean 0.209 	Prec 98.96%
Epoch: [14][200/300]	Time 0.775 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.079 	Loss_ct_clean 0.221 	Prec 99.00%
Epoch: [14][250/300]	Time 0.778 (0.774)	Data 0.108 (0.105)	Loss_ce_clean 0.078 	Loss_ct_clean 0.228 	Prec 99.06%
Extract Features: [100/156]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Mean AP: 49.6%
CMC Scores:
  top-1          67.1%
  top-5          79.6%
  top-10         83.9%
Extract Features: [100/156]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Mean AP: 53.2%
CMC Scores:
  top-1          70.2%
  top-5          81.2%
  top-10         85.3%

 * Finished epoch  14  model no.1 mAP: 49.6% model no.2(mean-net) mAP: 53.2%  best: 53.9%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.154 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.681232929229736
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.719706773757935
The orignal cluster result: num cluster = 1511(model) // 1480(model_ema) 	 num outliers = 488(model) // 589(model_ema)
Applying hierarchical clustering
[ 721 1164  403 ... 1476  910 1371]
(16522,)
(array([   75,    85,   112,   182,   188,   197,   213,   241,   269,
         376,   383,   394,   412,   422,   443,   460,   481,   519,
         530,   588,   637,   643,   677,   689,   714,   752,   759,
         799,   808,   851,   854,   861,   907,   965,   987,  1037,
        1053,  1059,  1082,  1097,  1098,  1246,  1263,  1359,  1402,
        1408,  1413,  1460,  1473,  1528,  1587,  1605,  1685,  1735,
        1746,  1833,  1871,  1878,  1912,  1998,  2085,  2108,  2119,
        2170,  2182,  2205,  2228,  2236,  2241,  2299,  2307,  2330,
        2374,  2403,  2406,  2431,  2438,  2441,  2465,  2494,  2501,
        2505,  2584,  2585,  2612,  2684,  2694,  2703,  2758,  2794,
        2796,  2814,  2818,  2871,  2876,  2913,  2922,  2947,  3015,
        3027,  3030,  3036,  3037,  3050,  3052,  3059,  3073,  3117,
        3126,  3129,  3157,  3178,  3202,  3223,  3271,  3280,  3304,
        3309,  3330,  3434,  3448,  3480,  3570,  3575,  3615,  3685,
        3695,  3720,  3728,  3774,  3794,  3815,  3873,  3933,  3958,
        4105,  4106,  4143,  4221,  4242,  4247,  4251,  4321,  4400,
        4409,  4410,  4428,  4429,  4433,  4487,  4496,  4498,  4499,
        4533,  4539,  4566,  4614,  4637,  4651,  4682,  4747,  4764,
        4902,  4939,  5023,  5082,  5084,  5232,  5239,  5265,  5267,
        5277,  5280,  5317,  5361,  5418,  5559,  5567,  5577,  5583,
        5603,  5669,  5712,  5795,  5812,  5913,  5949,  6067,  6082,
        6128,  6144,  6296,  6319,  6448,  6466,  6467,  6491,  6556,
        6593,  6629,  6632,  6658,  6696,  6738,  6747,  6761,  6818,
        6820,  6825,  6874,  6876,  6898,  6957,  7110,  7145,  7162,
        7176,  7188,  7206,  7362,  7389,  7440,  7446,  7457,  7506,
        7513,  7528,  7538,  7565,  7573,  7589,  7597,  7632,  7722,
        7752,  7765,  7796,  7814,  7980,  7981,  8044,  8059,  8160,
        8237,  8263,  8285,  8319,  8340,  8471,  8525,  8609,  8705,
        8746,  8778,  8787,  8818,  8880,  8893,  8931,  9025,  9081,
        9085,  9107,  9126,  9159,  9282,  9398,  9471,  9485,  9497,
        9504,  9535,  9539,  9554,  9562,  9693,  9752,  9782,  9792,
        9835,  9838,  9897,  9939,  9941,  9944,  9961,  9988, 10007,
       10047, 10052, 10058, 10070, 10076, 10077, 10140, 10154, 10177,
       10215, 10245, 10306, 10337, 10408, 10435, 10445, 10453, 10460,
       10482, 10507, 10540, 10561, 10589, 10593, 10640, 10665, 10697,
       10750, 10770, 10780, 10794, 10821, 10825, 10877, 10933, 10946,
       10973, 10983, 10991, 11059, 11092, 11112, 11132, 11195, 11224,
       11262, 11274, 11291, 11297, 11317, 11324, 11354, 11420, 11472,
       11514, 11610, 11674, 11681, 11693, 11698, 11798, 11827, 11912,
       11939, 12031, 12073, 12154, 12208, 12226, 12231, 12234, 12277,
       12412, 12423, 12453, 12478, 12510, 12550, 12557, 12655, 12688,
       12715, 12721, 12749, 12759, 12876, 12879, 12980, 13035, 13051,
       13099, 13102, 13113, 13120, 13159, 13160, 13190, 13235, 13239,
       13242, 13248, 13260, 13292, 13296, 13300, 13320, 13337, 13352,
       13382, 13388, 13409, 13441, 13489, 13545, 13597, 13601, 13606,
       13615, 13625, 13651, 13680, 13707, 13724, 13734, 13795, 13841,
       13866, 13911, 13940, 13976, 13991, 14052, 14079, 14112, 14124,
       14174, 14202, 14220, 14278, 14314, 14327, 14339, 14447, 14459,
       14461, 14506, 14534, 14579, 14634, 14675, 14692, 14857, 14898,
       14950, 14970, 15005, 15076, 15090, 15121, 15141, 15161, 15170,
       15182, 15197, 15240, 15257, 15287, 15340, 15402, 15432, 15451,
       15484, 15592, 15608, 15613, 15731, 15752, 15807, 15851, 15912,
       15978, 16029, 16058, 16086, 16138, 16148, 16202, 16238, 16240,
       16251, 16276, 16290, 16292, 16300, 16436, 16461, 16467, 16474,
       16507, 16515]),)
(16522, 16522)
(16034, 16522)
(16034, 16034)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1859078407287598s
The HC Re-cluster result: num cluster = 1511(model) // 1480(model_ema) 	 num outliers = 488(model) // 589(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8383557796478271s
The UCIS result: num clean cluster = 1481(model) 	 num outliers = 1023(model)
mdoel:new class are [1482], length of new dataset is 15499
Epoch: [15][0/300]	Time 0.797 (0.797)	Data 0.122 (0.122)	Loss_ce_clean 0.029 	Loss_ct_clean 0.027 	Prec 100.00%
Epoch: [15][50/300]	Time 0.782 (0.775)	Data 0.113 (0.106)	Loss_ce_clean 0.074 	Loss_ct_clean 0.074 	Prec 98.90%
Epoch: [15][100/300]	Time 0.774 (0.775)	Data 0.104 (0.105)	Loss_ce_clean 0.071 	Loss_ct_clean 0.166 	Prec 99.10%
Epoch: [15][150/300]	Time 0.784 (0.775)	Data 0.114 (0.105)	Loss_ce_clean 0.071 	Loss_ct_clean 0.196 	Prec 99.14%
Epoch: [15][200/300]	Time 0.775 (0.775)	Data 0.105 (0.105)	Loss_ce_clean 0.071 	Loss_ct_clean 0.206 	Prec 99.18%
Epoch: [15][250/300]	Time 0.775 (0.775)	Data 0.106 (0.105)	Loss_ce_clean 0.071 	Loss_ct_clean 0.211 	Prec 99.19%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.824998617172241
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.779237031936646
The orignal cluster result: num cluster = 1532(model) // 1490(model_ema) 	 num outliers = 439(model) // 506(model_ema)
Applying hierarchical clustering
[ 706 1365 1034 ... 1494 1264 1063]
(16522,)
(array([   75,    85,   161,   170,   188,   197,   220,   241,   264,
         341,   443,   460,   481,   588,   676,   677,   714,   808,
         861,   965,   987,   997,  1057,  1059,  1063,  1082,  1098,
        1162,  1197,  1300,  1396,  1402,  1460,  1528,  1587,  1613,
        1631,  1685,  1723,  1735,  1741,  1750,  1833,  1854,  1871,
        1931,  1944,  1976,  1998,  2039,  2066,  2119,  2147,  2170,
        2205,  2236,  2282,  2307,  2330,  2431,  2438,  2441,  2465,
        2494,  2505,  2612,  2694,  2725,  2758,  2783,  2796,  2814,
        2818,  2861,  2871,  2878,  2913,  2947,  2957,  3027,  3030,
        3038,  3097,  3105,  3117,  3157,  3178,  3180,  3271,  3280,
        3304,  3330,  3448,  3480,  3520,  3570,  3593,  3685,  3695,
        3708,  3716,  3720,  3774,  3787,  3794,  3803,  3851,  3896,
        3908,  3933,  3958,  3963,  4143,  4209,  4221,  4321,  4358,
        4400,  4410,  4428,  4429,  4433,  4487,  4498,  4499,  4553,
        4563,  4566,  4587,  4614,  4637,  4682,  4747,  4861,  4902,
        5023,  5025,  5046,  5053,  5084,  5094,  5117,  5182,  5184,
        5232,  5265,  5267,  5280,  5289,  5332,  5361,  5418,  5510,
        5577,  5583,  5589,  5603,  5613,  5669,  5750,  5795,  5807,
        6067,  6082,  6095,  6111,  6128,  6195,  6202,  6301,  6316,
        6319,  6336,  6389,  6448,  6451,  6467,  6556,  6713,  6761,
        6820,  6822,  6825,  6860,  6876,  7110,  7162,  7181,  7307,
        7387,  7389,  7446,  7473,  7503,  7513,  7528,  7560,  7565,
        7612,  7632,  7655,  7746,  7765,  7772,  7796,  7814,  7928,
        7980,  8101,  8131,  8186,  8215,  8237,  8249,  8263,  8285,
        8314,  8373,  8381,  8471,  8487,  8491,  8525,  8544,  8577,
        8579,  8705,  8746,  8778,  8780,  8893,  8909,  8931,  8959,
        9006,  9025,  9057,  9145,  9184,  9226,  9398,  9471,  9485,
        9497,  9504,  9539,  9562,  9720,  9752,  9794,  9835,  9930,
        9936,  9939,  9941,  9944,  9978, 10007, 10031, 10047, 10058,
       10070, 10074, 10076, 10105, 10149, 10215, 10220, 10369, 10397,
       10408, 10435, 10445, 10460, 10482, 10546, 10589, 10593, 10629,
       10640, 10693, 10701, 10750, 10770, 10780, 10794, 10825, 10877,
       10933, 10973, 10991, 11004, 11037, 11059, 11092, 11112, 11116,
       11132, 11194, 11244, 11256, 11274, 11297, 11317, 11324, 11415,
       11420, 11496, 11514, 11571, 11610, 11623, 11657, 11674, 11693,
       11701, 11785, 11827, 11905, 11939, 12031, 12032, 12073, 12083,
       12154, 12210, 12231, 12375, 12394, 12397, 12412, 12414, 12448,
       12453, 12458, 12478, 12510, 12557, 12576, 12655, 12661, 12699,
       12715, 12721, 12732, 12779, 12845, 12876, 12929, 12980, 12984,
       13051, 13102, 13120, 13129, 13131, 13160, 13190, 13235, 13271,
       13292, 13300, 13337, 13352, 13388, 13409, 13441, 13444, 13489,
       13528, 13545, 13601, 13606, 13615, 13651, 13677, 13724, 13734,
       13795, 13807, 13890, 13967, 13976, 13991, 14052, 14079, 14121,
       14174, 14220, 14235, 14278, 14295, 14306, 14339, 14361, 14421,
       14459, 14461, 14506, 14534, 14578, 14634, 14950, 14970, 14997,
       15005, 15041, 15052, 15076, 15090, 15121, 15141, 15161, 15182,
       15200, 15229, 15288, 15340, 15424, 15454, 15500, 15575, 15592,
       15653, 15731, 15752, 15807, 15851, 15998, 16058, 16086, 16138,
       16174, 16202, 16241, 16334, 16467, 16480, 16507]),)
(16522, 16522)
(16083, 16522)
(16083, 16083)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1377933025360107s
The HC Re-cluster result: num cluster = 1532(model) // 1490(model_ema) 	 num outliers = 439(model) // 506(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.836737871170044s
The UCIS result: num clean cluster = 1515(model) 	 num outliers = 811(model)
mdoel:new class are [1516], length of new dataset is 15711
Epoch: [16][0/300]	Time 0.786 (0.786)	Data 0.114 (0.114)	Loss_ce_clean 0.059 	Loss_ct_clean 0.060 	Prec 98.44%
Epoch: [16][50/300]	Time 0.773 (0.775)	Data 0.103 (0.106)	Loss_ce_clean 0.073 	Loss_ct_clean 0.070 	Prec 99.03%
Epoch: [16][100/300]	Time 0.778 (0.774)	Data 0.108 (0.105)	Loss_ce_clean 0.074 	Loss_ct_clean 0.165 	Prec 99.09%
Epoch: [16][150/300]	Time 0.773 (0.774)	Data 0.103 (0.105)	Loss_ce_clean 0.073 	Loss_ct_clean 0.194 	Prec 99.13%
Epoch: [16][200/300]	Time 0.776 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.073 	Loss_ct_clean 0.203 	Prec 99.13%
Epoch: [16][250/300]	Time 0.776 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.073 	Loss_ct_clean 0.209 	Prec 99.16%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.815369606018066
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.843446969985962
The orignal cluster result: num cluster = 1537(model) // 1511(model_ema) 	 num outliers = 373(model) // 459(model_ema)
Applying hierarchical clustering
[ 482 1252 1230 ... 1461 1283 1496]
(16522,)
(array([   75,   112,   161,   188,   197,   213,   220,   241,   383,
         394,   443,   460,   519,   524,   588,   637,   677,   689,
         714,   752,   799,   861,   907,   965,   987,   997,  1057,
        1059,  1098,  1197,  1276,  1300,  1359,  1396,  1402,  1413,
        1573,  1618,  1735,  1819,  1833,  1854,  2039,  2119,  2147,
        2170,  2182,  2205,  2300,  2319,  2431,  2465,  2505,  2575,
        2612,  2680,  2703,  2725,  2770,  2783,  2796,  2814,  2818,
        2871,  2876,  2922,  2927,  3015,  3050,  3073,  3097,  3105,
        3117,  3121,  3142,  3157,  3178,  3180,  3223,  3271,  3330,
        3448,  3480,  3593,  3615,  3695,  3716,  3794,  3803,  3812,
        3851,  3896,  3908,  3933,  4196,  4199,  4209,  4247,  4251,
        4321,  4358,  4400,  4410,  4428,  4429,  4433,  4487,  4496,
        4499,  4566,  4614,  4632,  4637,  4682,  4768,  4902,  4958,
        5084,  5094,  5117,  5215,  5232,  5267,  5280,  5289,  5327,
        5332,  5362,  5465,  5567,  5578,  5583,  5589,  5603,  5807,
        5812,  5848,  6082,  6095,  6128,  6296,  6316,  6319,  6389,
        6467,  6468,  6556,  6727,  6761,  6820,  6825,  6860,  6876,
        6946,  7110,  7145,  7307,  7387,  7389,  7473,  7506,  7538,
        7560,  7565,  7612,  7625,  7632,  7655,  7765,  7796,  7814,
        7928,  7980,  7985,  8044,  8059,  8101,  8215,  8232,  8237,
        8285,  8373,  8381,  8510,  8525,  8577,  8579,  8688,  8746,
        8778,  8780,  8787,  8824,  8893,  8909,  8931,  9006,  9025,
        9057,  9107,  9159,  9226,  9399,  9471,  9497,  9504,  9554,
        9562,  9645,  9674,  9675,  9752,  9759,  9782,  9792,  9835,
        9930,  9936,  9941, 10007, 10031, 10047, 10058, 10070, 10074,
       10149, 10215, 10254, 10408, 10445, 10453, 10460, 10482, 10589,
       10593, 10629, 10642, 10693, 10721, 10750, 10770, 10794, 10825,
       10877, 10946, 10973, 10985, 11004, 11027, 11112, 11116, 11132,
       11194, 11274, 11297, 11317, 11324, 11420, 11610, 11623, 11701,
       11783, 11785, 11827, 11905, 11939, 12031, 12083, 12154, 12226,
       12231, 12317, 12423, 12453, 12510, 12576, 12655, 12657, 12658,
       12665, 12699, 12721, 12759, 12802, 12845, 12974, 12984, 13051,
       13075, 13113, 13120, 13129, 13160, 13190, 13229, 13235, 13242,
       13260, 13292, 13300, 13320, 13337, 13352, 13388, 13389, 13409,
       13444, 13462, 13489, 13511, 13545, 13615, 13625, 13651, 13677,
       13724, 13795, 13911, 13940, 13967, 13976, 13988, 13991, 14052,
       14079, 14121, 14174, 14220, 14235, 14261, 14278, 14295, 14314,
       14361, 14459, 14461, 14506, 14534, 14578, 14579, 14593, 14634,
       14670, 14970, 14997, 15005, 15090, 15121, 15141, 15161, 15188,
       15229, 15257, 15340, 15354, 15575, 15592, 15613, 15731, 15752,
       15851, 15912, 16029, 16086, 16121, 16138, 16174, 16202, 16238,
       16312, 16474, 16480, 16515]),)
(16522, 16522)
(16149, 16522)
(16149, 16149)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.248948335647583s
The HC Re-cluster result: num cluster = 1537(model) // 1511(model_ema) 	 num outliers = 373(model) // 459(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.847693681716919s
The UCIS result: num clean cluster = 1510(model) 	 num outliers = 947(model)
mdoel:new class are [1511], length of new dataset is 15575
Epoch: [17][0/300]	Time 0.790 (0.790)	Data 0.115 (0.115)	Loss_ce_clean 0.065 	Loss_ct_clean 0.062 	Prec 99.22%
Epoch: [17][50/300]	Time 0.776 (0.775)	Data 0.107 (0.106)	Loss_ce_clean 0.063 	Loss_ct_clean 0.064 	Prec 99.07%
Epoch: [17][100/300]	Time 0.775 (0.775)	Data 0.105 (0.106)	Loss_ce_clean 0.063 	Loss_ct_clean 0.146 	Prec 99.21%
Epoch: [17][150/300]	Time 0.775 (0.775)	Data 0.105 (0.105)	Loss_ce_clean 0.063 	Loss_ct_clean 0.171 	Prec 99.25%
Epoch: [17][200/300]	Time 0.775 (0.775)	Data 0.106 (0.105)	Loss_ce_clean 0.065 	Loss_ct_clean 0.182 	Prec 99.26%
Epoch: [17][250/300]	Time 0.820 (0.791)	Data 0.150 (0.110)	Loss_ce_clean 0.066 	Loss_ct_clean 0.191 	Prec 99.25%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.023081064224243
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.162 (0.193)	Data 0.000 (0.035)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.076357364654541
The orignal cluster result: num cluster = 1552(model) // 1520(model_ema) 	 num outliers = 337(model) // 430(model_ema)
Applying hierarchical clustering
[ 609  155  875 ... 1155 1348   -1]
(16522,)
(array([  112,   188,   197,   220,   241,   266,   394,   443,   460,
         519,   577,   588,   676,   677,   714,   942,   965,   987,
         997,  1059,  1098,  1162,  1197,  1246,  1276,  1396,  1402,
        1413,  1460,  1473,  1587,  1631,  1723,  1781,  1819,  1833,
        1871,  1944,  1998,  2022,  2039,  2119,  2147,  2182,  2205,
        2282,  2319,  2465,  2501,  2505,  2575,  2584,  2703,  2725,
        2783,  2796,  2814,  2818,  2871,  2876,  2922,  3027,  3036,
        3050,  3105,  3117,  3121,  3129,  3142,  3157,  3223,  3271,
        3280,  3330,  3448,  3475,  3480,  3570,  3685,  3695,  3716,
        3764,  3794,  3803,  3851,  3873,  3908,  3933,  3963,  4106,
        4209,  4247,  4251,  4321,  4410,  4433,  4496,  4499,  4539,
        4566,  4632,  4637,  4682,  4768,  4902,  5084,  5220,  5232,
        5239,  5267,  5280,  5338,  5418,  5578,  5583,  5589,  5603,
        5712,  5795,  5812,  6065,  6082,  6083,  6111,  6144,  6195,
        6290,  6316,  6319,  6448,  6467,  6696,  6727,  6761,  6818,
        6822,  6825,  7110,  7145,  7181,  7307,  7325,  7387,  7389,
        7473,  7513,  7538,  7560,  7565,  7625,  7632,  7655,  7725,
        7765,  7796,  7928,  8044,  8059,  8101,  8186,  8285,  8340,
        8373,  8379,  8381,  8411,  8471,  8505,  8510,  8525,  8544,
        8576,  8577,  8746,  8778,  8780,  8824,  8893,  8909,  8931,
        9025,  9057,  9103,  9159,  9354,  9365,  9393,  9471,  9497,
        9504,  9562,  9600,  9675,  9720,  9752,  9782,  9792,  9794,
        9835,  9936,  9939,  9941,  9978, 10007, 10047, 10140, 10149,
       10205, 10215, 10369, 10408, 10445, 10453, 10460, 10482, 10540,
       10593, 10693, 10701, 10721, 10750, 10770, 10877, 10946, 10973,
       11004, 11027, 11089, 11092, 11112, 11116, 11194, 11274, 11297,
       11317, 11324, 11407, 11420, 11496, 11514, 11610, 11674, 11701,
       11724, 11827, 11939, 12031, 12231, 12397, 12414, 12423, 12449,
       12453, 12458, 12510, 12550, 12557, 12576, 12658, 12661, 12688,
       12699, 12721, 12751, 12802, 12945, 12980, 13051, 13077, 13160,
       13190, 13292, 13300, 13320, 13388, 13409, 13441, 13444, 13489,
       13511, 13528, 13545, 13601, 13615, 13680, 13717, 13724, 13742,
       13795, 13841, 13890, 13911, 13976, 13988, 13991, 14052, 14121,
       14220, 14226, 14295, 14306, 14459, 14461, 14534, 14578, 14579,
       14591, 14593, 14670, 14898, 14979, 14997, 15005, 15052, 15056,
       15076, 15090, 15121, 15161, 15288, 15352, 15354, 15424, 15575,
       15592, 15731, 15752, 15807, 15912, 16029, 16086, 16138, 16174,
       16202, 16238, 16251, 16521]),)
(16522, 16522)
(16185, 16522)
(16185, 16185)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.696082592010498s
The HC Re-cluster result: num cluster = 1552(model) // 1520(model_ema) 	 num outliers = 337(model) // 430(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9481618404388428s
The UCIS result: num clean cluster = 1528(model) 	 num outliers = 829(model)
mdoel:new class are [1529], length of new dataset is 15693
Epoch: [18][0/300]	Time 0.829 (0.829)	Data 0.146 (0.146)	Loss_ce_clean 0.075 	Loss_ct_clean 0.079 	Prec 97.66%
Epoch: [18][50/300]	Time 0.777 (0.783)	Data 0.102 (0.113)	Loss_ce_clean 0.065 	Loss_ct_clean 0.068 	Prec 98.99%
Epoch: [18][100/300]	Time 0.770 (0.780)	Data 0.100 (0.109)	Loss_ce_clean 0.066 	Loss_ct_clean 0.154 	Prec 99.06%
Epoch: [18][150/300]	Time 0.772 (0.780)	Data 0.102 (0.110)	Loss_ce_clean 0.067 	Loss_ct_clean 0.182 	Prec 99.08%
Epoch: [18][200/300]	Time 0.780 (0.779)	Data 0.110 (0.109)	Loss_ce_clean 0.066 	Loss_ct_clean 0.190 	Prec 99.15%
Epoch: [18][250/300]	Time 1.655 (0.810)	Data 0.980 (0.138)	Loss_ce_clean 0.065 	Loss_ct_clean 0.194 	Prec 99.22%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.165)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.089522123336792
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.193)	Data 0.000 (0.038)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.034000158309937
The orignal cluster result: num cluster = 1549(model) // 1541(model_ema) 	 num outliers = 289(model) // 397(model_ema)
Applying hierarchical clustering
[ 454 1365 1247 ... 1336 1275  797]
(16522,)
(array([   75,   182,   188,   197,   213,   220,   383,   394,   443,
         460,   481,   519,   588,   637,   676,   714,   907,   965,
         987,   996,   997,  1059,  1098,  1197,  1246,  1396,  1402,
        1413,  1520,  1685,  1723,  1746,  1833,  1854,  1871,  1875,
        1944,  1998,  2039,  2119,  2182,  2205,  2241,  2319,  2330,
        2406,  2431,  2465,  2501,  2575,  2584,  2703,  2758,  2770,
        2783,  2796,  2814,  2818,  2871,  2876,  2922,  3027,  3036,
        3037,  3105,  3117,  3121,  3126,  3129,  3142,  3180,  3223,
        3249,  3271,  3330,  3448,  3480,  3492,  3570,  3593,  3695,
        3716,  3728,  3764,  3786,  3794,  3873,  3896,  3908,  3933,
        3963,  4251,  4321,  4410,  4428,  4499,  4539,  4566,  4637,
        4768,  4828,  4902,  4914,  5117,  5232,  5267,  5302,  5567,
        5583,  5603,  5795,  5848,  6065,  6067,  6111,  6144,  6195,
        6316,  6336,  6448,  6467,  6566,  6658,  6696,  6713,  6860,
        6957,  7110,  7145,  7181,  7387,  7389,  7473,  7528,  7560,
        7565,  7632,  7722,  7725,  7748,  7765,  7796,  7928,  8044,
        8059,  8101,  8237,  8285,  8319,  8340,  8471,  8525,  8544,
        8577,  8584,  8705,  8746,  8778,  8780,  8824,  8893,  8909,
        9025,  9057,  9107,  9126,  9282,  9360,  9471,  9487,  9497,
        9504,  9600,  9675,  9720,  9752,  9794,  9936,  9939, 10007,
       10047, 10140, 10149, 10154, 10453, 10460, 10482, 10546, 10589,
       10593, 10750, 10770, 10825, 10877, 10933, 10946, 10973, 11004,
       11112, 11116, 11132, 11194, 11244, 11274, 11317, 11324, 11420,
       11610, 11693, 11724, 11827, 11939, 12031, 12154, 12208, 12210,
       12226, 12231, 12414, 12453, 12510, 12557, 12658, 12661, 12699,
       12721, 12802, 12974, 12980, 12984, 13051, 13190, 13260, 13292,
       13300, 13409, 13441, 13444, 13489, 13511, 13528, 13601, 13615,
       13680, 13724, 13890, 13967, 13988, 13991, 14052, 14121, 14135,
       14174, 14220, 14226, 14235, 14295, 14306, 14459, 14461, 14534,
       14578, 14593, 14634, 14670, 14898, 14970, 14979, 15005, 15090,
       15141, 15161, 15229, 15290, 15352, 15424, 15484, 15575, 15592,
       15731, 15969, 16058, 16086, 16138, 16174, 16202, 16240, 16334,
       16467]),)
(16522, 16522)
(16233, 16522)
(16233, 16233)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.650991916656494s
The HC Re-cluster result: num cluster = 1549(model) // 1541(model_ema) 	 num outliers = 289(model) // 397(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.208465576171875s
The UCIS result: num clean cluster = 1527(model) 	 num outliers = 764(model)
mdoel:new class are [1528], length of new dataset is 15758
Epoch: [19][0/300]	Time 1.287 (1.287)	Data 0.595 (0.595)	Loss_ce_clean 0.076 	Loss_ct_clean 0.078 	Prec 96.88%
Epoch: [19][50/300]	Time 0.990 (1.059)	Data 0.320 (0.388)	Loss_ce_clean 0.055 	Loss_ct_clean 0.061 	Prec 99.16%
Epoch: [19][100/300]	Time 0.797 (0.991)	Data 0.127 (0.320)	Loss_ce_clean 0.059 	Loss_ct_clean 0.133 	Prec 99.16%
Epoch: [19][150/300]	Time 0.829 (0.938)	Data 0.159 (0.267)	Loss_ce_clean 0.060 	Loss_ct_clean 0.155 	Prec 99.18%
Epoch: [19][200/300]	Time 0.780 (0.906)	Data 0.110 (0.235)	Loss_ce_clean 0.061 	Loss_ct_clean 0.166 	Prec 99.23%
Epoch: [19][250/300]	Time 0.889 (0.915)	Data 0.218 (0.243)	Loss_ce_clean 0.062 	Loss_ct_clean 0.171 	Prec 99.26%
Extract Features: [100/156]	Time 0.160 (0.362)	Data 0.000 (0.203)	
Mean AP: 48.2%
CMC Scores:
  top-1          65.0%
  top-5          78.2%
  top-10         83.4%
Extract Features: [100/156]	Time 0.155 (0.163)	Data 0.000 (0.008)	
Mean AP: 50.9%
CMC Scores:
  top-1          68.2%
  top-5          79.9%
  top-10         84.6%

 * Finished epoch  19  model no.1 mAP: 48.2% model no.2(mean-net) mAP: 50.9%  best: 53.9%

Test on the best model.
=> Loaded checkpoint 'logs/dbscan/market2duke/model_best.pth.tar'
Extract Features: [100/156]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Mean AP: 53.9%
CMC Scores:
  top-1          70.0%
  top-5          81.1%
  top-10         85.3%
==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=False, UCIS=False)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
load pretrain model:/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
Test on the best model.
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
Extract Features: [100/156]	Time 0.739 (0.758)	Data 0.000 (0.003)	
Mean AP: 53.9%
CMC Scores:
  top-1          70.0%
  top-5          81.1%
  top-10         85.3%
==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=False, UCIS=False)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
load pretrain model:/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
Test on the best model.
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
Extract Features: [100/156]	Time 0.736 (0.743)	Data 0.000 (0.004)	
Mean AP: 71.7%
CMC Scores:
  top-1          84.2%
  top-5          91.9%
  top-10         93.6%
==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=False, UCIS=False)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
load pretrain model:/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
Test on the best model.
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
Extract Features: [100/156]	Time 0.748 (0.745)	Data 0.000 (0.005)	
Mean AP: 71.7%
CMC Scores:
  top-1          84.2%
  top-5          91.9%
  top-10         93.6%
==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=False, UCIS=False)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
load pretrain model:/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 1.750 (1.599)	Data 0.000 (0.004)	
==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=True, UCIS=True)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
load pretrain model:/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
==> Create pseudo labels for unlabeled target domain with model
==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=True, UCIS=True)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
load pretrain model:/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 1.771 (1.577)	Data 0.000 (0.005)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 226.00817823410034
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 1.743 (1.384)	Data 0.000 (0.018)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 186.71833848953247
The orignal cluster result: num cluster = 1102(model) // 1105(model_ema) 	 num outliers = 934(model) // 948(model_ema)
Applying hierarchical clustering
[ 480  262  766 ...  908 1090  665]
(16522,)
(array([    6,    41,    62,    65,    72,    74,    79,    97,   100,
         104,   135,   171,   183,   198,   205,   207,   241,   243,
         244,   247,   249,   261,   269,   271,   277,   278,   302,
         313,   317,   329,   338,   342,   343,   356,   390,   391,
         419,   434,   455,   463,   511,   514,   539,   545,   588,
         594,   596,   632,   644,   680,   714,   731,   754,   769,
         782,   785,   802,   808,   832,   853,   856,   857,   861,
         907,   911,   918,   925,   938,   953,   996,  1001,  1014,
        1030,  1041,  1045,  1053,  1063,  1076,  1098,  1140,  1159,
        1166,  1194,  1234,  1295,  1307,  1341,  1345,  1359,  1365,
        1384,  1386,  1389,  1413,  1423,  1439,  1460,  1468,  1497,
        1509,  1530,  1531,  1556,  1567,  1570,  1600,  1605,  1644,
        1654,  1697,  1741,  1751,  1759,  1764,  1769,  1783,  1844,
        1944,  1976,  1983,  1994,  2011,  2013,  2054,  2063,  2099,
        2101,  2112,  2117,  2119,  2126,  2135,  2157,  2182,  2213,
        2228,  2248,  2289,  2295,  2300,  2315,  2322,  2396,  2403,
        2414,  2447,  2476,  2494,  2532,  2537,  2546,  2554,  2564,
        2584,  2585,  2590,  2613,  2655,  2689,  2690,  2710,  2727,
        2732,  2769,  2799,  2801,  2803,  2814,  2862,  2872,  2876,
        2883,  2889,  2927,  2929,  2934,  2952,  3015,  3027,  3030,
        3031,  3090,  3114,  3199,  3202,  3266,  3271,  3283,  3306,
        3310,  3315,  3333,  3353,  3355,  3373,  3376,  3384,  3390,
        3395,  3412,  3427,  3448,  3453,  3507,  3513,  3549,  3553,
        3571,  3582,  3598,  3636,  3639,  3655,  3670,  3682,  3695,
        3764,  3784,  3814,  3838,  3873,  3874,  3880,  3884,  3900,
        3918,  3933,  3961,  3963,  4004,  4040,  4054,  4061,  4072,
        4094,  4097,  4105,  4116,  4165,  4171,  4199,  4205,  4214,
        4221,  4251,  4259,  4264,  4281,  4296,  4325,  4327,  4334,
        4372,  4373,  4400,  4409,  4421,  4424,  4428,  4429,  4437,
        4448,  4526,  4532,  4569,  4584,  4590,  4610,  4614,  4632,
        4663,  4682,  4684,  4716,  4749,  4770,  4777,  4778,  4798,
        4823,  4876,  4880,  4884,  4899,  4902,  4946,  4979,  4981,
        4987,  4995,  5035,  5082,  5129,  5131,  5134,  5180,  5184,
        5232,  5297,  5302,  5317,  5343,  5361,  5394,  5418,  5446,
        5473,  5474,  5491,  5512,  5539,  5546,  5554,  5558,  5559,
        5603,  5608,  5611,  5629,  5655,  5677,  5695,  5696,  5709,
        5715,  5732,  5736,  5757,  5768,  5774,  5777,  5802,  5813,
        5829,  5831,  5852,  5867,  5877,  5879,  5883,  5909,  5929,
        5947,  5952,  5968,  6023,  6025,  6080,  6102,  6129,  6132,
        6144,  6147,  6160,  6174,  6195,  6208,  6243,  6253,  6261,
        6302,  6322,  6380,  6418,  6432,  6441,  6443,  6451,  6458,
        6466,  6467,  6473,  6477,  6488,  6520,  6531,  6538,  6542,
        6593,  6607,  6631,  6634,  6666,  6679,  6702,  6703,  6757,
        6760,  6765,  6860,  6867,  6875,  6885,  6887,  6911,  6940,
        6992,  7035,  7059,  7073,  7091,  7110,  7139,  7166,  7172,
        7186,  7187,  7214,  7282,  7289,  7336,  7374,  7388,  7393,
        7414,  7482,  7495,  7503,  7510,  7573,  7575,  7593,  7597,
        7612,  7625,  7632,  7655,  7689,  7725,  7748,  7772,  7778,
        7814,  7841,  7842,  7858,  7912,  7919,  7934,  7976,  7981,
        7982,  7985,  8050,  8061,  8081,  8089,  8093,  8101,  8104,
        8117,  8134,  8146,  8198,  8222,  8237,  8285,  8302,  8309,
        8340,  8415,  8451,  8478,  8485,  8497,  8500,  8502,  8505,
        8519,  8532,  8544,  8548,  8559,  8566,  8572,  8594,  8598,
        8616,  8662,  8663,  8696,  8738,  8755,  8756,  8798,  8799,
        8822,  8830,  8860,  8867,  8880,  8894,  8897,  8900,  8906,
        8947,  8981,  8995,  9001,  9010,  9015,  9020,  9025,  9034,
        9041,  9081,  9085,  9086,  9126,  9127,  9141,  9159,  9175,
        9181,  9206,  9217,  9218,  9260,  9279,  9293,  9309,  9322,
        9331,  9332,  9341,  9348,  9355,  9371,  9402,  9427,  9430,
        9433,  9471,  9496,  9497,  9509,  9539,  9562,  9578,  9583,
        9585,  9610,  9633,  9654,  9656,  9718,  9720,  9730,  9736,
        9740,  9743,  9746,  9757,  9760,  9775,  9781,  9796,  9802,
        9803,  9819,  9835,  9877,  9878,  9890,  9927,  9932,  9939,
        9941,  9970,  9978,  9988, 10012, 10014, 10019, 10035, 10065,
       10105, 10126, 10127, 10128, 10140, 10142, 10154, 10159, 10173,
       10177, 10205, 10206, 10213, 10229, 10240, 10244, 10251, 10256,
       10261, 10331, 10337, 10345, 10358, 10363, 10399, 10406, 10408,
       10410, 10433, 10435, 10470, 10479, 10493, 10499, 10577, 10583,
       10589, 10602, 10606, 10617, 10634, 10640, 10673, 10701, 10722,
       10782, 10786, 10817, 10825, 10827, 10830, 10852, 10860, 10899,
       10932, 10938, 10973, 11004, 11019, 11021, 11035, 11088, 11107,
       11112, 11120, 11134, 11192, 11199, 11210, 11229, 11254, 11287,
       11291, 11297, 11299, 11317, 11319, 11350, 11420, 11441, 11449,
       11466, 11506, 11515, 11568, 11583, 11614, 11617, 11619, 11620,
       11622, 11633, 11683, 11686, 11692, 11724, 11730, 11757, 11772,
       11797, 11815, 11826, 11827, 11837, 11854, 11858, 11863, 11874,
       11902, 11915, 11921, 11925, 11936, 11956, 12008, 12025, 12079,
       12138, 12145, 12170, 12197, 12198, 12226, 12230, 12240, 12267,
       12277, 12284, 12312, 12320, 12336, 12358, 12416, 12426, 12431,
       12434, 12450, 12472, 12574, 12579, 12593, 12596, 12601, 12760,
       12796, 12864, 12875, 12879, 12897, 12898, 12905, 12945, 12968,
       12986, 13014, 13027, 13035, 13043, 13076, 13094, 13129, 13144,
       13162, 13185, 13190, 13237, 13242, 13292, 13305, 13316, 13323,
       13354, 13361, 13380, 13381, 13389, 13400, 13403, 13413, 13420,
       13432, 13486, 13492, 13545, 13576, 13597, 13664, 13668, 13673,
       13677, 13680, 13697, 13712, 13730, 13732, 13744, 13797, 13800,
       13824, 13826, 13827, 13841, 13875, 13886, 13902, 13939, 13940,
       13957, 13976, 13981, 13990, 14030, 14044, 14050, 14079, 14112,
       14115, 14122, 14124, 14137, 14160, 14164, 14172, 14174, 14196,
       14210, 14235, 14246, 14255, 14263, 14267, 14269, 14277, 14304,
       14306, 14337, 14340, 14346, 14364, 14372, 14378, 14448, 14458,
       14461, 14473, 14502, 14503, 14506, 14507, 14521, 14540, 14564,
       14569, 14622, 14631, 14634, 14655, 14683, 14703, 14722, 14730,
       14736, 14740, 14761, 14811, 14824, 14831, 14836, 14865, 14867,
       14900, 14903, 14904, 14956, 14972, 14983, 15007, 15012, 15053,
       15065, 15084, 15090, 15106, 15114, 15116, 15161, 15170, 15182,
       15185, 15196, 15197, 15199, 15210, 15228, 15279, 15324, 15325,
       15332, 15358, 15368, 15389, 15402, 15405, 15411, 15415, 15432,
       15451, 15519, 15524, 15528, 15530, 15592, 15666, 15667, 15692,
       15710, 15712, 15754, 15766, 15781, 15789, 15876, 15877, 15887,
       15921, 15928, 15950, 15975, 16034, 16057, 16073, 16082, 16092,
       16103, 16106, 16127, 16138, 16142, 16145, 16148, 16157, 16194,
       16202, 16222, 16233, 16244, 16299, 16334, 16336, 16340, 16374,
       16424, 16447, 16461, 16476, 16479, 16500, 16518]),)
(16522, 16522)
(15588, 16522)
(15588, 15588)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.3952057361602783s
The HC Re-cluster result: num cluster = 1102(model) // 1105(model_ema) 	 num outliers = 934(model) // 948(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9119083881378174s
The UCIS result: num clean cluster = 1099(model) 	 num outliers = 1066(model)
mdoel:new class are [1100], length of new dataset is 15456
Epoch: [0][0/300]	Time 9.997 (9.997)	Data 0.335 (0.335)	Loss_ce_clean 0.100 	Loss_ct_clean 0.151 	Prec 97.66%
==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=True, UCIS=True)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
load pretrain model:/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.785 (1.233)	Data 0.000 (0.004)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 55.76805353164673
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.910 (0.996)	Data 0.000 (0.003)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 303.6484339237213
The orignal cluster result: num cluster = 1100(model) // 1101(model_ema) 	 num outliers = 923(model) // 925(model_ema)
Applying hierarchical clustering
[ 479  259  764 ...  906 1017  632]
(16522,)
(array([    6,    41,    62,    65,    72,    79,    97,   104,   135,
         171,   183,   198,   205,   241,   243,   244,   247,   249,
         261,   269,   271,   277,   278,   302,   313,   317,   329,
         338,   342,   343,   356,   390,   391,   419,   434,   455,
         463,   511,   514,   539,   545,   588,   594,   596,   632,
         644,   680,   714,   731,   754,   769,   782,   785,   802,
         808,   832,   853,   856,   857,   861,   907,   911,   918,
         925,   938,   953,   996,  1001,  1014,  1030,  1041,  1045,
        1053,  1063,  1076,  1098,  1140,  1159,  1166,  1194,  1234,
        1295,  1307,  1341,  1345,  1359,  1365,  1384,  1386,  1389,
        1413,  1423,  1439,  1460,  1468,  1497,  1509,  1513,  1530,
        1531,  1556,  1567,  1570,  1600,  1605,  1644,  1654,  1697,
        1741,  1751,  1759,  1764,  1769,  1783,  1844,  1944,  1976,
        1983,  1994,  2011,  2054,  2099,  2101,  2112,  2117,  2119,
        2126,  2135,  2157,  2182,  2213,  2228,  2248,  2289,  2295,
        2300,  2315,  2322,  2396,  2403,  2414,  2447,  2476,  2494,
        2532,  2537,  2546,  2554,  2564,  2584,  2585,  2590,  2613,
        2655,  2689,  2690,  2710,  2727,  2732,  2769,  2799,  2801,
        2803,  2814,  2862,  2872,  2876,  2883,  2889,  2927,  2929,
        2934,  2945,  2952,  3015,  3027,  3030,  3031,  3090,  3199,
        3202,  3266,  3271,  3283,  3306,  3310,  3315,  3353,  3354,
        3355,  3373,  3376,  3384,  3390,  3395,  3412,  3427,  3448,
        3453,  3507,  3513,  3549,  3553,  3582,  3598,  3636,  3639,
        3641,  3655,  3670,  3682,  3695,  3716,  3764,  3784,  3814,
        3838,  3873,  3874,  3880,  3884,  3900,  3918,  3933,  3961,
        3963,  4004,  4040,  4054,  4061,  4072,  4094,  4097,  4105,
        4116,  4165,  4171,  4199,  4205,  4206,  4214,  4221,  4230,
        4251,  4259,  4264,  4281,  4296,  4325,  4327,  4334,  4372,
        4373,  4400,  4409,  4421,  4424,  4428,  4429,  4437,  4448,
        4526,  4532,  4569,  4584,  4590,  4610,  4614,  4632,  4663,
        4682,  4684,  4716,  4749,  4770,  4777,  4778,  4798,  4823,
        4876,  4880,  4884,  4888,  4899,  4902,  4940,  4946,  4981,
        4987,  4995,  5008,  5035,  5082,  5129,  5131,  5134,  5141,
        5180,  5184,  5232,  5297,  5302,  5317,  5343,  5361,  5394,
        5418,  5446,  5473,  5474,  5491,  5512,  5539,  5546,  5554,
        5558,  5559,  5603,  5608,  5611,  5629,  5655,  5677,  5695,
        5696,  5709,  5715,  5732,  5736,  5757,  5768,  5774,  5777,
        5802,  5813,  5829,  5831,  5852,  5867,  5877,  5879,  5883,
        5909,  5929,  5947,  5952,  5968,  6023,  6025,  6080,  6102,
        6129,  6132,  6144,  6147,  6160,  6174,  6195,  6208,  6243,
        6253,  6261,  6302,  6322,  6380,  6418,  6432,  6441,  6443,
        6451,  6458,  6466,  6467,  6473,  6477,  6488,  6520,  6531,
        6538,  6542,  6593,  6607,  6631,  6634,  6666,  6702,  6703,
        6757,  6760,  6765,  6860,  6867,  6875,  6885,  6887,  6911,
        6940,  6992,  7035,  7059,  7068,  7073,  7091,  7110,  7139,
        7166,  7172,  7186,  7187,  7214,  7233,  7282,  7289,  7336,
        7388,  7393,  7414,  7482,  7495,  7503,  7510,  7573,  7575,
        7593,  7597,  7612,  7625,  7632,  7655,  7689,  7725,  7740,
        7748,  7763,  7772,  7814,  7841,  7842,  7858,  7912,  7919,
        7934,  7976,  7981,  7982,  7985,  8050,  8061,  8081,  8089,
        8093,  8101,  8104,  8117,  8134,  8146,  8198,  8222,  8237,
        8285,  8302,  8309,  8312,  8340,  8381,  8415,  8451,  8478,
        8485,  8497,  8500,  8502,  8505,  8519,  8532,  8544,  8548,
        8566,  8572,  8594,  8598,  8616,  8662,  8663,  8696,  8755,
        8756,  8798,  8799,  8822,  8830,  8860,  8867,  8880,  8894,
        8897,  8900,  8906,  8947,  8981,  8995,  9001,  9010,  9015,
        9020,  9025,  9034,  9041,  9081,  9085,  9086,  9126,  9127,
        9141,  9159,  9175,  9181,  9206,  9217,  9218,  9260,  9279,
        9293,  9309,  9322,  9331,  9332,  9341,  9348,  9355,  9371,
        9402,  9427,  9430,  9433,  9471,  9497,  9539,  9562,  9578,
        9583,  9585,  9610,  9633,  9654,  9656,  9718,  9720,  9730,
        9736,  9740,  9743,  9746,  9757,  9775,  9781,  9796,  9803,
        9819,  9835,  9877,  9878,  9890,  9927,  9932,  9939,  9941,
        9970,  9978,  9988, 10012, 10014, 10019, 10035, 10065, 10105,
       10126, 10127, 10128, 10140, 10142, 10154, 10159, 10173, 10177,
       10205, 10206, 10213, 10229, 10240, 10244, 10251, 10256, 10261,
       10331, 10337, 10345, 10358, 10363, 10399, 10406, 10408, 10410,
       10435, 10470, 10479, 10493, 10499, 10577, 10583, 10589, 10602,
       10606, 10617, 10634, 10640, 10673, 10701, 10722, 10782, 10786,
       10817, 10825, 10827, 10830, 10852, 10860, 10899, 10932, 10938,
       10973, 11004, 11019, 11021, 11035, 11107, 11112, 11120, 11134,
       11192, 11199, 11210, 11229, 11254, 11287, 11291, 11297, 11299,
       11317, 11319, 11324, 11350, 11420, 11441, 11449, 11466, 11506,
       11515, 11568, 11583, 11614, 11619, 11620, 11633, 11683, 11686,
       11724, 11730, 11757, 11772, 11797, 11815, 11826, 11827, 11837,
       11854, 11858, 11863, 11874, 11902, 11915, 11925, 11936, 11956,
       12008, 12009, 12079, 12138, 12145, 12170, 12197, 12198, 12226,
       12230, 12240, 12267, 12277, 12284, 12312, 12320, 12336, 12358,
       12416, 12426, 12431, 12434, 12450, 12472, 12574, 12579, 12593,
       12596, 12601, 12658, 12760, 12796, 12864, 12875, 12879, 12897,
       12898, 12905, 12945, 12968, 12986, 13014, 13027, 13035, 13076,
       13094, 13129, 13144, 13162, 13185, 13190, 13237, 13242, 13292,
       13305, 13316, 13323, 13354, 13361, 13380, 13381, 13389, 13400,
       13403, 13413, 13420, 13432, 13486, 13492, 13545, 13576, 13597,
       13664, 13668, 13673, 13677, 13680, 13697, 13712, 13732, 13744,
       13797, 13800, 13824, 13826, 13827, 13841, 13875, 13886, 13902,
       13939, 13940, 13957, 13976, 13981, 13990, 14030, 14044, 14050,
       14079, 14112, 14115, 14122, 14124, 14137, 14160, 14164, 14172,
       14174, 14196, 14210, 14235, 14246, 14255, 14263, 14267, 14269,
       14277, 14304, 14306, 14337, 14346, 14364, 14372, 14378, 14448,
       14458, 14461, 14473, 14502, 14503, 14506, 14507, 14521, 14540,
       14564, 14569, 14622, 14634, 14655, 14683, 14703, 14722, 14730,
       14736, 14740, 14761, 14811, 14824, 14831, 14836, 14865, 14867,
       14900, 14903, 14904, 14956, 14972, 14983, 15007, 15012, 15053,
       15084, 15090, 15106, 15110, 15114, 15116, 15161, 15170, 15182,
       15185, 15196, 15197, 15199, 15210, 15228, 15279, 15324, 15325,
       15332, 15358, 15368, 15389, 15402, 15405, 15411, 15415, 15432,
       15451, 15519, 15524, 15528, 15530, 15592, 15666, 15667, 15692,
       15710, 15712, 15754, 15766, 15781, 15789, 15876, 15877, 15887,
       15921, 15928, 15950, 15975, 16034, 16057, 16073, 16082, 16092,
       16103, 16106, 16127, 16138, 16142, 16145, 16148, 16157, 16194,
       16202, 16222, 16244, 16299, 16334, 16336, 16374, 16424, 16447,
       16461, 16476, 16479, 16500, 16518]),)
(16522, 16522)
(15599, 16522)
(15599, 15599)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.3564436435699463s
The HC Re-cluster result: num cluster = 1100(model) // 1101(model_ema) 	 num outliers = 923(model) // 925(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.6383495330810547s
The UCIS result: num clean cluster = 1099(model) 	 num outliers = 996(model)
mdoel:new class are [1100], length of new dataset is 15526
Epoch: [0][0/300]	Time 3.496 (3.496)	Data 0.119 (0.119)	Loss_ce_clean 0.101 	Loss_ct_clean 0.154 	Prec 97.66%
==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=True, UCIS=True)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
load pretrain model:/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.746 (0.756)	Data 0.000 (0.004)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 302.0695695877075
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.836 (0.906)	Data 0.000 (0.004)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 55.418803691864014
The orignal cluster result: num cluster = 1103(model) // 1102(model_ema) 	 num outliers = 929(model) // 925(model_ema)
Applying hierarchical clustering
[ 484  261  773 ...  909 1018  651]
(16522,)
(array([    6,    41,    62,    65,    72,    79,   100,   104,   135,
         171,   183,   190,   198,   205,   207,   241,   243,   244,
         247,   249,   261,   269,   271,   277,   278,   302,   313,
         317,   329,   338,   342,   343,   356,   390,   391,   419,
         434,   455,   463,   511,   514,   539,   545,   588,   594,
         596,   632,   644,   680,   714,   731,   754,   756,   769,
         782,   785,   802,   808,   832,   853,   856,   857,   861,
         907,   911,   918,   925,   938,   996,  1001,  1014,  1030,
        1041,  1045,  1053,  1063,  1076,  1098,  1140,  1159,  1166,
        1194,  1234,  1295,  1307,  1341,  1345,  1359,  1365,  1384,
        1386,  1389,  1413,  1423,  1439,  1460,  1468,  1497,  1509,
        1530,  1531,  1556,  1567,  1570,  1600,  1605,  1644,  1654,
        1697,  1741,  1751,  1759,  1764,  1769,  1783,  1844,  1944,
        1976,  1983,  1994,  2011,  2054,  2099,  2101,  2112,  2117,
        2119,  2126,  2135,  2157,  2182,  2213,  2228,  2248,  2289,
        2295,  2300,  2315,  2322,  2396,  2403,  2414,  2447,  2476,
        2494,  2532,  2537,  2546,  2554,  2564,  2584,  2585,  2590,
        2613,  2655,  2689,  2690,  2710,  2727,  2732,  2769,  2799,
        2801,  2803,  2814,  2862,  2872,  2876,  2883,  2889,  2927,
        2929,  2934,  2945,  2952,  3015,  3027,  3030,  3031,  3090,
        3199,  3202,  3266,  3271,  3283,  3306,  3310,  3315,  3353,
        3354,  3355,  3373,  3376,  3384,  3390,  3395,  3412,  3427,
        3448,  3453,  3507,  3513,  3549,  3553,  3582,  3598,  3636,
        3639,  3655,  3670,  3682,  3695,  3764,  3784,  3814,  3838,
        3873,  3874,  3880,  3884,  3900,  3918,  3933,  3961,  3963,
        4004,  4040,  4054,  4061,  4072,  4094,  4097,  4105,  4116,
        4165,  4171,  4199,  4205,  4206,  4214,  4221,  4230,  4251,
        4259,  4264,  4281,  4296,  4325,  4327,  4334,  4372,  4373,
        4400,  4409,  4421,  4424,  4428,  4429,  4437,  4448,  4526,
        4532,  4569,  4584,  4590,  4610,  4614,  4632,  4663,  4682,
        4684,  4716,  4749,  4770,  4777,  4778,  4798,  4806,  4823,
        4841,  4876,  4880,  4884,  4899,  4902,  4940,  4946,  4981,
        4987,  4995,  5035,  5082,  5129,  5131,  5134,  5141,  5180,
        5184,  5232,  5267,  5297,  5302,  5317,  5343,  5361,  5394,
        5418,  5446,  5473,  5474,  5491,  5512,  5534,  5539,  5546,
        5554,  5558,  5559,  5603,  5608,  5611,  5629,  5655,  5669,
        5677,  5695,  5696,  5709,  5732,  5736,  5757,  5768,  5774,
        5777,  5802,  5813,  5829,  5831,  5848,  5852,  5867,  5877,
        5879,  5883,  5909,  5929,  5946,  5947,  5952,  5968,  6023,
        6025,  6080,  6102,  6129,  6132,  6144,  6147,  6160,  6174,
        6195,  6208,  6243,  6253,  6261,  6302,  6322,  6380,  6418,
        6432,  6441,  6443,  6451,  6458,  6466,  6467,  6473,  6477,
        6488,  6520,  6531,  6538,  6542,  6593,  6607,  6631,  6634,
        6666,  6702,  6703,  6757,  6760,  6765,  6860,  6867,  6875,
        6887,  6911,  6940,  6992,  7035,  7059,  7073,  7091,  7110,
        7139,  7166,  7172,  7186,  7187,  7214,  7282,  7289,  7336,
        7388,  7393,  7414,  7482,  7495,  7503,  7510,  7573,  7575,
        7593,  7597,  7612,  7625,  7632,  7655,  7689,  7725,  7748,
        7772,  7814,  7841,  7842,  7858,  7912,  7919,  7934,  7976,
        7981,  7982,  7985,  8050,  8061,  8081,  8089,  8093,  8101,
        8104,  8117,  8134,  8146,  8198,  8222,  8237,  8285,  8302,
        8309,  8312,  8340,  8415,  8451,  8466,  8478,  8485,  8497,
        8500,  8502,  8505,  8519,  8532,  8544,  8548,  8566,  8572,
        8594,  8616,  8662,  8663,  8696,  8755,  8756,  8798,  8799,
        8822,  8830,  8860,  8867,  8880,  8894,  8897,  8900,  8906,
        8947,  8981,  8995,  9001,  9010,  9015,  9020,  9025,  9034,
        9041,  9081,  9085,  9086,  9126,  9127,  9141,  9159,  9175,
        9181,  9206,  9217,  9218,  9260,  9279,  9293,  9309,  9322,
        9331,  9332,  9341,  9348,  9355,  9371,  9402,  9427,  9430,
        9433,  9449,  9471,  9496,  9497,  9539,  9562,  9578,  9583,
        9585,  9610,  9633,  9654,  9656,  9718,  9720,  9730,  9736,
        9740,  9743,  9746,  9757,  9775,  9781,  9796,  9803,  9819,
        9835,  9877,  9878,  9890,  9927,  9932,  9939,  9941,  9970,
        9978,  9988, 10012, 10014, 10019, 10035, 10065, 10105, 10126,
       10127, 10128, 10140, 10142, 10154, 10159, 10173, 10177, 10205,
       10206, 10213, 10229, 10240, 10244, 10251, 10256, 10261, 10331,
       10337, 10345, 10358, 10363, 10399, 10406, 10408, 10410, 10433,
       10435, 10445, 10470, 10479, 10493, 10499, 10577, 10583, 10589,
       10602, 10606, 10617, 10634, 10640, 10673, 10701, 10722, 10782,
       10786, 10817, 10825, 10827, 10830, 10852, 10860, 10899, 10932,
       10938, 10942, 10973, 11004, 11019, 11021, 11035, 11107, 11112,
       11120, 11134, 11149, 11192, 11199, 11210, 11229, 11254, 11256,
       11287, 11291, 11297, 11299, 11317, 11319, 11324, 11350, 11420,
       11441, 11449, 11466, 11506, 11515, 11568, 11583, 11614, 11619,
       11620, 11622, 11633, 11683, 11686, 11724, 11730, 11757, 11772,
       11797, 11815, 11826, 11827, 11837, 11854, 11858, 11874, 11902,
       11915, 11925, 11936, 11956, 12008, 12009, 12079, 12138, 12145,
       12170, 12197, 12198, 12226, 12230, 12240, 12267, 12277, 12284,
       12312, 12320, 12336, 12358, 12416, 12426, 12431, 12434, 12450,
       12465, 12472, 12574, 12579, 12593, 12596, 12601, 12760, 12796,
       12864, 12875, 12879, 12897, 12898, 12905, 12968, 12986, 13014,
       13027, 13035, 13076, 13094, 13129, 13144, 13162, 13185, 13190,
       13237, 13242, 13292, 13305, 13316, 13323, 13354, 13361, 13380,
       13381, 13389, 13400, 13403, 13413, 13420, 13432, 13486, 13492,
       13545, 13576, 13597, 13664, 13668, 13673, 13677, 13680, 13697,
       13712, 13730, 13732, 13744, 13797, 13800, 13826, 13827, 13841,
       13875, 13886, 13902, 13939, 13940, 13957, 13976, 13981, 13990,
       14030, 14044, 14050, 14079, 14112, 14115, 14122, 14124, 14137,
       14160, 14164, 14172, 14174, 14196, 14210, 14235, 14246, 14255,
       14263, 14267, 14269, 14277, 14304, 14306, 14337, 14346, 14364,
       14372, 14378, 14448, 14458, 14461, 14473, 14502, 14506, 14507,
       14521, 14540, 14564, 14569, 14588, 14622, 14634, 14655, 14683,
       14703, 14722, 14730, 14736, 14740, 14761, 14811, 14824, 14831,
       14836, 14865, 14867, 14896, 14900, 14903, 14904, 14956, 14960,
       14972, 14983, 15007, 15012, 15053, 15084, 15090, 15106, 15114,
       15116, 15161, 15170, 15182, 15185, 15196, 15197, 15199, 15210,
       15228, 15279, 15324, 15325, 15332, 15358, 15368, 15389, 15402,
       15405, 15411, 15415, 15432, 15451, 15519, 15524, 15528, 15530,
       15592, 15666, 15667, 15692, 15710, 15712, 15754, 15766, 15781,
       15789, 15876, 15877, 15887, 15921, 15928, 15950, 15975, 16034,
       16057, 16073, 16075, 16082, 16092, 16103, 16106, 16127, 16138,
       16142, 16145, 16148, 16157, 16194, 16202, 16222, 16244, 16299,
       16334, 16336, 16374, 16424, 16447, 16461, 16467, 16476, 16479,
       16500, 16518]),)
(16522, 16522)
(15593, 16522)
(15593, 15593)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
tensor([[ 1.6033e-06, -3.0472e-02, -4.1065e-03,  ...,  9.3472e-03,
          1.8475e-04,  1.8386e-02],
        [ 7.8192e-07,  5.5590e-02, -3.7578e-03,  ...,  1.9864e-02,
         -2.2394e-02, -2.0647e-02],
        [ 5.0868e-07,  4.3805e-02, -2.8179e-03,  ..., -2.6583e-03,
         -4.3144e-03, -5.3995e-04],
        ...,
        [-4.4402e-07,  3.8481e-03,  1.1368e-02,  ..., -6.2740e-03,
         -2.1094e-02, -5.1687e-03],
        [ 2.9594e-06, -4.0165e-03,  6.2936e-03,  ..., -4.3700e-02,
          2.0614e-02, -6.0281e-03],
        [ 2.4555e-07,  4.0331e-02, -1.1334e-02,  ...,  8.7803e-03,
         -6.5783e-03, -1.9103e-02]]) [ 484  261  773 ...  909 1018  651] [] 1102 Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=True, UCIS=True) [0.7862597  0.5841945  0.8369061  ... 0.74431354 0.76716006 0.6902298 ]
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.3412091732025146s
The HC Re-cluster result: num cluster = 1103(model) // 1102(model_ema) 	 num outliers = 929(model) // 925(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.6855621337890625s
The UCIS result: num clean cluster = 1100(model) 	 num outliers = 1018(model)
mdoel:new class are [1101], length of new dataset is 15504
Epoch: [0][0/300]	Time 3.709 (3.709)	Data 0.176 (0.176)	Loss_ce_clean 0.101 	Loss_ct_clean 0.140 	Prec 97.66%
Epoch: [0][50/300]	Time 2.221 (2.325)	Data 0.145 (0.133)	Loss_ce_clean 0.138 	Loss_ct_clean 0.231 	Prec 97.37%
Epoch: [0][100/300]	Time 2.185 (2.292)	Data 0.116 (0.127)	Loss_ce_clean 0.132 	Loss_ct_clean 0.317 	Prec 97.43%
Epoch: [0][150/300]	Time 2.226 (2.266)	Data 0.110 (0.121)	Loss_ce_clean 0.124 	Loss_ct_clean 0.336 	Prec 97.63%
Epoch: [0][200/300]	Time 2.140 (2.253)	Data 0.116 (0.118)	Loss_ce_clean 0.120 	Loss_ct_clean 0.345 	Prec 97.78%
Epoch: [0][250/300]	Time 2.222 (2.246)	Data 0.102 (0.116)	Loss_ce_clean 0.117 	Loss_ct_clean 0.348 	Prec 97.86%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.803 (0.812)	Data 0.000 (0.006)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 55.82640719413757
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.794 (0.806)	Data 0.000 (0.006)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 55.48958230018616
The orignal cluster result: num cluster = 1162(model) // 1136(model_ema) 	 num outliers = 757(model) // 802(model_ema)
Applying hierarchical clustering
[1093  173 1074 ...  952 1094  716]
(16522,)
(array([    6,    39,    62,    65,    68,    72,    83,    97,   104,
         114,   171,   205,   207,   218,   241,   243,   258,   261,
         269,   271,   277,   295,   317,   343,   356,   390,   419,
         434,   463,   485,   511,   522,   545,   548,   580,   588,
         596,   617,   632,   644,   677,   680,   689,   714,   728,
         730,   785,   802,   853,   856,   857,   861,   911,   918,
         951,   953,   968,   996,  1001,  1014,  1041,  1045,  1063,
        1076,  1086,  1098,  1138,  1140,  1141,  1166,  1234,  1244,
        1295,  1307,  1312,  1328,  1345,  1365,  1389,  1413,  1423,
        1428,  1439,  1460,  1497,  1500,  1520,  1530,  1545,  1605,
        1670,  1741,  1757,  1764,  1769,  1783,  1819,  1825,  1894,
        1938,  1960,  1976,  1983,  2017,  2101,  2112,  2117,  2119,
        2126,  2127,  2152,  2157,  2170,  2182,  2228,  2248,  2289,
        2300,  2315,  2396,  2403,  2467,  2474,  2494,  2532,  2546,
        2585,  2590,  2613,  2655,  2678,  2689,  2690,  2710,  2727,
        2741,  2801,  2803,  2814,  2818,  2862,  2871,  2872,  2876,
        2883,  2889,  2927,  2934,  2945,  3030,  3031,  3034,  3143,
        3157,  3202,  3266,  3271,  3281,  3306,  3315,  3353,  3355,
        3373,  3412,  3427,  3448,  3453,  3470,  3492,  3507,  3513,
        3553,  3571,  3655,  3695,  3716,  3764,  3814,  3817,  3819,
        3838,  3874,  3884,  3900,  3933,  3947,  3958,  3961,  4057,
        4061,  4066,  4105,  4116,  4171,  4205,  4221,  4235,  4238,
        4249,  4251,  4277,  4296,  4305,  4325,  4327,  4334,  4346,
        4372,  4373,  4409,  4424,  4428,  4429,  4448,  4487,  4532,
        4582,  4584,  4590,  4610,  4614,  4632,  4663,  4679,  4682,
        4684,  4716,  4753,  4778,  4798,  4876,  4899,  4902,  4914,
        4940,  4946,  4951,  4995,  5012,  5027,  5035,  5082,  5095,
        5129,  5180,  5232,  5267,  5302,  5347,  5361,  5394,  5413,
        5440,  5446,  5474,  5496,  5534,  5546,  5554,  5559,  5573,
        5580,  5603,  5637,  5702,  5704,  5715,  5739,  5768,  5773,
        5774,  5813,  5849,  5858,  5859,  5872,  5877,  5929,  5947,
        5968,  6023,  6040,  6071,  6078,  6102,  6126,  6132,  6144,
        6147,  6160,  6174,  6208,  6210,  6243,  6253,  6261,  6270,
        6276,  6301,  6315,  6322,  6349,  6385,  6432,  6443,  6447,
        6448,  6451,  6456,  6466,  6520,  6531,  6538,  6542,  6562,
        6593,  6631,  6634,  6666,  6693,  6702,  6703,  6760,  6761,
        6775,  6860,  6867,  6887,  6992,  7021,  7035,  7059,  7091,
        7095,  7111,  7139,  7152,  7166,  7186,  7187,  7214,  7383,
        7440,  7447,  7455,  7495,  7502,  7503,  7575,  7595,  7612,
        7625,  7642,  7679,  7689,  7696,  7737,  7772,  7858,  7885,
        7919,  7928,  7934,  7976,  7981,  7982,  7987,  7990,  7998,
        8050,  8081,  8101,  8117,  8198,  8285,  8302,  8312,  8318,
        8340,  8381,  8412,  8415,  8419,  8430,  8439,  8485,  8497,
        8548,  8566,  8598,  8605,  8616,  8638,  8679,  8696,  8746,
        8756,  8775,  8798,  8799,  8822,  8830,  8860,  8880,  8897,
        8906,  8910,  8938,  8947,  8966,  8981,  9001,  9023,  9025,
        9034,  9041,  9059,  9081,  9085,  9122,  9158,  9159,  9181,
        9218,  9279,  9293,  9309,  9322,  9332,  9341,  9348,  9360,
        9371,  9394,  9402,  9427,  9433,  9471,  9497,  9516,  9539,
        9578,  9583,  9585,  9601,  9610,  9619,  9654,  9679,  9718,
        9743,  9746,  9757,  9760,  9775,  9781,  9794,  9803,  9810,
        9873,  9888,  9892,  9914,  9927,  9939,  9941,  9970,  9978,
        9988,  9999, 10014, 10037, 10074, 10105, 10124, 10140, 10159,
       10172, 10173, 10177, 10182, 10205, 10213, 10244, 10261, 10266,
       10291, 10344, 10358, 10383, 10399, 10406, 10408, 10410, 10435,
       10452, 10457, 10473, 10479, 10493, 10499, 10589, 10603, 10604,
       10606, 10617, 10640, 10644, 10673, 10782, 10825, 10827, 10899,
       10918, 10932, 10933, 10938, 10961, 10973, 10999, 11004, 11021,
       11035, 11112, 11154, 11192, 11199, 11229, 11236, 11256, 11287,
       11291, 11297, 11317, 11319, 11324, 11420, 11427, 11465, 11503,
       11538, 11568, 11583, 11602, 11617, 11619, 11620, 11630, 11686,
       11730, 11772, 11797, 11826, 11837, 11845, 11854, 11856, 11863,
       11871, 11874, 11905, 11915, 11956, 11970, 12009, 12079, 12138,
       12170, 12180, 12197, 12260, 12277, 12283, 12286, 12312, 12320,
       12357, 12359, 12369, 12386, 12410, 12416, 12426, 12434, 12453,
       12515, 12518, 12520, 12527, 12579, 12601, 12612, 12658, 12713,
       12760, 12823, 12831, 12864, 12876, 12897, 12898, 12900, 12916,
       12945, 12972, 12986, 13014, 13027, 13035, 13099, 13129, 13144,
       13193, 13218, 13237, 13238, 13242, 13295, 13349, 13361, 13380,
       13381, 13389, 13400, 13403, 13413, 13431, 13519, 13542, 13545,
       13630, 13677, 13678, 13680, 13697, 13703, 13824, 13826, 13827,
       13875, 13886, 13902, 13924, 13940, 13976, 13990, 14008, 14030,
       14044, 14050, 14052, 14079, 14112, 14122, 14160, 14164, 14169,
       14174, 14210, 14235, 14239, 14269, 14304, 14316, 14327, 14346,
       14372, 14461, 14503, 14506, 14507, 14519, 14564, 14611, 14622,
       14655, 14666, 14691, 14736, 14740, 14743, 14761, 14831, 14865,
       14900, 14904, 14917, 14921, 14956, 15007, 15053, 15065, 15084,
       15090, 15114, 15116, 15122, 15170, 15182, 15185, 15196, 15197,
       15228, 15229, 15271, 15290, 15293, 15303, 15324, 15325, 15332,
       15402, 15405, 15432, 15451, 15469, 15497, 15516, 15519, 15524,
       15591, 15592, 15599, 15667, 15692, 15712, 15729, 15747, 15766,
       15781, 15877, 15894, 15920, 15975, 16056, 16103, 16106, 16116,
       16127, 16138, 16142, 16148, 16157, 16202, 16231, 16272, 16279,
       16336, 16374, 16383, 16424, 16442, 16461, 16479, 16500, 16507,
       16518]),)
(16522, 16522)
(15765, 16522)
(15765, 15765)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
tensor([[-2.1814e-14, -3.4535e-02, -3.3860e-03,  ...,  1.3405e-02,
          4.9083e-03,  2.2349e-02],
        [-2.0656e-14,  6.0453e-02, -2.9656e-03,  ...,  2.5816e-02,
         -2.0424e-02, -2.2350e-02],
        [-2.1442e-14,  4.4530e-02, -2.1970e-03,  ..., -3.7505e-03,
         -6.0976e-03,  6.9802e-03],
        ...,
        [-1.9972e-14, -6.7079e-03,  1.1263e-02,  ..., -9.5816e-03,
         -1.6590e-02,  4.1024e-03],
        [-1.8935e-14, -7.4769e-03,  5.1527e-03,  ..., -4.2081e-02,
          1.9116e-02, -1.6730e-04],
        [-2.2330e-14,  3.7793e-02, -8.1270e-03,  ...,  9.1642e-03,
         -7.3551e-03, -1.5423e-02]]) [1093  173 1074 ...  952 1094  716] [] 1161 Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=True, UCIS=True) [0.7396989  0.6437402  0.8184565  ... 0.77696985 0.8005621  0.69664204]
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.0346291065216064s
The HC Re-cluster result: num cluster = 1162(model) // 1136(model_ema) 	 num outliers = 757(model) // 802(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8068761825561523s
The UCIS result: num clean cluster = 1122(model) 	 num outliers = 1614(model)
mdoel:new class are [1123], length of new dataset is 14908
Epoch: [1][0/300]	Time 2.039 (2.039)	Data 0.112 (0.112)	Loss_ce_clean 0.073 	Loss_ct_clean 0.129 	Prec 98.44%
Epoch: [1][50/300]	Time 2.111 (2.102)	Data 0.103 (0.106)	Loss_ce_clean 0.096 	Loss_ct_clean 0.185 	Prec 98.19%
Epoch: [1][100/300]	Time 2.116 (2.101)	Data 0.105 (0.106)	Loss_ce_clean 0.087 	Loss_ct_clean 0.269 	Prec 98.46%
Epoch: [1][150/300]	Time 2.113 (2.105)	Data 0.102 (0.106)	Loss_ce_clean 0.086 	Loss_ct_clean 0.298 	Prec 98.50%
Epoch: [1][200/300]	Time 2.072 (2.104)	Data 0.103 (0.106)	Loss_ce_clean 0.084 	Loss_ct_clean 0.305 	Prec 98.60%
Epoch: [1][250/300]	Time 2.083 (2.105)	Data 0.105 (0.106)	Loss_ce_clean 0.083 	Loss_ct_clean 0.311 	Prec 98.66%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.781 (0.860)	Data 0.000 (0.007)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 56.28071451187134
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.782 (0.860)	Data 0.000 (0.007)	
Computing jaccard distance...
torch.Size([16522, 16522])
30
Jaccard distance computing time cost: 55.54253554344177
The orignal cluster result: num cluster = 1208(model) // 1166(model_ema) 	 num outliers = 741(model) // 755(model_ema)
Applying hierarchical clustering
[ 869   64  744 ... 1180 1090  829]
(16522,)
(array([    6,     9,    72,    74,    83,    97,   104,   114,   118,
         198,   207,   222,   241,   243,   249,   258,   261,   264,
         269,   271,   277,   329,   343,   356,   390,   419,   463,
         502,   511,   574,   588,   596,   617,   632,   638,   644,
         677,   680,   714,   735,   769,   785,   832,   853,   857,
         861,   905,   911,   953,   956,   996,  1001,  1014,  1028,
        1042,  1045,  1063,  1076,  1086,  1098,  1159,  1166,  1234,
        1242,  1295,  1312,  1328,  1345,  1365,  1384,  1389,  1413,
        1423,  1468,  1497,  1500,  1509,  1530,  1557,  1716,  1741,
        1759,  1764,  1769,  1783,  1825,  1833,  1914,  1916,  1938,
        1960,  1982,  2013,  2017,  2063,  2087,  2101,  2112,  2117,
        2120,  2126,  2127,  2157,  2170,  2182,  2228,  2248,  2285,
        2289,  2315,  2361,  2393,  2403,  2447,  2474,  2492,  2526,
        2532,  2567,  2585,  2586,  2590,  2613,  2678,  2686,  2689,
        2690,  2710,  2727,  2741,  2803,  2814,  2818,  2837,  2871,
        2872,  2876,  2878,  2883,  2889,  2934,  2945,  2972,  3019,
        3027,  3030,  3038,  3107,  3114,  3143,  3157,  3202,  3266,
        3306,  3312,  3315,  3353,  3354,  3355,  3395,  3427,  3431,
        3448,  3453,  3502,  3507,  3513,  3530,  3549,  3553,  3571,
        3582,  3599,  3636,  3655,  3682,  3764,  3838,  3874,  3878,
        3884,  3890,  3900,  3918,  3926,  3933,  3958,  3961,  3963,
        3972,  4054,  4057,  4061,  4066,  4105,  4158,  4171,  4205,
        4221,  4230,  4238,  4249,  4251,  4259,  4296,  4334,  4346,
        4361,  4372,  4373,  4409,  4421,  4424,  4428,  4429,  4446,
        4448,  4487,  4582,  4584,  4590,  4610,  4614,  4632,  4663,
        4679,  4682,  4684,  4716,  4753,  4766,  4806,  4819,  4876,
        4899,  4902,  4914,  4946,  4951,  4995,  5015,  5018,  5035,
        5058,  5082,  5095,  5119,  5155,  5180,  5232,  5267,  5271,
        5297,  5302,  5317,  5361,  5413,  5418,  5440,  5491,  5534,
        5546,  5554,  5558,  5559,  5603,  5611,  5637,  5677,  5715,
        5739,  5757,  5773,  5796,  5807,  5848,  5849,  5858,  5861,
        5872,  5877,  5934,  5968,  6023,  6071,  6082,  6102,  6109,
        6126,  6128,  6132,  6144,  6147,  6148,  6160,  6195,  6196,
        6210,  6243,  6253,  6256,  6261,  6301,  6322,  6377,  6405,
        6443,  6448,  6456,  6466,  6467,  6473,  6531,  6542,  6562,
        6593,  6636,  6702,  6703,  6760,  6761,  6763,  6859,  6867,
        6884,  6885,  7021,  7035,  7059,  7091,  7105,  7110,  7111,
        7120,  7130,  7166,  7187,  7214,  7245,  7328,  7335,  7363,
        7383,  7455,  7495,  7499,  7510,  7575,  7595,  7612,  7615,
        7625,  7632,  7642,  7679,  7689,  7696,  7725,  7737,  7763,
        7858,  7885,  7912,  7919,  7928,  7934,  7967,  7981,  7988,
        7990,  8061,  8093,  8101,  8137,  8222,  8249,  8285,  8314,
        8340,  8346,  8376,  8381,  8395,  8427,  8467,  8478,  8497,
        8505,  8532,  8544,  8566,  8594,  8598,  8605,  8616,  8679,
        8688,  8696,  8738,  8746,  8799,  8822,  8830,  8860,  8880,
        8897,  8900,  8906,  8910,  8918,  8938,  8939,  8981,  9001,
        9023,  9025,  9034,  9041,  9054,  9081,  9084,  9085,  9091,
        9122,  9141,  9159,  9175,  9181,  9226,  9237,  9279,  9282,
        9309,  9322,  9337,  9348,  9371,  9402,  9449,  9471,  9475,
        9496,  9497,  9516,  9521,  9539,  9562,  9578,  9583,  9585,
        9619,  9654,  9679,  9718,  9720,  9729,  9754,  9757,  9760,
        9775,  9781,  9794,  9802,  9803,  9810,  9863,  9892,  9927,
        9970,  9978,  9988,  9999, 10012, 10014, 10052, 10072, 10105,
       10111, 10140, 10172, 10173, 10177, 10213, 10251, 10291, 10406,
       10408, 10410, 10435, 10452, 10457, 10479, 10499, 10583, 10589,
       10604, 10606, 10617, 10694, 10708, 10801, 10825, 10827, 10881,
       10886, 10899, 10932, 10938, 11004, 11021, 11025, 11058, 11095,
       11112, 11154, 11192, 11199, 11229, 11243, 11291, 11317, 11319,
       11324, 11336, 11358, 11407, 11420, 11449, 11465, 11519, 11560,
       11568, 11602, 11617, 11619, 11620, 11674, 11683, 11686, 11724,
       11757, 11772, 11826, 11854, 11856, 11863, 11871, 11874, 11905,
       11915, 12008, 12025, 12079, 12117, 12138, 12170, 12180, 12197,
       12198, 12279, 12286, 12312, 12369, 12386, 12387, 12416, 12431,
       12434, 12453, 12512, 12520, 12601, 12612, 12658, 12713, 12715,
       12760, 12831, 12864, 12897, 12898, 12903, 12905, 12945, 13035,
       13037, 13063, 13113, 13119, 13129, 13193, 13238, 13242, 13292,
       13323, 13361, 13380, 13389, 13400, 13403, 13413, 13432, 13500,
       13519, 13545, 13597, 13620, 13630, 13668, 13669, 13677, 13678,
       13680, 13697, 13703, 13730, 13732, 13750, 13824, 13827, 13875,
       13892, 13902, 13918, 13940, 13976, 13981, 13990, 14042, 14044,
       14050, 14052, 14079, 14104, 14112, 14118, 14122, 14148, 14164,
       14169, 14172, 14174, 14196, 14210, 14235, 14269, 14304, 14306,
       14327, 14340, 14346, 14359, 14372, 14461, 14503, 14506, 14507,
       14512, 14539, 14564, 14591, 14598, 14622, 14631, 14634, 14655,
       14699, 14736, 14740, 14743, 14761, 14828, 14831, 14849, 14865,
       14896, 14900, 14904, 14909, 14917, 15007, 15053, 15084, 15116,
       15122, 15170, 15182, 15185, 15197, 15229, 15271, 15278, 15303,
       15324, 15325, 15352, 15411, 15432, 15451, 15488, 15516, 15519,
       15524, 15528, 15592, 15599, 15608, 15610, 15667, 15692, 15694,
       15712, 15729, 15747, 15766, 15781, 15877, 15920, 15928, 16029,
       16056, 16073, 16082, 16086, 16103, 16138, 16148, 16157, 16202,
       16225, 16231, 16272, 16336, 16340, 16374, 16447, 16450, 16461,
       16475, 16500, 16507]),)
(16522, 16522)
(15781, 16522)
(15781, 15781)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
tensor([[-2.5849e-24, -3.1919e-02,  4.2526e-04,  ...,  1.1700e-02,
          1.0135e-02,  3.0201e-02],
        [-2.6467e-24,  6.2235e-02, -3.8019e-03,  ...,  2.3273e-02,
         -2.2066e-02, -3.0260e-02],
        [-2.6481e-24,  4.3082e-02, -1.5513e-03,  ..., -3.9279e-03,
         -3.4045e-03,  2.7196e-03],
        ...,
        [-2.5157e-24, -5.0900e-03,  1.2673e-02,  ..., -1.1079e-02,
         -1.5232e-02, -4.2531e-03],
        [-2.2361e-24, -8.0975e-03,  2.1007e-03,  ..., -3.6074e-02,
          1.9155e-02, -6.1314e-04],
        [-2.8002e-24,  3.3866e-02, -6.7140e-03,  ...,  1.2025e-03,
         -7.9481e-03, -1.9891e-02]]) [ 869   64  744 ... 1180 1090  829] [] 1207 Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=True, UCIS=True) [0.6843949  0.6617497  0.8420034  ... 0.7552925  0.74021083 0.6942423 ]
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.117917060852051s
The HC Re-cluster result: num cluster = 1208(model) // 1166(model_ema) 	 num outliers = 741(model) // 755(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8255605697631836s
The UCIS result: num clean cluster = 1161(model) 	 num outliers = 1635(model)
mdoel:new class are [1162], length of new dataset is 14887
Epoch: [2][0/300]	Time 2.012 (2.012)	Data 0.111 (0.111)	Loss_ce_clean 0.067 	Loss_ct_clean 0.105 	Prec 99.22%
Epoch: [2][50/300]	Time 2.313 (2.240)	Data 0.103 (0.105)	Loss_ce_clean 0.080 	Loss_ct_clean 0.169 	Prec 98.51%
Epoch: [2][100/300]	Time 2.209 (2.246)	Data 0.102 (0.106)	Loss_ce_clean 0.082 	Loss_ct_clean 0.256 	Prec 98.34%
Epoch: [2][150/300]	Time 2.149 (2.248)	Data 0.104 (0.105)	Loss_ce_clean 0.081 	Loss_ct_clean 0.296 	Prec 98.37%
==========
Args:Namespace(dataset_source='duke', dataset_target='market1501', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=50, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2duke/', log_name='', HC=True, UCIS=True)
==========
=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
load pretrain model:/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Test on the best model.
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/dbscan/market2duke/model_best.pth.tar'
