==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=20, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/pretrained/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='logs/dbscan/market2duke', log_name='', HC=True, UCIS=True)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
/hgst/longdn/UCF-main/data/market1501/Market-1501-v15.09.15/bounding_box_test




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/pretrained/market2duke/model_best.pth.tar'
missing keys in state_dict: {'classifier0_32621.weight'}
missing keys in state_dict: {'classifier0_32621.weight'}
load pretrain model:/hgst/longdn/UCF-main/logs/pretrained/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.170)	Data 0.000 (0.003)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.77267861366272
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.154 (0.158)	Data 0.000 (0.003)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.80538535118103
The orignal cluster result: num cluster = 1038(model) // 1038(model_ema) 	 num outliers = 4076(model) // 4076(model_ema)
Applying hierarchical clustering
[859 615 734 ...  -1 573 922]
(16522,)
(array([    3,     4,     6, ..., 16509, 16515, 16519]),)
(16522, 16522)
(12446, 16522)
(12446, 12446)
reCluster!use silhouette score and tao=0.0
each uncer num= [21, 6, 12] average= 13.0 uncer_average= -0.1537261
reCluster!use silhouette score and tao=0.0
each uncer num= [21, 6, 12] average= 13.0 uncer_average= -0.1537261
HC finish! Cost time=1.4358458518981934s
The HC Re-cluster result: num cluster = 1038(model) // 1038(model_ema) 	 num outliers = 4076(model) // 4076(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.6633102893829346s
The UCIS result: num clean cluster = 1038(model) 	 num outliers = 4076(model)
mdoel:new class are [1039], length of new dataset is 12446
Epoch: [0][0/300]	Time 4.691 (4.691)	Data 0.126 (0.126)	Loss_ce_clean 1.048 	Loss_ct_clean 0.945 	Prec 84.38%
Epoch: [0][50/300]	Time 0.769 (0.848)	Data 0.101 (0.103)	Loss_ce_clean 0.754 	Loss_ct_clean 0.978 	Prec 89.14%
Epoch: [0][100/300]	Time 0.772 (0.809)	Data 0.103 (0.102)	Loss_ce_clean 0.665 	Loss_ct_clean 1.120 	Prec 90.86%
Epoch: [0][150/300]	Time 0.771 (0.796)	Data 0.101 (0.102)	Loss_ce_clean 0.613 	Loss_ct_clean 1.096 	Prec 91.85%
Epoch: [0][200/300]	Time 0.765 (0.790)	Data 0.096 (0.102)	Loss_ce_clean 0.576 	Loss_ct_clean 1.059 	Prec 92.53%
Epoch: [0][250/300]	Time 0.769 (0.786)	Data 0.100 (0.102)	Loss_ce_clean 0.551 	Loss_ct_clean 1.026 	Prec 93.00%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.876393795013428
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.982349157333374
The orignal cluster result: num cluster = 1192(model) // 1159(model_ema) 	 num outliers = 2397(model) // 2685(model_ema)
Applying hierarchical clustering
[  -1 1109  669 ...   -1  698 1043]
(16522,)
(array([    0,     4,     6, ..., 16495, 16515, 16519]),)
(16522, 16522)
(14125, 16522)
(14125, 14125)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=1.78936767578125s
The HC Re-cluster result: num cluster = 1192(model) // 1159(model_ema) 	 num outliers = 2397(model) // 2685(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8240487575531006s
The UCIS result: num clean cluster = 1076(model) 	 num outliers = 4454(model)
mdoel:new class are [1077], length of new dataset is 12068
Epoch: [1][0/300]	Time 0.831 (0.831)	Data 0.157 (0.157)	Loss_ce_clean 0.248 	Loss_ct_clean 0.205 	Prec 96.09%
Epoch: [1][50/300]	Time 0.799 (0.812)	Data 0.130 (0.143)	Loss_ce_clean 0.264 	Loss_ct_clean 0.382 	Prec 96.74%
Epoch: [1][100/300]	Time 0.780 (0.801)	Data 0.111 (0.132)	Loss_ce_clean 0.252 	Loss_ct_clean 0.551 	Prec 97.12%
Epoch: [1][150/300]	Time 0.791 (0.795)	Data 0.122 (0.126)	Loss_ce_clean 0.242 	Loss_ct_clean 0.583 	Prec 97.29%
Epoch: [1][200/300]	Time 0.784 (0.791)	Data 0.114 (0.122)	Loss_ce_clean 0.237 	Loss_ct_clean 0.594 	Prec 97.34%
Epoch: [1][250/300]	Time 0.775 (0.788)	Data 0.106 (0.119)	Loss_ce_clean 0.228 	Loss_ct_clean 0.585 	Prec 97.49%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.91498351097107
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.164)	Data 0.000 (0.009)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.031373500823975
The orignal cluster result: num cluster = 1232(model) // 1206(model_ema) 	 num outliers = 1818(model) // 2251(model_ema)
Applying hierarchical clustering
[  -1  591  959 ...  753  488 1118]
(16522,)
(array([    0,     4,     6, ..., 16500, 16507, 16515]),)
(16522, 16522)
(14704, 16522)
(14704, 14704)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [6] average= 6.0 uncer_average= -0.08367771
HC finish! Cost time=1.766498327255249s
The HC Re-cluster result: num cluster = 1232(model) // 1206(model_ema) 	 num outliers = 1818(model) // 2251(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8322932720184326s
The UCIS result: num clean cluster = 1106(model) 	 num outliers = 4047(model)
mdoel:new class are [1107], length of new dataset is 12475
Epoch: [2][0/300]	Time 0.785 (0.785)	Data 0.112 (0.112)	Loss_ce_clean 0.176 	Loss_ct_clean 0.138 	Prec 99.22%
Epoch: [2][50/300]	Time 0.774 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.186 	Loss_ct_clean 0.274 	Prec 98.01%
Epoch: [2][100/300]	Time 0.775 (0.773)	Data 0.106 (0.104)	Loss_ce_clean 0.186 	Loss_ct_clean 0.417 	Prec 97.89%
Epoch: [2][150/300]	Time 0.775 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.179 	Loss_ct_clean 0.454 	Prec 98.05%
Epoch: [2][200/300]	Time 0.774 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.177 	Loss_ct_clean 0.466 	Prec 98.11%
Epoch: [2][250/300]	Time 0.774 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.171 	Loss_ct_clean 0.465 	Prec 98.21%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.778390645980835
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.918249130249023
The orignal cluster result: num cluster = 1262(model) // 1223(model_ema) 	 num outliers = 1449(model) // 1917(model_ema)
Applying hierarchical clustering
[  -1  710  442 ...  845  489 1001]
(16522,)
(array([    0,     4,    19, ..., 16475, 16507, 16515]),)
(16522, 16522)
(15073, 16522)
(15073, 15073)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=1.9198026657104492s
The HC Re-cluster result: num cluster = 1262(model) // 1223(model_ema) 	 num outliers = 1449(model) // 1917(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8474626541137695s
The UCIS result: num clean cluster = 1138(model) 	 num outliers = 3595(model)
mdoel:new class are [1139], length of new dataset is 12927
Epoch: [3][0/300]	Time 0.787 (0.787)	Data 0.116 (0.116)	Loss_ce_clean 0.098 	Loss_ct_clean 0.076 	Prec 100.00%
Epoch: [3][50/300]	Time 0.775 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.165 	Loss_ct_clean 0.229 	Prec 97.96%
Epoch: [3][100/300]	Time 0.770 (0.774)	Data 0.101 (0.105)	Loss_ce_clean 0.159 	Loss_ct_clean 0.358 	Prec 97.97%
Epoch: [3][150/300]	Time 0.782 (0.773)	Data 0.113 (0.104)	Loss_ce_clean 0.155 	Loss_ct_clean 0.392 	Prec 98.10%
Epoch: [3][200/300]	Time 0.770 (0.773)	Data 0.101 (0.104)	Loss_ce_clean 0.151 	Loss_ct_clean 0.407 	Prec 98.18%
Epoch: [3][250/300]	Time 0.774 (0.773)	Data 0.105 (0.104)	Loss_ce_clean 0.148 	Loss_ct_clean 0.414 	Prec 98.27%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.832860708236694
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.907621622085571
The orignal cluster result: num cluster = 1292(model) // 1237(model_ema) 	 num outliers = 1374(model) // 1709(model_ema)
Applying hierarchical clustering
[1157  238  927 ... 1110 1045 1105]
(16522,)
(array([    7,    10,    19, ..., 16474, 16507, 16515]),)
(16522, 16522)
(15148, 16522)
(15148, 15148)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=1.9061741828918457s
The HC Re-cluster result: num cluster = 1292(model) // 1237(model_ema) 	 num outliers = 1374(model) // 1709(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.844245195388794s
The UCIS result: num clean cluster = 1189(model) 	 num outliers = 3165(model)
mdoel:new class are [1190], length of new dataset is 13357
Epoch: [4][0/300]	Time 0.795 (0.795)	Data 0.124 (0.124)	Loss_ce_clean 0.146 	Loss_ct_clean 0.126 	Prec 96.88%
Epoch: [4][50/300]	Time 0.775 (0.773)	Data 0.106 (0.104)	Loss_ce_clean 0.135 	Loss_ct_clean 0.187 	Prec 98.28%
Epoch: [4][100/300]	Time 0.781 (0.773)	Data 0.112 (0.104)	Loss_ce_clean 0.135 	Loss_ct_clean 0.324 	Prec 98.41%
Epoch: [4][150/300]	Time 0.777 (0.773)	Data 0.108 (0.104)	Loss_ce_clean 0.134 	Loss_ct_clean 0.363 	Prec 98.46%
Epoch: [4][200/300]	Time 0.774 (0.773)	Data 0.104 (0.104)	Loss_ce_clean 0.132 	Loss_ct_clean 0.376 	Prec 98.52%
Epoch: [4][250/300]	Time 0.774 (0.774)	Data 0.105 (0.104)	Loss_ce_clean 0.131 	Loss_ct_clean 0.381 	Prec 98.57%
Extract Features: [100/156]	Time 0.155 (0.250)	Data 0.000 (0.096)	
Mean AP: 51.6%
CMC Scores:
  top-1          68.4%
  top-5          79.5%
  top-10         83.5%
Extract Features: [100/156]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Mean AP: 50.0%
CMC Scores:
  top-1          66.5%
  top-5          78.5%
  top-10         82.5%

 * Finished epoch   4  model no.1 mAP: 51.6% model no.2(mean-net) mAP: 50.0%  best: 51.6% *

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.163)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.775878667831421
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.879321098327637
The orignal cluster result: num cluster = 1325(model) // 1270(model_ema) 	 num outliers = 1219(model) // 1493(model_ema)
Applying hierarchical clustering
[1025  349  348 ... 1143  651 1213]
(16522,)
(array([    6,     7,    19, ..., 16474, 16507, 16515]),)
(16522, 16522)
(15303, 16522)
(15303, 15303)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.0399248600006104s
The HC Re-cluster result: num cluster = 1325(model) // 1270(model_ema) 	 num outliers = 1219(model) // 1493(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8418114185333252s
The UCIS result: num clean cluster = 1239(model) 	 num outliers = 2745(model)
mdoel:new class are [1240], length of new dataset is 13777
Epoch: [5][0/300]	Time 0.784 (0.784)	Data 0.112 (0.112)	Loss_ce_clean 0.155 	Loss_ct_clean 0.133 	Prec 99.22%
Epoch: [5][50/300]	Time 0.773 (0.774)	Data 0.104 (0.104)	Loss_ce_clean 0.136 	Loss_ct_clean 0.181 	Prec 98.33%
Epoch: [5][100/300]	Time 0.778 (0.774)	Data 0.108 (0.104)	Loss_ce_clean 0.133 	Loss_ct_clean 0.310 	Prec 98.45%
Epoch: [5][150/300]	Time 0.773 (0.774)	Data 0.104 (0.104)	Loss_ce_clean 0.128 	Loss_ct_clean 0.347 	Prec 98.58%
Epoch: [5][200/300]	Time 0.775 (0.774)	Data 0.105 (0.104)	Loss_ce_clean 0.125 	Loss_ct_clean 0.356 	Prec 98.64%
Epoch: [5][250/300]	Time 0.778 (0.774)	Data 0.108 (0.104)	Loss_ce_clean 0.123 	Loss_ct_clean 0.359 	Prec 98.72%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.803736925125122
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.914245367050171
The orignal cluster result: num cluster = 1350(model) // 1291(model_ema) 	 num outliers = 1034(model) // 1311(model_ema)
Applying hierarchical clustering
[ 916  771  757 ... 1242  763 1236]
(16522,)
(array([    7,    10,    19, ..., 16499, 16505, 16515]),)
(16522, 16522)
(15488, 16522)
(15488, 15488)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.949549674987793s
The HC Re-cluster result: num cluster = 1350(model) // 1291(model_ema) 	 num outliers = 1034(model) // 1311(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8333375453948975s
The UCIS result: num clean cluster = 1277(model) 	 num outliers = 2465(model)
mdoel:new class are [1278], length of new dataset is 14057
Epoch: [6][0/300]	Time 0.785 (0.785)	Data 0.114 (0.114)	Loss_ce_clean 0.135 	Loss_ct_clean 0.119 	Prec 96.88%
Epoch: [6][50/300]	Time 0.777 (0.774)	Data 0.107 (0.105)	Loss_ce_clean 0.120 	Loss_ct_clean 0.153 	Prec 98.58%
Epoch: [6][100/300]	Time 0.773 (0.775)	Data 0.104 (0.105)	Loss_ce_clean 0.119 	Loss_ct_clean 0.268 	Prec 98.57%
Epoch: [6][150/300]	Time 0.771 (0.774)	Data 0.101 (0.105)	Loss_ce_clean 0.118 	Loss_ct_clean 0.311 	Prec 98.61%
Epoch: [6][200/300]	Time 0.773 (0.774)	Data 0.104 (0.105)	Loss_ce_clean 0.117 	Loss_ct_clean 0.329 	Prec 98.68%
Epoch: [6][250/300]	Time 0.776 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.116 	Loss_ct_clean 0.338 	Prec 98.71%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.846162557601929
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.232235193252563
The orignal cluster result: num cluster = 1374(model) // 1319(model_ema) 	 num outliers = 982(model) // 1255(model_ema)
Applying hierarchical clustering
[ 772 1060  375 ... 1225  804 1264]
(16522,)
(array([   23,    42,    66,    68,    75,    83,    85,    97,   104,
         114,   161,   171,   188,   199,   213,   220,   241,   248,
         269,   271,   287,   341,   383,   394,   400,   412,   414,
         417,   422,   431,   436,   437,   443,   455,   460,   464,
         480,   495,   506,   513,   519,   524,   530,   546,   580,
         632,   637,   643,   672,   676,   677,   689,   714,   728,
         743,   752,   754,   799,   808,   827,   828,   832,   851,
         853,   854,   861,   905,   911,   913,   986,   997,  1020,
        1037,  1059,  1085,  1097,  1149,  1154,  1162,  1197,  1205,
        1209,  1222,  1263,  1317,  1319,  1354,  1374,  1396,  1402,
        1413,  1439,  1460,  1471,  1473,  1494,  1528,  1573,  1587,
        1605,  1618,  1631,  1644,  1654,  1672,  1675,  1685,  1734,
        1738,  1741,  1776,  1780,  1783,  1814,  1819,  1833,  1856,
        1871,  1931,  1944,  1983,  1984,  1998,  2039,  2101,  2127,
        2147,  2148,  2160,  2179,  2182,  2185,  2205,  2216,  2236,
        2241,  2248,  2282,  2297,  2299,  2300,  2330,  2356,  2385,
        2406,  2431,  2437,  2438,  2465,  2482,  2501,  2519,  2526,
        2532,  2535,  2564,  2567,  2569,  2585,  2612,  2680,  2684,
        2703,  2710,  2725,  2756,  2769,  2770,  2783,  2786,  2796,
        2814,  2818,  2819,  2822,  2871,  2876,  2880,  2889,  2897,
        2947,  2971,  2986,  3015,  3027,  3036,  3050,  3059,  3073,
        3090,  3105,  3107,  3117,  3121,  3129,  3157,  3167,  3180,
        3189,  3202,  3208,  3223,  3271,  3280,  3311,  3330,  3414,
        3426,  3434,  3437,  3446,  3448,  3454,  3492,  3502,  3544,
        3570,  3575,  3598,  3608,  3615,  3641,  3655,  3670,  3677,
        3685,  3713,  3716,  3749,  3764,  3794,  3815,  3817,  3848,
        3887,  3906,  3908,  3933,  3947,  3951,  4022,  4061,  4065,
        4094,  4105,  4106,  4143,  4156,  4160,  4199,  4209,  4221,
        4236,  4242,  4248,  4249,  4251,  4254,  4296,  4312,  4319,
        4324,  4334,  4360,  4373,  4393,  4410,  4424,  4429,  4433,
        4438,  4448,  4477,  4487,  4499,  4539,  4566,  4609,  4628,
        4632,  4637,  4638,  4651,  4657,  4676,  4682,  4685,  4695,
        4738,  4747,  4751,  4753,  4777,  4848,  4876,  4899,  4914,
        4920,  4924,  4938,  4939,  5023,  5053,  5082,  5084,  5094,
        5107,  5108,  5117,  5134,  5141,  5148,  5180,  5184,  5199,
        5220,  5232,  5239,  5265,  5267,  5277,  5298,  5304,  5306,
        5320,  5350,  5362,  5367,  5379,  5386,  5407,  5418,  5420,
        5440,  5458,  5465,  5472,  5474,  5492,  5513,  5540,  5545,
        5546,  5567,  5575,  5577,  5578,  5585,  5602,  5613,  5637,
        5659,  5669,  5702,  5712,  5730,  5777,  5795,  5813,  5816,
        5838,  5848,  5849,  5852,  5894,  5913,  5934,  5945,  5949,
        5972,  5995,  6004,  6028,  6035,  6060,  6067,  6080,  6082,
        6095,  6113,  6128,  6132,  6134,  6144,  6174,  6181,  6194,
        6208,  6225,  6238,  6253,  6271,  6316,  6319,  6366,  6385,
        6389,  6410,  6447,  6448,  6491,  6531,  6540,  6568,  6573,
        6574,  6629,  6632,  6666,  6696,  6721,  6758,  6761,  6788,
        6803,  6818,  6820,  6825,  6827,  6859,  6860,  6874,  6876,
        6898,  6946,  6956,  6964,  7035,  7045,  7069,  7071,  7105,
        7110,  7145,  7162,  7188,  7214,  7218,  7307,  7309,  7321,
        7323,  7371,  7378,  7382,  7383,  7387,  7389,  7395,  7440,
        7473,  7492,  7506,  7513,  7515,  7533,  7538,  7560,  7564,
        7565,  7575,  7595,  7612,  7625,  7630,  7631,  7632,  7655,
        7674,  7682,  7696,  7725,  7732,  7752,  7763,  7765,  7796,
        7831,  7844,  7858,  7860,  7882,  7919,  7960,  7967,  7980,
        7985,  8033,  8046,  8059,  8068,  8101,  8129,  8134,  8173,
        8203,  8215,  8222,  8227,  8232,  8237,  8263,  8285,  8299,
        8319,  8335,  8340,  8373,  8392,  8458,  8464,  8471,  8473,
        8487,  8491,  8497,  8525,  8528,  8548,  8557,  8568,  8576,
        8577,  8579,  8609,  8638,  8657,  8662,  8679,  8688,  8705,
        8746,  8756,  8775,  8778,  8780,  8787,  8799,  8818,  8821,
        8847,  8880,  8884,  8893,  8894,  8926,  8931,  8946,  8966,
        8971,  8973,  9029,  9039,  9049,  9057,  9059,  9081,  9107,
        9136,  9159,  9181,  9218,  9250,  9276,  9282,  9328,  9354,
        9360,  9398,  9404,  9416,  9471,  9483,  9485,  9486,  9497,
        9504,  9528,  9529,  9531,  9535,  9539,  9554,  9562,  9575,
        9590,  9600,  9609,  9629,  9645,  9679,  9696,  9725,  9754,
        9759,  9792,  9794,  9810,  9835,  9838,  9854,  9897,  9930,
        9936,  9941,  9944,  9961, 10007, 10034, 10035, 10047, 10052,
       10060, 10070, 10076, 10077, 10078, 10105, 10140, 10149, 10154,
       10164, 10177, 10205, 10213, 10215, 10233, 10271, 10274, 10275,
       10281, 10304, 10306, 10337, 10345, 10350, 10351, 10353, 10368,
       10408, 10435, 10445, 10453, 10457, 10459, 10460, 10479, 10482,
       10484, 10493, 10507, 10533, 10535, 10540, 10593, 10627, 10629,
       10642, 10665, 10693, 10697, 10701, 10750, 10762, 10764, 10770,
       10794, 10821, 10825, 10846, 10854, 10877, 10923, 10932, 10933,
       10946, 10973, 11002, 11009, 11049, 11059, 11090, 11092, 11112,
       11116, 11117, 11132, 11195, 11224, 11226, 11230, 11262, 11297,
       11317, 11324, 11341, 11354, 11359, 11420, 11472, 11496, 11514,
       11545, 11553, 11579, 11605, 11610, 11619, 11686, 11701, 11723,
       11724, 11790, 11830, 11845, 11849, 11858, 11869, 11874, 11883,
       11900, 11912, 11929, 11939, 11943, 11972, 12031, 12079, 12094,
       12148, 12154, 12178, 12184, 12212, 12226, 12231, 12234, 12317,
       12339, 12340, 12376, 12394, 12414, 12434, 12438, 12441, 12449,
       12453, 12458, 12466, 12472, 12477, 12478, 12510, 12513, 12550,
       12557, 12576, 12602, 12628, 12655, 12658, 12661, 12665, 12681,
       12688, 12699, 12715, 12721, 12743, 12759, 12802, 12823, 12845,
       12916, 12974, 12980, 12986, 13000, 13035, 13051, 13063, 13072,
       13076, 13082, 13102, 13110, 13120, 13136, 13159, 13160, 13162,
       13167, 13190, 13200, 13213, 13224, 13235, 13238, 13242, 13260,
       13292, 13296, 13300, 13303, 13320, 13337, 13352, 13388, 13407,
       13409, 13441, 13444, 13462, 13467, 13489, 13511, 13519, 13528,
       13558, 13597, 13601, 13615, 13619, 13620, 13625, 13644, 13648,
       13677, 13680, 13709, 13724, 13728, 13734, 13742, 13776, 13795,
       13841, 13890, 13893, 13976, 13991, 13999, 14037, 14039, 14052,
       14088, 14121, 14124, 14147, 14164, 14174, 14220, 14222, 14226,
       14255, 14258, 14266, 14284, 14327, 14349, 14371, 14374, 14412,
       14421, 14425, 14461, 14506, 14508, 14520, 14534, 14559, 14567,
       14579, 14593, 14594, 14604, 14616, 14634, 14675, 14680, 14727,
       14743, 14761, 14812, 14865, 14898, 14905, 14921, 14933, 14935,
       14970, 14974, 14982, 14983, 14985, 14988, 14997, 15005, 15037,
       15041, 15053, 15056, 15084, 15090, 15100, 15111, 15112, 15141,
       15161, 15166, 15182, 15194, 15197, 15213, 15229, 15245, 15257,
       15258, 15272, 15287, 15295, 15324, 15340, 15391, 15393, 15402,
       15406, 15424, 15427, 15443, 15482, 15484, 15524, 15575, 15592,
       15597, 15613, 15653, 15667, 15678, 15712, 15731, 15752, 15774,
       15851, 15912, 15932, 15950, 15963, 15969, 15978, 15995, 16020,
       16033, 16058, 16086, 16121, 16130, 16174, 16191, 16202, 16206,
       16211, 16218, 16235, 16238, 16240, 16251, 16259, 16290, 16292,
       16334, 16361, 16431, 16436, 16449, 16465, 16467, 16474, 16507,
       16515]),)
(16522, 16522)
(15540, 16522)
(15540, 15540)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.47633957862854s
The HC Re-cluster result: num cluster = 1374(model) // 1319(model_ema) 	 num outliers = 982(model) // 1255(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9332168102264404s
The UCIS result: num clean cluster = 1298(model) 	 num outliers = 2276(model)
mdoel:new class are [1299], length of new dataset is 14246
Epoch: [7][0/300]	Time 1.072 (1.072)	Data 0.342 (0.342)	Loss_ce_clean 0.092 	Loss_ct_clean 0.085 	Prec 99.22%
Epoch: [7][50/300]	Time 0.787 (1.197)	Data 0.112 (0.146)	Loss_ce_clean 0.114 	Loss_ct_clean 0.155 	Prec 98.77%
Epoch: [7][100/300]	Time 1.417 (1.157)	Data 0.107 (0.255)	Loss_ce_clean 0.106 	Loss_ct_clean 0.262 	Prec 98.90%
Epoch: [7][150/300]	Time 0.973 (1.130)	Data 0.116 (0.208)	Loss_ce_clean 0.107 	Loss_ct_clean 0.296 	Prec 98.82%
Epoch: [7][200/300]	Time 0.970 (1.094)	Data 0.118 (0.184)	Loss_ce_clean 0.106 	Loss_ct_clean 0.309 	Prec 98.88%
Epoch: [7][250/300]	Time 0.783 (1.077)	Data 0.113 (0.170)	Loss_ce_clean 0.104 	Loss_ct_clean 0.312 	Prec 98.93%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.177)	Data 0.000 (0.020)	
Computing jaccard distance...
Jaccard distance computing time cost: 12.591485977172852
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.161 (0.246)	Data 0.000 (0.076)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.33085036277771
The orignal cluster result: num cluster = 1394(model) // 1347(model_ema) 	 num outliers = 811(model) // 1119(model_ema)
Applying hierarchical clustering
[ 574 1265  770 ... 1304  450 1309]
(16522,)
(array([    7,    42,    66,    68,    75,    85,    97,   104,   114,
         145,   161,   171,   188,   199,   213,   220,   241,   248,
         269,   271,   287,   338,   341,   383,   390,   394,   400,
         412,   414,   417,   436,   445,   455,   460,   464,   495,
         506,   519,   545,   602,   637,   643,   651,   672,   676,
         677,   714,   724,   728,   743,   754,   779,   808,   827,
         828,   832,   851,   853,   854,   861,   899,   911,   913,
         986,   997,  1001,  1037,  1039,  1059,  1149,  1154,  1162,
        1197,  1209,  1218,  1222,  1263,  1309,  1317,  1319,  1354,
        1396,  1402,  1413,  1417,  1433,  1439,  1453,  1460,  1471,
        1473,  1494,  1528,  1573,  1587,  1618,  1631,  1654,  1672,
        1675,  1685,  1699,  1741,  1746,  1780,  1783,  1814,  1819,
        1833,  1856,  1931,  1944,  1983,  2017,  2039,  2057,  2147,
        2148,  2170,  2179,  2182,  2185,  2205,  2248,  2264,  2282,
        2297,  2299,  2300,  2307,  2330,  2406,  2430,  2431,  2438,
        2447,  2465,  2482,  2486,  2501,  2680,  2684,  2703,  2724,
        2756,  2769,  2770,  2814,  2818,  2837,  2889,  2913,  2947,
        2955,  2971,  2986,  3015,  3027,  3073,  3117,  3126,  3157,
        3180,  3189,  3202,  3208,  3219,  3245,  3249,  3272,  3280,
        3283,  3311,  3330,  3334,  3434,  3437,  3448,  3480,  3507,
        3517,  3570,  3575,  3598,  3608,  3615,  3641,  3650,  3670,
        3677,  3685,  3713,  3716,  3728,  3774,  3794,  3812,  3815,
        3896,  3908,  3933,  3941,  3947,  3951,  3958,  3961,  3995,
        4022,  4060,  4061,  4065,  4100,  4105,  4106,  4143,  4156,
        4160,  4199,  4209,  4215,  4242,  4248,  4249,  4251,  4257,
        4296,  4319,  4321,  4372,  4373,  4393,  4398,  4429,  4433,
        4438,  4448,  4487,  4498,  4499,  4515,  4539,  4566,  4597,
        4609,  4614,  4628,  4638,  4651,  4676,  4682,  4685,  4738,
        4747,  4751,  4753,  4774,  4777,  4849,  4861,  4876,  4899,
        4914,  4920,  4944,  5023,  5035,  5053,  5082,  5094,  5107,
        5129,  5134,  5141,  5180,  5184,  5220,  5239,  5253,  5265,
        5267,  5280,  5317,  5320,  5362,  5379,  5438,  5440,  5445,
        5472,  5473,  5513,  5526,  5542,  5546,  5558,  5567,  5577,
        5578,  5585,  5602,  5603,  5613,  5619,  5659,  5669,  5702,
        5739,  5816,  5838,  5848,  5849,  5852,  5926,  5945,  5946,
        6028,  6082,  6095,  6111,  6128,  6132,  6144,  6153,  6202,
        6208,  6238,  6253,  6296,  6301,  6316,  6336,  6366,  6447,
        6448,  6451,  6491,  6593,  6629,  6632,  6658,  6666,  6696,
        6697,  6713,  6744,  6761,  6788,  6818,  6820,  6825,  6827,
        6859,  6860,  6874,  6876,  6898,  6911,  6946,  6956,  6964,
        7071,  7168,  7181,  7186,  7206,  7214,  7218,  7307,  7309,
        7362,  7371,  7382,  7383,  7389,  7395,  7492,  7503,  7506,
        7513,  7515,  7516,  7538,  7560,  7564,  7565,  7575,  7604,
        7612,  7625,  7630,  7696,  7722,  7752,  7765,  7784,  7796,
        7858,  7919,  7928,  7972,  7980,  7981,  7985,  8031,  8033,
        8046,  8059,  8101,  8129,  8203,  8222,  8232,  8237,  8263,
        8285,  8299,  8309,  8381,  8392,  8471,  8487,  8510,  8525,
        8528,  8529,  8548,  8557,  8566,  8576,  8577,  8579,  8605,
        8638,  8688,  8705,  8721,  8746,  8753,  8756,  8775,  8778,
        8780,  8799,  8818,  8849,  8884,  8894,  8926,  8931,  8946,
        8973,  8974,  9029,  9039,  9057,  9059,  9081,  9085,  9107,
        9159,  9226,  9250,  9276,  9282,  9328,  9332,  9360,  9398,
        9399,  9433,  9471,  9485,  9497,  9516,  9521,  9529,  9535,
        9562,  9575,  9600,  9609,  9629,  9645,  9696,  9725,  9740,
        9746,  9754,  9794,  9835,  9838,  9930,  9936,  9941,  9944,
        9963,  9988, 10007, 10030, 10033, 10034, 10035, 10047, 10052,
       10058, 10060, 10070, 10076, 10078, 10105, 10125, 10149, 10177,
       10205, 10211, 10215, 10251, 10271, 10337, 10345, 10357, 10368,
       10369, 10408, 10435, 10445, 10453, 10460, 10479, 10482, 10533,
       10535, 10540, 10593, 10604, 10608, 10629, 10642, 10665, 10670,
       10697, 10701, 10716, 10750, 10762, 10764, 10770, 10794, 10804,
       10877, 10923, 10932, 10933, 10946, 10973, 11002, 11004, 11025,
       11090, 11092, 11112, 11116, 11172, 11210, 11224, 11230, 11274,
       11297, 11317, 11324, 11342, 11359, 11415, 11420, 11472, 11496,
       11545, 11553, 11555, 11579, 11605, 11610, 11619, 11620, 11622,
       11674, 11686, 11701, 11714, 11724, 11749, 11764, 11790, 11827,
       11830, 11845, 11849, 11912, 11915, 11929, 11939, 11972, 12031,
       12079, 12090, 12094, 12148, 12154, 12184, 12226, 12231, 12234,
       12266, 12341, 12394, 12412, 12414, 12416, 12438, 12448, 12453,
       12458, 12478, 12510, 12538, 12557, 12576, 12661, 12665, 12688,
       12699, 12715, 12721, 12743, 12749, 12759, 12823, 12845, 12916,
       12974, 12980, 12984, 13000, 13051, 13072, 13082, 13099, 13102,
       13110, 13120, 13129, 13132, 13159, 13160, 13162, 13167, 13190,
       13224, 13235, 13248, 13258, 13292, 13296, 13300, 13311, 13337,
       13340, 13388, 13409, 13441, 13444, 13462, 13489, 13511, 13519,
       13528, 13601, 13606, 13615, 13619, 13625, 13644, 13668, 13673,
       13677, 13709, 13717, 13724, 13728, 13731, 13734, 13742, 13762,
       13795, 13834, 13890, 13893, 13976, 13991, 14112, 14121, 14163,
       14174, 14220, 14222, 14255, 14258, 14260, 14266, 14284, 14339,
       14361, 14371, 14412, 14421, 14447, 14461, 14506, 14508, 14514,
       14520, 14559, 14567, 14579, 14593, 14594, 14604, 14634, 14680,
       14706, 14743, 14776, 14810, 14812, 14865, 14877, 14887, 14898,
       14950, 14970, 14982, 14983, 14985, 14997, 15005, 15037, 15090,
       15111, 15112, 15141, 15156, 15161, 15166, 15182, 15194, 15197,
       15200, 15240, 15245, 15257, 15258, 15292, 15295, 15324, 15406,
       15411, 15424, 15432, 15443, 15447, 15482, 15484, 15524, 15591,
       15592, 15597, 15613, 15626, 15667, 15712, 15717, 15725, 15752,
       15848, 15932, 15963, 15969, 15977, 15978, 15995, 16005, 16020,
       16033, 16058, 16075, 16086, 16148, 16174, 16191, 16206, 16211,
       16224, 16235, 16251, 16259, 16270, 16292, 16361, 16467, 16507,
       16515]),)
(16522, 16522)
(15711, 16522)
(15711, 15711)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.3283231258392334s
The HC Re-cluster result: num cluster = 1394(model) // 1347(model_ema) 	 num outliers = 811(model) // 1119(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.340665340423584s
The UCIS result: num clean cluster = 1338(model) 	 num outliers = 1965(model)
mdoel:new class are [1339], length of new dataset is 14557
Epoch: [8][0/300]	Time 2.189 (2.189)	Data 1.433 (1.433)	Loss_ce_clean 0.082 	Loss_ct_clean 0.075 	Prec 99.22%
Epoch: [8][50/300]	Time 2.087 (1.859)	Data 1.414 (1.188)	Loss_ce_clean 0.102 	Loss_ct_clean 0.130 	Prec 98.64%
Epoch: [8][100/300]	Time 0.883 (1.426)	Data 0.214 (0.756)	Loss_ce_clean 0.101 	Loss_ct_clean 0.239 	Prec 98.79%
Epoch: [8][150/300]	Time 0.853 (1.250)	Data 0.183 (0.579)	Loss_ce_clean 0.101 	Loss_ct_clean 0.270 	Prec 98.79%
Epoch: [8][200/300]	Time 0.867 (1.155)	Data 0.198 (0.485)	Loss_ce_clean 0.098 	Loss_ct_clean 0.285 	Prec 98.87%
Epoch: [8][250/300]	Time 0.816 (1.091)	Data 0.147 (0.420)	Loss_ce_clean 0.098 	Loss_ct_clean 0.288 	Prec 98.91%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.165 (0.167)	Data 0.000 (0.011)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.178366661071777
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.270)	Data 0.000 (0.015)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.664020538330078
The orignal cluster result: num cluster = 1413(model) // 1371(model_ema) 	 num outliers = 860(model) // 973(model_ema)
Applying hierarchical clustering
[1040 1227  756 ... 1315  190 1326]
(16522,)
(array([    7,    39,    75,    85,    97,   104,   161,   182,   188,
         197,   199,   213,   220,   241,   247,   248,   269,   277,
         287,   338,   359,   380,   383,   394,   400,   414,   417,
         422,   436,   443,   460,   464,   472,   480,   481,   486,
         495,   499,   506,   519,   573,   588,   602,   637,   643,
         676,   677,   680,   714,   724,   728,   743,   752,   759,
         770,   798,   799,   807,   808,   827,   832,   851,   853,
         854,   861,   899,   911,   927,   942,   986,   997,  1030,
        1037,  1059,  1063,  1098,  1140,  1149,  1197,  1205,  1209,
        1222,  1232,  1246,  1263,  1317,  1319,  1394,  1396,  1402,
        1413,  1430,  1473,  1526,  1573,  1587,  1613,  1618,  1635,
        1654,  1670,  1672,  1697,  1735,  1746,  1780,  1781,  1783,
        1819,  1833,  1871,  1931,  1983,  1984,  2017,  2039,  2057,
        2119,  2127,  2148,  2170,  2182,  2185,  2205,  2216,  2241,
        2264,  2282,  2284,  2297,  2299,  2300,  2307,  2330,  2332,
        2403,  2406,  2431,  2438,  2447,  2465,  2494,  2501,  2510,
        2526,  2564,  2575,  2584,  2585,  2611,  2673,  2680,  2684,
        2703,  2710,  2724,  2735,  2769,  2770,  2783,  2796,  2814,
        2818,  2837,  2871,  2876,  2889,  2913,  2922,  2947,  2955,
        2986,  3015,  3027,  3030,  3036,  3037,  3050,  3073,  3114,
        3117,  3126,  3129,  3142,  3148,  3157,  3180,  3189,  3198,
        3202,  3249,  3271,  3272,  3280,  3311,  3328,  3330,  3381,
        3434,  3448,  3454,  3475,  3480,  3496,  3534,  3570,  3571,
        3575,  3615,  3685,  3713,  3716,  3728,  3749,  3764,  3773,
        3794,  3812,  3815,  3873,  3896,  3906,  3908,  3933,  3947,
        3995,  4022,  4061,  4065,  4100,  4105,  4106,  4156,  4199,
        4247,  4248,  4251,  4257,  4311,  4321,  4334,  4360,  4372,
        4393,  4410,  4428,  4429,  4433,  4448,  4477,  4487,  4499,
        4523,  4528,  4539,  4563,  4566,  4609,  4637,  4638,  4651,
        4657,  4682,  4685,  4747,  4751,  4753,  4760,  4777,  4778,
        4798,  4848,  4876,  4902,  4908,  4914,  4920,  4924,  4944,
        5016,  5023,  5035,  5053,  5058,  5084,  5107,  5129,  5134,
        5162,  5180,  5184,  5220,  5232,  5239,  5265,  5267,  5277,
        5280,  5320,  5361,  5362,  5418,  5440,  5445,  5453,  5458,
        5492,  5513,  5526,  5545,  5558,  5567,  5578,  5585,  5602,
        5603,  5613,  5668,  5669,  5750,  5768,  5773,  5795,  5807,
        5816,  5848,  5849,  5894,  5949,  5995,  6004,  6028,  6035,
        6060,  6080,  6082,  6095,  6111,  6128,  6181,  6202,  6208,
        6253,  6296,  6301,  6316,  6319,  6324,  6336,  6389,  6442,
        6443,  6447,  6448,  6451,  6467,  6491,  6543,  6568,  6593,
        6624,  6629,  6632,  6658,  6666,  6696,  6713,  6744,  6761,
        6788,  6818,  6820,  6825,  6826,  6827,  6859,  6860,  6874,
        6876,  6887,  6898,  6946,  6957,  6964,  6965,  7105,  7110,
        7168,  7181,  7188,  7206,  7259,  7323,  7378,  7382,  7389,
        7420,  7473,  7503,  7506,  7513,  7515,  7516,  7538,  7560,
        7565,  7597,  7612,  7625,  7630,  7655,  7682,  7722,  7732,
        7752,  7765,  7772,  7796,  7919,  7928,  7972,  7980,  7981,
        8031,  8046,  8059,  8101,  8120,  8129,  8160,  8227,  8232,
        8237,  8263,  8285,  8299,  8319,  8340,  8373,  8379,  8381,
        8389,  8392,  8395,  8458,  8471,  8487,  8497,  8510,  8525,
        8528,  8529,  8548,  8557,  8577,  8579,  8605,  8609,  8638,
        8679,  8705,  8721,  8746,  8753,  8778,  8780,  8787,  8799,
        8818,  8845,  8847,  8880,  8884,  8893,  8907,  8909,  8926,
        8931,  8959,  8973,  9039,  9049,  9057,  9064,  9081,  9107,
        9159,  9184,  9226,  9282,  9360,  9365,  9398,  9399,  9416,
        9427,  9471,  9480,  9485,  9486,  9497,  9504,  9516,  9529,
        9535,  9539,  9562,  9590,  9600,  9610,  9629,  9631,  9645,
        9696,  9725,  9740,  9751,  9754,  9757,  9759,  9760,  9779,
        9792,  9794,  9810,  9835,  9854,  9897,  9936,  9939,  9941,
        9944,  9961,  9988, 10007, 10014, 10015, 10030, 10035, 10047,
       10052, 10058, 10070, 10076, 10078, 10105, 10125, 10140, 10149,
       10150, 10154, 10177, 10205, 10213, 10215, 10251, 10271, 10306,
       10337, 10350, 10369, 10435, 10445, 10453, 10457, 10460, 10482,
       10493, 10540, 10561, 10589, 10593, 10604, 10608, 10628, 10640,
       10642, 10665, 10693, 10697, 10701, 10707, 10716, 10750, 10762,
       10764, 10770, 10794, 10821, 10825, 10846, 10854, 10877, 10923,
       10932, 10933, 10946, 10973, 11004, 11049, 11059, 11090, 11112,
       11116, 11117, 11172, 11195, 11230, 11235, 11241, 11262, 11274,
       11317, 11324, 11354, 11359, 11420, 11472, 11514, 11553, 11610,
       11619, 11674, 11681, 11714, 11724, 11764, 11767, 11790, 11830,
       11849, 11890, 11900, 11912, 11929, 11939, 11943, 11972, 12031,
       12079, 12090, 12154, 12184, 12226, 12231, 12339, 12357, 12394,
       12412, 12414, 12426, 12432, 12434, 12436, 12438, 12448, 12453,
       12458, 12472, 12478, 12510, 12538, 12556, 12557, 12579, 12658,
       12665, 12681, 12688, 12699, 12715, 12721, 12749, 12759, 12763,
       12875, 12916, 12974, 12980, 12984, 13035, 13047, 13051, 13072,
       13099, 13110, 13120, 13129, 13144, 13159, 13160, 13174, 13190,
       13213, 13218, 13235, 13238, 13242, 13248, 13260, 13271, 13277,
       13292, 13320, 13352, 13382, 13407, 13409, 13441, 13444, 13462,
       13467, 13489, 13511, 13528, 13545, 13558, 13597, 13601, 13606,
       13615, 13619, 13625, 13644, 13651, 13677, 13680, 13707, 13709,
       13717, 13724, 13734, 13742, 13795, 13841, 13890, 13893, 13925,
       13976, 13991, 14052, 14079, 14101, 14121, 14124, 14147, 14164,
       14174, 14183, 14220, 14222, 14235, 14255, 14258, 14261, 14278,
       14295, 14325, 14327, 14339, 14340, 14349, 14361, 14368, 14371,
       14421, 14447, 14461, 14506, 14514, 14520, 14521, 14559, 14567,
       14579, 14604, 14616, 14634, 14647, 14675, 14708, 14812, 14822,
       14824, 14854, 14865, 14877, 14950, 14974, 14982, 14983, 14997,
       15005, 15053, 15090, 15110, 15111, 15141, 15161, 15166, 15182,
       15185, 15194, 15197, 15213, 15245, 15258, 15287, 15295, 15332,
       15352, 15406, 15424, 15427, 15443, 15447, 15454, 15482, 15484,
       15524, 15575, 15592, 15597, 15608, 15613, 15642, 15653, 15667,
       15678, 15712, 15717, 15731, 15752, 15784, 15807, 15851, 15914,
       15915, 15969, 15978, 15995, 16058, 16086, 16138, 16148, 16174,
       16191, 16202, 16211, 16240, 16251, 16259, 16292, 16431, 16465,
       16467, 16474, 16507, 16515, 16518]),)
(16522, 16522)
(15662, 16522)
(15662, 15662)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.510901689529419s
The HC Re-cluster result: num cluster = 1413(model) // 1371(model_ema) 	 num outliers = 860(model) // 973(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9138383865356445s
The UCIS result: num clean cluster = 1363(model) 	 num outliers = 1852(model)
mdoel:new class are [1364], length of new dataset is 14670
Epoch: [9][0/300]	Time 1.728 (1.728)	Data 0.133 (0.133)	Loss_ce_clean 0.147 	Loss_ct_clean 0.144 	Prec 96.88%
Epoch: [9][50/300]	Time 0.784 (1.043)	Data 0.115 (0.192)	Loss_ce_clean 0.106 	Loss_ct_clean 0.123 	Prec 98.51%
Epoch: [9][100/300]	Time 4.117 (1.486)	Data 3.445 (0.600)	Loss_ce_clean 0.101 	Loss_ct_clean 0.234 	Prec 98.68%
Epoch: [9][150/300]	Time 0.779 (1.705)	Data 0.110 (0.877)	Loss_ce_clean 0.099 	Loss_ct_clean 0.266 	Prec 98.75%
Epoch: [9][200/300]	Time 3.163 (1.998)	Data 2.492 (1.137)	Loss_ce_clean 0.099 	Loss_ct_clean 0.280 	Prec 98.75%
Epoch: [9][250/300]	Time 3.984 (2.649)	Data 3.314 (1.826)	Loss_ce_clean 0.098 	Loss_ct_clean 0.285 	Prec 98.77%
Extract Features: [100/156]	Time 0.163 (0.879)	Data 0.000 (0.718)	
Mean AP: 50.5%
CMC Scores:
  top-1          67.9%
  top-5          79.6%
  top-10         83.9%
Extract Features: [100/156]	Time 0.155 (0.166)	Data 0.000 (0.011)	
Mean AP: 53.9%
CMC Scores:
  top-1          70.0%
  top-5          81.1%
  top-10         85.3%

 * Finished epoch   9  model no.1 mAP: 50.5% model no.2(mean-net) mAP: 53.9%  best: 53.9% *

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.154 (0.302)	Data 0.000 (0.148)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.589210510253906
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.154 (0.340)	Data 0.000 (0.185)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.867340803146362
The orignal cluster result: num cluster = 1445(model) // 1387(model_ema) 	 num outliers = 796(model) // 945(model_ema)
Applying hierarchical clustering
[ 789  997  619 ... 1190 1138   -1]
(16522,)
(array([   23,    66,    68,    75,    83,    85,    97,   104,   112,
         161,   182,   188,   197,   213,   220,   241,   277,   287,
         338,   383,   394,   400,   414,   417,   431,   436,   437,
         443,   460,   464,   472,   481,   486,   519,   530,   545,
         588,   602,   637,   643,   651,   672,   676,   677,   680,
         689,   714,   715,   752,   759,   771,   807,   808,   812,
         827,   832,   851,   853,   854,   861,   899,   911,   913,
         927,   965,   986,   987,  1020,  1037,  1039,  1059,  1097,
        1098,  1154,  1222,  1246,  1263,  1288,  1317,  1319,  1324,
        1359,  1396,  1402,  1413,  1417,  1460,  1473,  1520,  1526,
        1528,  1573,  1587,  1605,  1618,  1654,  1672,  1675,  1685,
        1735,  1746,  1783,  1794,  1819,  1824,  1833,  1856,  1860,
        1916,  1931,  1998,  2017,  2057,  2101,  2119,  2127,  2147,
        2148,  2182,  2205,  2216,  2241,  2282,  2295,  2297,  2299,
        2307,  2332,  2403,  2406,  2431,  2438,  2465,  2486,  2494,
        2501,  2584,  2680,  2684,  2703,  2769,  2783,  2794,  2796,
        2814,  2818,  2819,  2880,  2913,  2935,  2947,  2955,  2986,
        3015,  3027,  3030,  3036,  3037,  3043,  3105,  3107,  3117,
        3118,  3126,  3142,  3157,  3178,  3180,  3189,  3202,  3219,
        3223,  3249,  3271,  3280,  3297,  3311,  3330,  3434,  3448,
        3454,  3480,  3502,  3507,  3570,  3571,  3575,  3582,  3598,
        3644,  3682,  3685,  3695,  3708,  3713,  3716,  3728,  3749,
        3764,  3794,  3815,  3851,  3873,  3878,  3896,  3906,  3908,
        3933,  3941,  3947,  3995,  4054,  4065,  4105,  4106,  4199,
        4209,  4221,  4242,  4247,  4248,  4251,  4311,  4321,  4334,
        4373,  4393,  4410,  4424,  4428,  4429,  4433,  4448,  4477,
        4480,  4487,  4496,  4499,  4523,  4528,  4539,  4566,  4614,
        4637,  4657,  4681,  4682,  4685,  4695,  4747,  4760,  4777,
        4798,  4848,  4876,  4902,  4920,  4939,  5023,  5053,  5082,
        5084,  5094,  5107,  5129,  5141,  5148,  5180,  5184,  5199,
        5215,  5220,  5232,  5239,  5255,  5265,  5267,  5280,  5317,
        5320,  5321,  5332,  5361,  5379,  5403,  5418,  5440,  5453,
        5534,  5577,  5578,  5580,  5583,  5585,  5589,  5603,  5659,
        5669,  5712,  5720,  5750,  5790,  5795,  5812,  5816,  5894,
        5913,  6035,  6040,  6060,  6067,  6082,  6095,  6111,  6128,
        6144,  6202,  6208,  6222,  6253,  6296,  6301,  6366,  6389,
        6442,  6443,  6447,  6448,  6451,  6465,  6467,  6491,  6556,
        6593,  6624,  6629,  6632,  6658,  6696,  6713,  6721,  6758,
        6761,  6788,  6818,  6820,  6822,  6825,  6859,  6860,  6876,
        6898,  6956,  6957,  6965,  7085,  7110,  7115,  7139,  7145,
        7162,  7168,  7188,  7206,  7259,  7307,  7362,  7387,  7389,
        7425,  7440,  7457,  7473,  7513,  7516,  7538,  7560,  7564,
        7565,  7612,  7625,  7630,  7632,  7655,  7722,  7746,  7752,
        7765,  7772,  7796,  7809,  7859,  7919,  7928,  7972,  7980,
        7981,  8014,  8033,  8059,  8101,  8120,  8129,  8178,  8186,
        8201,  8237,  8263,  8285,  8299,  8319,  8324,  8340,  8373,
        8379,  8392,  8471,  8497,  8525,  8528,  8557,  8566,  8576,
        8577,  8579,  8623,  8638,  8678,  8705,  8721,  8738,  8746,
        8753,  8778,  8780,  8787,  8818,  8847,  8884,  8893,  8926,
        8931,  8959,  8974,  8989,  9049,  9064,  9081,  9107,  9154,
        9159,  9184,  9282,  9328,  9360,  9398,  9399,  9471,  9485,
        9486,  9497,  9504,  9516,  9521,  9528,  9535,  9539,  9554,
        9562,  9575,  9590,  9600,  9645,  9675,  9679,  9725,  9740,
        9746,  9752,  9760,  9771,  9779,  9782,  9792,  9794,  9810,
        9835,  9838,  9930,  9939,  9941,  9944,  9961,  9963,  9978,
        9988, 10007, 10014, 10034, 10035, 10047, 10070, 10076, 10101,
       10105, 10125, 10140, 10149, 10177, 10181, 10205, 10213, 10215,
       10237, 10271, 10275, 10337, 10365, 10369, 10408, 10435, 10445,
       10453, 10460, 10482, 10493, 10504, 10533, 10535, 10540, 10561,
       10589, 10593, 10604, 10608, 10629, 10642, 10665, 10697, 10701,
       10716, 10725, 10750, 10762, 10770, 10794, 10825, 10877, 10933,
       10946, 10973, 11004, 11027, 11092, 11112, 11116, 11132, 11172,
       11194, 11230, 11274, 11317, 11324, 11415, 11420, 11463, 11472,
       11514, 11553, 11555, 11579, 11610, 11619, 11622, 11681, 11701,
       11723, 11724, 11767, 11790, 11818, 11827, 11845, 11890, 11912,
       11929, 11939, 11972, 12031, 12079, 12090, 12154, 12184, 12226,
       12231, 12234, 12340, 12394, 12412, 12414, 12416, 12426, 12427,
       12434, 12436, 12438, 12448, 12453, 12478, 12510, 12523, 12556,
       12557, 12658, 12665, 12688, 12699, 12715, 12721, 12728, 12749,
       12759, 12823, 12845, 12916, 12974, 12980, 12984, 12986, 13051,
       13072, 13077, 13099, 13102, 13120, 13129, 13134, 13159, 13160,
       13174, 13190, 13235, 13248, 13260, 13271, 13277, 13292, 13296,
       13320, 13337, 13352, 13382, 13387, 13388, 13399, 13409, 13444,
       13462, 13478, 13489, 13519, 13528, 13545, 13597, 13601, 13615,
       13625, 13651, 13677, 13685, 13698, 13707, 13717, 13724, 13734,
       13795, 13817, 13841, 13861, 13875, 13890, 13911, 13976, 13990,
       13991, 13996, 13999, 14052, 14079, 14121, 14164, 14174, 14183,
       14220, 14226, 14235, 14258, 14261, 14295, 14325, 14327, 14339,
       14371, 14412, 14421, 14447, 14459, 14461, 14506, 14508, 14520,
       14534, 14559, 14578, 14579, 14593, 14596, 14604, 14634, 14675,
       14708, 14761, 14780, 14812, 14848, 14854, 14865, 14877, 14898,
       14950, 14970, 14983, 14997, 15005, 15084, 15090, 15093, 15110,
       15111, 15141, 15156, 15161, 15166, 15182, 15194, 15229, 15240,
       15257, 15258, 15295, 15324, 15340, 15402, 15424, 15443, 15447,
       15454, 15474, 15575, 15592, 15613, 15626, 15642, 15674, 15678,
       15712, 15731, 15752, 15774, 15807, 15876, 15912, 15914, 15915,
       15932, 15963, 15969, 15973, 15995, 16032, 16054, 16058, 16086,
       16138, 16191, 16202, 16206, 16251, 16259, 16292, 16436, 16467,
       16474, 16507, 16515, 16521]),)
(16522, 16522)
(15726, 16522)
(15726, 15726)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2593917846679688s
The HC Re-cluster result: num cluster = 1445(model) // 1387(model_ema) 	 num outliers = 796(model) // 945(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=2.7446367740631104s
The UCIS result: num clean cluster = 1396(model) 	 num outliers = 1605(model)
mdoel:new class are [1397], length of new dataset is 14917
Epoch: [10][0/300]	Time 0.812 (0.812)	Data 0.138 (0.138)	Loss_ce_clean 0.044 	Loss_ct_clean 0.040 	Prec 100.00%
Epoch: [10][50/300]	Time 0.772 (0.784)	Data 0.103 (0.115)	Loss_ce_clean 0.098 	Loss_ct_clean 0.106 	Prec 98.77%
Epoch: [10][100/300]	Time 0.773 (0.781)	Data 0.104 (0.111)	Loss_ce_clean 0.094 	Loss_ct_clean 0.217 	Prec 98.88%
Epoch: [10][150/300]	Time 0.773 (0.780)	Data 0.104 (0.110)	Loss_ce_clean 0.093 	Loss_ct_clean 0.247 	Prec 98.93%
Epoch: [10][200/300]	Time 0.771 (0.778)	Data 0.101 (0.108)	Loss_ce_clean 0.093 	Loss_ct_clean 0.259 	Prec 98.96%
Epoch: [10][250/300]	Time 0.774 (0.778)	Data 0.104 (0.108)	Loss_ce_clean 0.093 	Loss_ct_clean 0.267 	Prec 98.97%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.164 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.76387906074524
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.164)	Data 0.000 (0.010)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.806622982025146
The orignal cluster result: num cluster = 1451(model) // 1407(model_ema) 	 num outliers = 692(model) // 851(model_ema)
Applying hierarchical clustering
[ 921 1348  176 ... 1270 1154 1301]
(16522,)
(array([   66,    75,    85,    97,   104,   112,   188,   197,   207,
         213,   220,   241,   338,   341,   383,   394,   400,   412,
         423,   437,   443,   445,   460,   464,   495,   519,   530,
         588,   637,   643,   672,   676,   677,   752,   770,   771,
         779,   799,   808,   827,   832,   851,   853,   854,   861,
         911,   965,   987,   997,  1037,  1063,  1098,  1197,  1205,
        1228,  1263,  1359,  1396,  1402,  1413,  1417,  1473,  1494,
        1520,  1528,  1573,  1587,  1631,  1634,  1654,  1672,  1676,
        1685,  1735,  1741,  1746,  1750,  1780,  1783,  1794,  1833,
        1854,  1856,  1871,  1931,  1983,  1998,  2039,  2119,  2147,
        2148,  2182,  2185,  2205,  2236,  2244,  2282,  2332,  2406,
        2431,  2438,  2441,  2447,  2465,  2486,  2494,  2501,  2505,
        2564,  2612,  2680,  2684,  2703,  2725,  2754,  2758,  2769,
        2770,  2783,  2794,  2796,  2799,  2818,  2819,  2850,  2871,
        2876,  2903,  2913,  2947,  2986,  3015,  3027,  3030,  3036,
        3037,  3050,  3105,  3117,  3121,  3126,  3129,  3142,  3143,
        3157,  3178,  3180,  3202,  3280,  3330,  3334,  3434,  3448,
        3454,  3480,  3544,  3570,  3575,  3615,  3650,  3685,  3728,
        3764,  3774,  3794,  3815,  3851,  3906,  3908,  3933,  3951,
        4060,  4061,  4105,  4106,  4143,  4156,  4161,  4209,  4221,
        4242,  4248,  4251,  4319,  4321,  4334,  4393,  4410,  4428,
        4429,  4438,  4484,  4487,  4496,  4499,  4523,  4539,  4566,
        4609,  4614,  4632,  4637,  4638,  4651,  4682,  4685,  4695,
        4738,  4747,  4751,  4777,  4848,  4899,  4902,  4914,  4921,
        4939,  5008,  5023,  5084,  5094,  5107,  5129,  5141,  5144,
        5148,  5180,  5184,  5215,  5220,  5232,  5265,  5267,  5280,
        5297,  5298,  5303,  5320,  5332,  5361,  5418,  5445,  5542,
        5558,  5577,  5578,  5583,  5589,  5602,  5603,  5659,  5669,
        5710,  5712,  5750,  5763,  5795,  5812,  5816,  5849,  5852,
        5872,  6004,  6060,  6067,  6082,  6111,  6128,  6132,  6222,
        6253,  6296,  6301,  6316,  6319,  6366,  6442,  6447,  6448,
        6450,  6467,  6491,  6556,  6568,  6593,  6629,  6658,  6666,
        6758,  6761,  6825,  6826,  6859,  6860,  6874,  6876,  6898,
        6934,  6956,  7110,  7145,  7168,  7181,  7307,  7362,  7382,
        7387,  7389,  7425,  7457,  7473,  7506,  7513,  7515,  7528,
        7538,  7560,  7565,  7612,  7625,  7630,  7632,  7655,  7722,
        7746,  7752,  7765,  7796,  7805,  7814,  7831,  7919,  7928,
        7957,  7980,  7981,  7992,  8046,  8059,  8101,  8186,  8215,
        8227,  8237,  8263,  8270,  8285,  8299,  8319,  8340,  8471,
        8497,  8510,  8525,  8548,  8568,  8576,  8577,  8579,  8688,
        8705,  8746,  8778,  8780,  8787,  8821,  8847,  8880,  8884,
        8893,  8909,  8926,  8931,  8936,  8973,  9005,  9029,  9039,
        9057,  9064,  9081,  9107,  9136,  9154,  9159,  9250,  9282,
        9328,  9354,  9365,  9398,  9399,  9416,  9471,  9485,  9497,
        9504,  9528,  9529,  9535,  9539,  9554,  9562,  9590,  9600,
        9645,  9675,  9676,  9696,  9746,  9752,  9759,  9782,  9792,
        9794,  9808,  9810,  9819,  9835,  9854,  9930,  9936,  9941,
        9944,  9961,  9963,  9988, 10007, 10015, 10033, 10034, 10035,
       10052, 10058, 10060, 10070, 10076, 10078, 10105, 10125, 10149,
       10188, 10215, 10271, 10275, 10306, 10337, 10350, 10357, 10369,
       10435, 10445, 10453, 10460, 10479, 10482, 10493, 10507, 10540,
       10589, 10593, 10604, 10608, 10629, 10640, 10665, 10701, 10716,
       10750, 10762, 10770, 10794, 10821, 10825, 10846, 10854, 10877,
       10923, 10932, 10933, 10973, 10991, 11059, 11090, 11092, 11112,
       11116, 11132, 11172, 11194, 11195, 11203, 11224, 11274, 11297,
       11317, 11324, 11420, 11472, 11553, 11555, 11579, 11606, 11610,
       11681, 11693, 11701, 11749, 11827, 11830, 11845, 11849, 11896,
       11900, 11905, 11912, 11929, 11939, 11972, 12031, 12044, 12090,
       12123, 12138, 12154, 12184, 12226, 12231, 12234, 12283, 12339,
       12412, 12414, 12426, 12448, 12453, 12458, 12478, 12510, 12550,
       12557, 12661, 12665, 12681, 12699, 12715, 12721, 12749, 12759,
       12806, 12833, 12845, 12949, 12974, 12980, 13051, 13072, 13120,
       13132, 13160, 13235, 13242, 13248, 13260, 13271, 13277, 13292,
       13300, 13320, 13337, 13352, 13382, 13388, 13409, 13441, 13444,
       13462, 13489, 13528, 13545, 13597, 13601, 13606, 13615, 13619,
       13680, 13717, 13724, 13728, 13731, 13795, 13875, 13890, 13893,
       13894, 13911, 13976, 13991, 13999, 14052, 14079, 14121, 14154,
       14164, 14174, 14220, 14222, 14235, 14255, 14278, 14295, 14301,
       14325, 14339, 14368, 14371, 14447, 14448, 14459, 14461, 14506,
       14520, 14534, 14559, 14567, 14578, 14579, 14623, 14634, 14675,
       14756, 14836, 14854, 14865, 14877, 14898, 14950, 14970, 14983,
       15005, 15090, 15141, 15156, 15161, 15166, 15182, 15229, 15257,
       15258, 15292, 15303, 15324, 15340, 15402, 15424, 15432, 15443,
       15447, 15484, 15575, 15592, 15613, 15669, 15674, 15731, 15752,
       15807, 15912, 15969, 15978, 15995, 16058, 16086, 16133, 16138,
       16148, 16151, 16174, 16191, 16202, 16211, 16225, 16235, 16238,
       16240, 16251, 16259, 16292, 16467, 16474, 16507, 16515]),)
(16522, 16522)
(15830, 16522)
(15830, 15830)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1205520629882812s
The HC Re-cluster result: num cluster = 1451(model) // 1407(model_ema) 	 num outliers = 692(model) // 851(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8570706844329834s
The UCIS result: num clean cluster = 1412(model) 	 num outliers = 1475(model)
mdoel:new class are [1413], length of new dataset is 15047
Epoch: [11][0/300]	Time 0.793 (0.793)	Data 0.118 (0.118)	Loss_ce_clean 0.045 	Loss_ct_clean 0.043 	Prec 99.22%
Epoch: [11][50/300]	Time 0.773 (0.775)	Data 0.104 (0.105)	Loss_ce_clean 0.087 	Loss_ct_clean 0.099 	Prec 98.91%
Epoch: [11][100/300]	Time 0.775 (0.775)	Data 0.104 (0.105)	Loss_ce_clean 0.084 	Loss_ct_clean 0.190 	Prec 98.91%
Epoch: [11][150/300]	Time 0.772 (0.774)	Data 0.102 (0.104)	Loss_ce_clean 0.084 	Loss_ct_clean 0.225 	Prec 99.01%
Epoch: [11][200/300]	Time 0.775 (0.774)	Data 0.104 (0.104)	Loss_ce_clean 0.085 	Loss_ct_clean 0.241 	Prec 98.99%
Epoch: [11][250/300]	Time 0.772 (0.774)	Data 0.103 (0.104)	Loss_ce_clean 0.085 	Loss_ct_clean 0.249 	Prec 99.00%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.741196870803833
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.721735715866089
The orignal cluster result: num cluster = 1463(model) // 1432(model_ema) 	 num outliers = 621(model) // 758(model_ema)
Applying hierarchical clustering
[ 888  994  105 ... 1383 1085 1434]
(16522,)
(array([   75,    85,    97,   104,   112,   182,   188,   197,   207,
         241,   269,   277,   338,   394,   400,   422,   423,   437,
         443,   445,   460,   464,   530,   563,   580,   588,   637,
         643,   676,   677,   714,   743,   770,   771,   779,   799,
         827,   851,   853,   861,   911,   965,   987,   997,  1037,
        1059,  1063,  1098,  1197,  1205,  1263,  1359,  1396,  1402,
        1430,  1460,  1473,  1494,  1520,  1526,  1528,  1573,  1587,
        1631,  1685,  1723,  1735,  1746,  1750,  1783,  1819,  1833,
        1854,  1931,  1944,  1984,  1998,  2017,  2039,  2130,  2147,
        2148,  2170,  2182,  2205,  2241,  2282,  2297,  2299,  2332,
        2374,  2406,  2431,  2438,  2441,  2447,  2465,  2501,  2505,
        2656,  2680,  2684,  2703,  2725,  2758,  2769,  2770,  2783,
        2794,  2796,  2814,  2818,  2819,  2850,  2871,  2880,  2889,
        2986,  3027,  3036,  3037,  3050,  3073,  3117,  3121,  3126,
        3142,  3143,  3157,  3180,  3202,  3223,  3273,  3280,  3330,
        3334,  3434,  3448,  3473,  3480,  3544,  3570,  3575,  3641,
        3716,  3728,  3764,  3794,  3812,  3815,  3851,  3906,  3908,
        3933,  3947,  3958,  4061,  4065,  4105,  4106,  4143,  4209,
        4221,  4251,  4321,  4410,  4428,  4429,  4433,  4487,  4496,
        4499,  4539,  4566,  4614,  4628,  4632,  4637,  4638,  4682,
        4747,  4764,  4777,  4861,  4902,  4914,  4920,  5003,  5035,
        5053,  5082,  5084,  5094,  5129,  5141,  5148,  5184,  5215,
        5220,  5239,  5265,  5267,  5280,  5320,  5332,  5361,  5412,
        5418,  5445,  5526,  5542,  5567,  5577,  5578,  5583,  5585,
        5589,  5603,  5637,  5669,  5712,  5750,  5763,  5795,  5812,
        5816,  5838,  5848,  5849,  5872,  5894,  5949,  5995,  6060,
        6067,  6082,  6095,  6111,  6128,  6132,  6208,  6253,  6296,
        6301,  6316,  6319,  6366,  6389,  6429,  6447,  6448,  6450,
        6451,  6467,  6491,  6556,  6573,  6593,  6629,  6658,  6744,
        6758,  6761,  6818,  6820,  6822,  6825,  6826,  6827,  6860,
        6874,  6876,  6898,  6934,  6946,  6956,  6965,  7110,  7111,
        7145,  7206,  7307,  7323,  7382,  7387,  7389,  7457,  7506,
        7515,  7528,  7538,  7560,  7564,  7565,  7625,  7682,  7685,
        7722,  7746,  7752,  7765,  7796,  7805,  7882,  7919,  7928,
        7980,  7981,  8059,  8064,  8101,  8186,  8215,  8237,  8270,
        8285,  8319,  8340,  8373,  8381,  8392,  8471,  8510,  8525,
        8527,  8557,  8576,  8579,  8638,  8688,  8705,  8746,  8753,
        8778,  8780,  8787,  8799,  8821,  8880,  8884,  8893,  8909,
        8926,  8931,  8966,  9039,  9057,  9059,  9064,  9081,  9107,
        9136,  9154,  9159,  9184,  9276,  9282,  9354,  9365,  9398,
        9399,  9471,  9485,  9497,  9504,  9539,  9562,  9600,  9645,
        9676,  9733,  9746,  9751,  9752,  9759,  9782,  9792,  9794,
        9810,  9835,  9838,  9897,  9936,  9939,  9941,  9944,  9988,
       10007, 10033, 10034, 10035, 10047, 10052, 10057, 10060, 10070,
       10076, 10077, 10101, 10105, 10149, 10181, 10205, 10215, 10306,
       10337, 10350, 10368, 10369, 10435, 10445, 10479, 10482, 10493,
       10540, 10561, 10589, 10593, 10604, 10608, 10629, 10642, 10693,
       10701, 10716, 10750, 10770, 10784, 10794, 10825, 10877, 10923,
       10932, 10970, 10973, 11092, 11112, 11116, 11117, 11132, 11194,
       11195, 11224, 11297, 11317, 11324, 11415, 11420, 11514, 11553,
       11579, 11610, 11674, 11681, 11686, 11693, 11701, 11723, 11798,
       11827, 11845, 11849, 11912, 11929, 11939, 11972, 12031, 12044,
       12079, 12090, 12154, 12226, 12231, 12234, 12340, 12394, 12412,
       12414, 12434, 12438, 12448, 12458, 12510, 12557, 12576, 12661,
       12665, 12699, 12715, 12721, 12749, 12759, 12806, 12823, 12845,
       12916, 12974, 12980, 13051, 13077, 13120, 13159, 13160, 13190,
       13213, 13224, 13235, 13238, 13242, 13248, 13260, 13271, 13277,
       13292, 13300, 13320, 13337, 13352, 13382, 13387, 13388, 13409,
       13441, 13444, 13462, 13489, 13511, 13519, 13528, 13601, 13615,
       13677, 13680, 13717, 13724, 13728, 13875, 13911, 13941, 13976,
       13991, 13999, 14052, 14079, 14121, 14154, 14164, 14174, 14183,
       14220, 14255, 14278, 14295, 14301, 14325, 14361, 14368, 14371,
       14447, 14459, 14461, 14506, 14539, 14559, 14578, 14579, 14593,
       14623, 14634, 14756, 14865, 14877, 14898, 15005, 15006, 15084,
       15090, 15121, 15141, 15156, 15161, 15188, 15197, 15200, 15303,
       15340, 15424, 15432, 15443, 15454, 15484, 15575, 15592, 15613,
       15642, 15712, 15731, 15752, 15807, 15932, 15963, 15969, 15978,
       15995, 15998, 16058, 16086, 16138, 16148, 16174, 16202, 16211,
       16238, 16251, 16259, 16292, 16334, 16467, 16505, 16507, 16515]),)
(16522, 16522)
(15901, 16522)
(15901, 15901)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.139335870742798s
The HC Re-cluster result: num cluster = 1463(model) // 1432(model_ema) 	 num outliers = 621(model) // 758(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8494324684143066s
The UCIS result: num clean cluster = 1426(model) 	 num outliers = 1342(model)
mdoel:new class are [1427], length of new dataset is 15180
Epoch: [12][0/300]	Time 0.800 (0.800)	Data 0.126 (0.126)	Loss_ce_clean 0.097 	Loss_ct_clean 0.095 	Prec 98.44%
Epoch: [12][50/300]	Time 0.776 (0.775)	Data 0.107 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.092 	Prec 98.96%
Epoch: [12][100/300]	Time 0.774 (0.774)	Data 0.105 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.186 	Prec 98.97%
Epoch: [12][150/300]	Time 0.773 (0.774)	Data 0.103 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.222 	Prec 99.02%
Epoch: [12][200/300]	Time 0.781 (0.774)	Data 0.111 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.237 	Prec 99.07%
Epoch: [12][250/300]	Time 0.774 (0.774)	Data 0.104 (0.105)	Loss_ce_clean 0.083 	Loss_ct_clean 0.244 	Prec 99.07%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.821177959442139
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.70072889328003
The orignal cluster result: num cluster = 1487(model) // 1447(model_ema) 	 num outliers = 532(model) // 724(model_ema)
Applying hierarchical clustering
[1028 1362  271 ... 1333 1241 1403]
(16522,)
(array([   72,    83,    85,    97,   104,   112,   182,   188,   197,
         213,   220,   241,   269,   277,   383,   394,   400,   417,
         422,   443,   460,   481,   506,   519,   580,   588,   637,
         672,   676,   677,   714,   715,   752,   754,   798,   799,
         827,   851,   854,   861,   965,   987,   997,  1001,  1037,
        1059,  1063,  1098,  1197,  1209,  1246,  1359,  1402,  1460,
        1473,  1520,  1526,  1528,  1573,  1631,  1685,  1723,  1735,
        1783,  1833,  1835,  1854,  1871,  1998,  2017,  2039,  2119,
        2147,  2148,  2170,  2205,  2236,  2241,  2282,  2330,  2374,
        2406,  2431,  2441,  2447,  2465,  2494,  2501,  2505,  2575,
        2584,  2586,  2612,  2684,  2703,  2725,  2758,  2769,  2783,
        2796,  2814,  2818,  2871,  2876,  2883,  2913,  2947,  2986,
        3015,  3027,  3036,  3037,  3073,  3117,  3129,  3142,  3157,
        3178,  3180,  3223,  3226,  3271,  3280,  3311,  3330,  3434,
        3448,  3540,  3553,  3570,  3575,  3615,  3641,  3685,  3708,
        3716,  3764,  3774,  3794,  3815,  3873,  3889,  3906,  3908,
        3933,  3972,  4022,  4143,  4221,  4247,  4251,  4257,  4393,
        4410,  4428,  4429,  4433,  4487,  4496,  4499,  4539,  4566,
        4609,  4614,  4632,  4637,  4638,  4651,  4777,  4849,  4902,
        4914,  5003,  5023,  5082,  5129,  5141,  5184,  5215,  5232,
        5239,  5265,  5267,  5279,  5280,  5332,  5361,  5418,  5567,
        5577,  5578,  5583,  5589,  5603,  5763,  5795,  5812,  5848,
        5995,  6082,  6095,  6132,  6144,  6239,  6296,  6301,  6316,
        6389,  6442,  6447,  6448,  6451,  6491,  6556,  6568,  6573,
        6593,  6629,  6761,  6818,  6822,  6825,  6826,  6827,  6859,
        6860,  6876,  6898,  6957,  7111,  7145,  7181,  7188,  7206,
        7354,  7362,  7387,  7389,  7457,  7506,  7513,  7515,  7528,
        7560,  7565,  7604,  7725,  7765,  7796,  7814,  7831,  7919,
        7928,  7980,  7981,  8059,  8063,  8101,  8114,  8134,  8186,
        8215,  8237,  8263,  8285,  8319,  8340,  8373,  8381,  8471,
        8487,  8497,  8525,  8576,  8577,  8579,  8584,  8688,  8705,
        8721,  8746,  8778,  8780,  8787,  8799,  8880,  8893,  8907,
        8909,  8926,  8931,  8966,  9005,  9044,  9057,  9081,  9107,
        9126,  9154,  9159,  9226,  9237,  9282,  9399,  9471,  9485,
        9487,  9497,  9504,  9535,  9590,  9600,  9631,  9645,  9675,
        9720,  9752,  9759,  9782,  9794,  9810,  9835,  9838,  9897,
        9939,  9941,  9944,  9961,  9988, 10007, 10015, 10047, 10057,
       10070, 10076, 10149, 10205, 10215, 10435, 10453, 10460, 10482,
       10493, 10507, 10589, 10593, 10627, 10640, 10642, 10762, 10770,
       10794, 10825, 10854, 10923, 10946, 10973, 11004, 11059, 11092,
       11112, 11116, 11132, 11224, 11274, 11317, 11324, 11354, 11420,
       11514, 11553, 11610, 11634, 11674, 11686, 11693, 11723, 11767,
       11827, 11905, 11972, 12031, 12044, 12079, 12090, 12154, 12226,
       12234, 12375, 12394, 12412, 12414, 12434, 12448, 12453, 12474,
       12478, 12510, 12550, 12557, 12643, 12655, 12661, 12681, 12688,
       12699, 12715, 12721, 12749, 12759, 12875, 12980, 12984, 13035,
       13051, 13077, 13113, 13120, 13129, 13160, 13190, 13200, 13213,
       13224, 13229, 13235, 13248, 13260, 13277, 13292, 13300, 13320,
       13388, 13409, 13441, 13444, 13462, 13489, 13511, 13519, 13528,
       13545, 13558, 13597, 13601, 13606, 13625, 13651, 13724, 13795,
       13875, 13890, 13911, 13976, 13991, 14052, 14079, 14164, 14174,
       14220, 14222, 14235, 14261, 14278, 14295, 14325, 14339, 14368,
       14371, 14425, 14431, 14447, 14459, 14461, 14508, 14559, 14578,
       14591, 14593, 14623, 14634, 14756, 14865, 14898, 14909, 14950,
       14970, 15005, 15090, 15121, 15141, 15156, 15161, 15166, 15197,
       15200, 15257, 15287, 15324, 15340, 15402, 15424, 15432, 15443,
       15447, 15454, 15484, 15575, 15592, 15608, 15653, 15731, 15851,
       15869, 15914, 15969, 15978, 15998, 16058, 16086, 16138, 16174,
       16191, 16202, 16238, 16240, 16292, 16334, 16436, 16467, 16474,
       16507]),)
(16522, 16522)
(15990, 16522)
(15990, 15990)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.124793291091919s
The HC Re-cluster result: num cluster = 1487(model) // 1447(model_ema) 	 num outliers = 532(model) // 724(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8454768657684326s
The UCIS result: num clean cluster = 1455(model) 	 num outliers = 1133(model)
mdoel:new class are [1456], length of new dataset is 15389
Epoch: [13][0/300]	Time 0.792 (0.792)	Data 0.119 (0.119)	Loss_ce_clean 0.021 	Loss_ct_clean 0.019 	Prec 100.00%
Epoch: [13][50/300]	Time 0.779 (0.775)	Data 0.110 (0.105)	Loss_ce_clean 0.083 	Loss_ct_clean 0.090 	Prec 98.88%
Epoch: [13][100/300]	Time 0.774 (0.775)	Data 0.103 (0.105)	Loss_ce_clean 0.083 	Loss_ct_clean 0.186 	Prec 98.93%
Epoch: [13][150/300]	Time 0.771 (0.774)	Data 0.102 (0.105)	Loss_ce_clean 0.083 	Loss_ct_clean 0.218 	Prec 98.98%
Epoch: [13][200/300]	Time 0.775 (0.774)	Data 0.105 (0.105)	Loss_ce_clean 0.082 	Loss_ct_clean 0.229 	Prec 99.00%
Epoch: [13][250/300]	Time 0.776 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.081 	Loss_ct_clean 0.234 	Prec 99.04%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.752176284790039
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.641160488128662
The orignal cluster result: num cluster = 1493(model) // 1464(model_ema) 	 num outliers = 551(model) // 642(model_ema)
Applying hierarchical clustering
[ 518 1295  320 ... 1432 1344 1372]
(16522,)
(array([    6,    72,    85,    97,   104,   112,   182,   188,   220,
         241,   269,   383,   394,   412,   417,   422,   437,   443,
         445,   460,   481,   588,   637,   672,   676,   677,   689,
         714,   715,   752,   755,   808,   832,   854,   861,   874,
         911,   965,   987,   997,  1001,  1037,  1057,  1063,  1082,
        1097,  1098,  1140,  1197,  1203,  1246,  1262,  1396,  1402,
        1460,  1473,  1520,  1573,  1613,  1631,  1675,  1723,  1735,
        1746,  1833,  1835,  1938,  1998,  2039,  2147,  2148,  2170,
        2205,  2241,  2282,  2299,  2307,  2431,  2465,  2501,  2505,
        2564,  2575,  2584,  2612,  2636,  2680,  2694,  2703,  2717,
        2725,  2769,  2783,  2794,  2796,  2814,  2818,  2835,  2871,
        2876,  2935,  2986,  3027,  3037,  3050,  3059,  3073,  3117,
        3126,  3129,  3142,  3157,  3178,  3180,  3202,  3208,  3219,
        3223,  3249,  3264,  3271,  3280,  3304,  3311,  3330,  3388,
        3434,  3448,  3480,  3540,  3570,  3575,  3641,  3685,  3695,
        3716,  3720,  3728,  3764,  3794,  3815,  3873,  3908,  3933,
        3947,  3961,  4106,  4143,  4209,  4221,  4242,  4251,  4257,
        4321,  4332,  4393,  4410,  4429,  4433,  4496,  4498,  4539,
        4563,  4566,  4614,  4637,  4651,  4682,  4747,  4764,  4777,
        4798,  4902,  4914,  4939,  5082,  5084,  5184,  5239,  5255,
        5265,  5267,  5279,  5280,  5317,  5332,  5361,  5362,  5386,
        5410,  5418,  5534,  5542,  5567,  5577,  5578,  5583,  5603,
        5710,  5750,  5795,  5816,  5894,  5913,  6067,  6082,  6111,
        6132,  6144,  6239,  6296,  6301,  6316,  6319,  6389,  6448,
        6467,  6556,  6593,  6629,  6632,  6658,  6744,  6761,  6818,
        6820,  6825,  6859,  6860,  6898,  6957,  6965,  7110,  7145,
        7162,  7176,  7181,  7259,  7354,  7362,  7378,  7382,  7387,
        7389,  7440,  7446,  7457,  7506,  7513,  7515,  7516,  7528,
        7538,  7560,  7564,  7565,  7632,  7722,  7765,  7772,  7796,
        7928,  7980,  7981,  7985,  8059,  8063,  8101,  8215,  8227,
        8237,  8285,  8340,  8373,  8381,  8471,  8491,  8510,  8525,
        8576,  8577,  8579,  8594,  8609,  8688,  8705,  8746,  8778,
        8780,  8799,  8818,  8880,  8884,  8893,  8909,  8926,  8931,
        9057,  9059,  9081,  9136,  9159,  9226,  9282,  9308,  9328,
        9354,  9398,  9471,  9485,  9497,  9504,  9535,  9539,  9554,
        9562,  9600,  9645,  9675,  9699,  9720,  9728,  9746,  9752,
        9759,  9782,  9792,  9835,  9838,  9854,  9936,  9941,  9944,
        9961,  9978,  9988, 10007, 10047, 10052, 10058, 10070, 10149,
       10154, 10177, 10205, 10215, 10254, 10306, 10369, 10384, 10408,
       10425, 10435, 10445, 10453, 10460, 10465, 10482, 10540, 10556,
       10589, 10593, 10604, 10665, 10701, 10749, 10750, 10762, 10770,
       10794, 10804, 10821, 10825, 10846, 10854, 10877, 10933, 10946,
       10973, 10991, 11004, 11059, 11106, 11112, 11116, 11194, 11195,
       11224, 11274, 11297, 11317, 11324, 11354, 11407, 11415, 11420,
       11463, 11472, 11610, 11674, 11693, 11701, 11827, 11900, 11912,
       11939, 11972, 12031, 12073, 12154, 12208, 12226, 12231, 12234,
       12394, 12412, 12414, 12434, 12453, 12510, 12550, 12557, 12605,
       12655, 12658, 12688, 12699, 12703, 12715, 12721, 12749, 12759,
       12876, 12916, 12974, 12980, 12984, 13051, 13099, 13102, 13113,
       13120, 13129, 13160, 13190, 13213, 13224, 13229, 13235, 13242,
       13248, 13260, 13277, 13292, 13300, 13320, 13382, 13387, 13388,
       13409, 13441, 13444, 13489, 13528, 13545, 13597, 13601, 13606,
       13615, 13651, 13680, 13707, 13724, 13734, 13841, 13861, 13875,
       13890, 13911, 13976, 13991, 14052, 14079, 14112, 14135, 14164,
       14174, 14220, 14222, 14235, 14255, 14266, 14278, 14295, 14314,
       14327, 14339, 14371, 14429, 14447, 14459, 14461, 14508, 14534,
       14578, 14579, 14634, 14756, 14865, 14898, 14909, 14970, 15005,
       15006, 15068, 15090, 15156, 15161, 15197, 15229, 15257, 15297,
       15340, 15402, 15424, 15484, 15575, 15592, 15653, 15731, 15752,
       15807, 15851, 15912, 15914, 15969, 15978, 15998, 16023, 16058,
       16086, 16138, 16174, 16191, 16202, 16240, 16251, 16334, 16467,
       16507, 16515]),)
(16522, 16522)
(15971, 16522)
(15971, 15971)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.143733024597168s
The HC Re-cluster result: num cluster = 1493(model) // 1464(model_ema) 	 num outliers = 551(model) // 642(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8379044532775879s
The UCIS result: num clean cluster = 1465(model) 	 num outliers = 1109(model)
mdoel:new class are [1466], length of new dataset is 15413
Epoch: [14][0/300]	Time 0.797 (0.797)	Data 0.123 (0.123)	Loss_ce_clean 0.064 	Loss_ct_clean 0.064 	Prec 97.66%
Epoch: [14][50/300]	Time 0.774 (0.775)	Data 0.105 (0.105)	Loss_ce_clean 0.080 	Loss_ct_clean 0.085 	Prec 98.93%
Epoch: [14][100/300]	Time 0.775 (0.774)	Data 0.105 (0.105)	Loss_ce_clean 0.081 	Loss_ct_clean 0.184 	Prec 98.85%
Epoch: [14][150/300]	Time 0.778 (0.774)	Data 0.104 (0.105)	Loss_ce_clean 0.078 	Loss_ct_clean 0.209 	Prec 98.96%
Epoch: [14][200/300]	Time 0.775 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.079 	Loss_ct_clean 0.221 	Prec 99.00%
Epoch: [14][250/300]	Time 0.778 (0.774)	Data 0.108 (0.105)	Loss_ce_clean 0.078 	Loss_ct_clean 0.228 	Prec 99.06%
Extract Features: [100/156]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Mean AP: 49.6%
CMC Scores:
  top-1          67.1%
  top-5          79.6%
  top-10         83.9%
Extract Features: [100/156]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Mean AP: 53.2%
CMC Scores:
  top-1          70.2%
  top-5          81.2%
  top-10         85.3%

 * Finished epoch  14  model no.1 mAP: 49.6% model no.2(mean-net) mAP: 53.2%  best: 53.9%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.154 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.681232929229736
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.719706773757935
The orignal cluster result: num cluster = 1511(model) // 1480(model_ema) 	 num outliers = 488(model) // 589(model_ema)
Applying hierarchical clustering
[ 721 1164  403 ... 1476  910 1371]
(16522,)
(array([   75,    85,   112,   182,   188,   197,   213,   241,   269,
         376,   383,   394,   412,   422,   443,   460,   481,   519,
         530,   588,   637,   643,   677,   689,   714,   752,   759,
         799,   808,   851,   854,   861,   907,   965,   987,  1037,
        1053,  1059,  1082,  1097,  1098,  1246,  1263,  1359,  1402,
        1408,  1413,  1460,  1473,  1528,  1587,  1605,  1685,  1735,
        1746,  1833,  1871,  1878,  1912,  1998,  2085,  2108,  2119,
        2170,  2182,  2205,  2228,  2236,  2241,  2299,  2307,  2330,
        2374,  2403,  2406,  2431,  2438,  2441,  2465,  2494,  2501,
        2505,  2584,  2585,  2612,  2684,  2694,  2703,  2758,  2794,
        2796,  2814,  2818,  2871,  2876,  2913,  2922,  2947,  3015,
        3027,  3030,  3036,  3037,  3050,  3052,  3059,  3073,  3117,
        3126,  3129,  3157,  3178,  3202,  3223,  3271,  3280,  3304,
        3309,  3330,  3434,  3448,  3480,  3570,  3575,  3615,  3685,
        3695,  3720,  3728,  3774,  3794,  3815,  3873,  3933,  3958,
        4105,  4106,  4143,  4221,  4242,  4247,  4251,  4321,  4400,
        4409,  4410,  4428,  4429,  4433,  4487,  4496,  4498,  4499,
        4533,  4539,  4566,  4614,  4637,  4651,  4682,  4747,  4764,
        4902,  4939,  5023,  5082,  5084,  5232,  5239,  5265,  5267,
        5277,  5280,  5317,  5361,  5418,  5559,  5567,  5577,  5583,
        5603,  5669,  5712,  5795,  5812,  5913,  5949,  6067,  6082,
        6128,  6144,  6296,  6319,  6448,  6466,  6467,  6491,  6556,
        6593,  6629,  6632,  6658,  6696,  6738,  6747,  6761,  6818,
        6820,  6825,  6874,  6876,  6898,  6957,  7110,  7145,  7162,
        7176,  7188,  7206,  7362,  7389,  7440,  7446,  7457,  7506,
        7513,  7528,  7538,  7565,  7573,  7589,  7597,  7632,  7722,
        7752,  7765,  7796,  7814,  7980,  7981,  8044,  8059,  8160,
        8237,  8263,  8285,  8319,  8340,  8471,  8525,  8609,  8705,
        8746,  8778,  8787,  8818,  8880,  8893,  8931,  9025,  9081,
        9085,  9107,  9126,  9159,  9282,  9398,  9471,  9485,  9497,
        9504,  9535,  9539,  9554,  9562,  9693,  9752,  9782,  9792,
        9835,  9838,  9897,  9939,  9941,  9944,  9961,  9988, 10007,
       10047, 10052, 10058, 10070, 10076, 10077, 10140, 10154, 10177,
       10215, 10245, 10306, 10337, 10408, 10435, 10445, 10453, 10460,
       10482, 10507, 10540, 10561, 10589, 10593, 10640, 10665, 10697,
       10750, 10770, 10780, 10794, 10821, 10825, 10877, 10933, 10946,
       10973, 10983, 10991, 11059, 11092, 11112, 11132, 11195, 11224,
       11262, 11274, 11291, 11297, 11317, 11324, 11354, 11420, 11472,
       11514, 11610, 11674, 11681, 11693, 11698, 11798, 11827, 11912,
       11939, 12031, 12073, 12154, 12208, 12226, 12231, 12234, 12277,
       12412, 12423, 12453, 12478, 12510, 12550, 12557, 12655, 12688,
       12715, 12721, 12749, 12759, 12876, 12879, 12980, 13035, 13051,
       13099, 13102, 13113, 13120, 13159, 13160, 13190, 13235, 13239,
       13242, 13248, 13260, 13292, 13296, 13300, 13320, 13337, 13352,
       13382, 13388, 13409, 13441, 13489, 13545, 13597, 13601, 13606,
       13615, 13625, 13651, 13680, 13707, 13724, 13734, 13795, 13841,
       13866, 13911, 13940, 13976, 13991, 14052, 14079, 14112, 14124,
       14174, 14202, 14220, 14278, 14314, 14327, 14339, 14447, 14459,
       14461, 14506, 14534, 14579, 14634, 14675, 14692, 14857, 14898,
       14950, 14970, 15005, 15076, 15090, 15121, 15141, 15161, 15170,
       15182, 15197, 15240, 15257, 15287, 15340, 15402, 15432, 15451,
       15484, 15592, 15608, 15613, 15731, 15752, 15807, 15851, 15912,
       15978, 16029, 16058, 16086, 16138, 16148, 16202, 16238, 16240,
       16251, 16276, 16290, 16292, 16300, 16436, 16461, 16467, 16474,
       16507, 16515]),)
(16522, 16522)
(16034, 16522)
(16034, 16034)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1859078407287598s
The HC Re-cluster result: num cluster = 1511(model) // 1480(model_ema) 	 num outliers = 488(model) // 589(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8383557796478271s
The UCIS result: num clean cluster = 1481(model) 	 num outliers = 1023(model)
mdoel:new class are [1482], length of new dataset is 15499
Epoch: [15][0/300]	Time 0.797 (0.797)	Data 0.122 (0.122)	Loss_ce_clean 0.029 	Loss_ct_clean 0.027 	Prec 100.00%
Epoch: [15][50/300]	Time 0.782 (0.775)	Data 0.113 (0.106)	Loss_ce_clean 0.074 	Loss_ct_clean 0.074 	Prec 98.90%
Epoch: [15][100/300]	Time 0.774 (0.775)	Data 0.104 (0.105)	Loss_ce_clean 0.071 	Loss_ct_clean 0.166 	Prec 99.10%
Epoch: [15][150/300]	Time 0.784 (0.775)	Data 0.114 (0.105)	Loss_ce_clean 0.071 	Loss_ct_clean 0.196 	Prec 99.14%
Epoch: [15][200/300]	Time 0.775 (0.775)	Data 0.105 (0.105)	Loss_ce_clean 0.071 	Loss_ct_clean 0.206 	Prec 99.18%
Epoch: [15][250/300]	Time 0.775 (0.775)	Data 0.106 (0.105)	Loss_ce_clean 0.071 	Loss_ct_clean 0.211 	Prec 99.19%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.824998617172241
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.006)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.779237031936646
The orignal cluster result: num cluster = 1532(model) // 1490(model_ema) 	 num outliers = 439(model) // 506(model_ema)
Applying hierarchical clustering
[ 706 1365 1034 ... 1494 1264 1063]
(16522,)
(array([   75,    85,   161,   170,   188,   197,   220,   241,   264,
         341,   443,   460,   481,   588,   676,   677,   714,   808,
         861,   965,   987,   997,  1057,  1059,  1063,  1082,  1098,
        1162,  1197,  1300,  1396,  1402,  1460,  1528,  1587,  1613,
        1631,  1685,  1723,  1735,  1741,  1750,  1833,  1854,  1871,
        1931,  1944,  1976,  1998,  2039,  2066,  2119,  2147,  2170,
        2205,  2236,  2282,  2307,  2330,  2431,  2438,  2441,  2465,
        2494,  2505,  2612,  2694,  2725,  2758,  2783,  2796,  2814,
        2818,  2861,  2871,  2878,  2913,  2947,  2957,  3027,  3030,
        3038,  3097,  3105,  3117,  3157,  3178,  3180,  3271,  3280,
        3304,  3330,  3448,  3480,  3520,  3570,  3593,  3685,  3695,
        3708,  3716,  3720,  3774,  3787,  3794,  3803,  3851,  3896,
        3908,  3933,  3958,  3963,  4143,  4209,  4221,  4321,  4358,
        4400,  4410,  4428,  4429,  4433,  4487,  4498,  4499,  4553,
        4563,  4566,  4587,  4614,  4637,  4682,  4747,  4861,  4902,
        5023,  5025,  5046,  5053,  5084,  5094,  5117,  5182,  5184,
        5232,  5265,  5267,  5280,  5289,  5332,  5361,  5418,  5510,
        5577,  5583,  5589,  5603,  5613,  5669,  5750,  5795,  5807,
        6067,  6082,  6095,  6111,  6128,  6195,  6202,  6301,  6316,
        6319,  6336,  6389,  6448,  6451,  6467,  6556,  6713,  6761,
        6820,  6822,  6825,  6860,  6876,  7110,  7162,  7181,  7307,
        7387,  7389,  7446,  7473,  7503,  7513,  7528,  7560,  7565,
        7612,  7632,  7655,  7746,  7765,  7772,  7796,  7814,  7928,
        7980,  8101,  8131,  8186,  8215,  8237,  8249,  8263,  8285,
        8314,  8373,  8381,  8471,  8487,  8491,  8525,  8544,  8577,
        8579,  8705,  8746,  8778,  8780,  8893,  8909,  8931,  8959,
        9006,  9025,  9057,  9145,  9184,  9226,  9398,  9471,  9485,
        9497,  9504,  9539,  9562,  9720,  9752,  9794,  9835,  9930,
        9936,  9939,  9941,  9944,  9978, 10007, 10031, 10047, 10058,
       10070, 10074, 10076, 10105, 10149, 10215, 10220, 10369, 10397,
       10408, 10435, 10445, 10460, 10482, 10546, 10589, 10593, 10629,
       10640, 10693, 10701, 10750, 10770, 10780, 10794, 10825, 10877,
       10933, 10973, 10991, 11004, 11037, 11059, 11092, 11112, 11116,
       11132, 11194, 11244, 11256, 11274, 11297, 11317, 11324, 11415,
       11420, 11496, 11514, 11571, 11610, 11623, 11657, 11674, 11693,
       11701, 11785, 11827, 11905, 11939, 12031, 12032, 12073, 12083,
       12154, 12210, 12231, 12375, 12394, 12397, 12412, 12414, 12448,
       12453, 12458, 12478, 12510, 12557, 12576, 12655, 12661, 12699,
       12715, 12721, 12732, 12779, 12845, 12876, 12929, 12980, 12984,
       13051, 13102, 13120, 13129, 13131, 13160, 13190, 13235, 13271,
       13292, 13300, 13337, 13352, 13388, 13409, 13441, 13444, 13489,
       13528, 13545, 13601, 13606, 13615, 13651, 13677, 13724, 13734,
       13795, 13807, 13890, 13967, 13976, 13991, 14052, 14079, 14121,
       14174, 14220, 14235, 14278, 14295, 14306, 14339, 14361, 14421,
       14459, 14461, 14506, 14534, 14578, 14634, 14950, 14970, 14997,
       15005, 15041, 15052, 15076, 15090, 15121, 15141, 15161, 15182,
       15200, 15229, 15288, 15340, 15424, 15454, 15500, 15575, 15592,
       15653, 15731, 15752, 15807, 15851, 15998, 16058, 16086, 16138,
       16174, 16202, 16241, 16334, 16467, 16480, 16507]),)
(16522, 16522)
(16083, 16522)
(16083, 16083)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1377933025360107s
The HC Re-cluster result: num cluster = 1532(model) // 1490(model_ema) 	 num outliers = 439(model) // 506(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.836737871170044s
The UCIS result: num clean cluster = 1515(model) 	 num outliers = 811(model)
mdoel:new class are [1516], length of new dataset is 15711
Epoch: [16][0/300]	Time 0.786 (0.786)	Data 0.114 (0.114)	Loss_ce_clean 0.059 	Loss_ct_clean 0.060 	Prec 98.44%
Epoch: [16][50/300]	Time 0.773 (0.775)	Data 0.103 (0.106)	Loss_ce_clean 0.073 	Loss_ct_clean 0.070 	Prec 99.03%
Epoch: [16][100/300]	Time 0.778 (0.774)	Data 0.108 (0.105)	Loss_ce_clean 0.074 	Loss_ct_clean 0.165 	Prec 99.09%
Epoch: [16][150/300]	Time 0.773 (0.774)	Data 0.103 (0.105)	Loss_ce_clean 0.073 	Loss_ct_clean 0.194 	Prec 99.13%
Epoch: [16][200/300]	Time 0.776 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.073 	Loss_ct_clean 0.203 	Prec 99.13%
Epoch: [16][250/300]	Time 0.776 (0.774)	Data 0.106 (0.105)	Loss_ce_clean 0.073 	Loss_ct_clean 0.209 	Prec 99.16%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.815369606018066
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.161)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.843446969985962
The orignal cluster result: num cluster = 1537(model) // 1511(model_ema) 	 num outliers = 373(model) // 459(model_ema)
Applying hierarchical clustering
[ 482 1252 1230 ... 1461 1283 1496]
(16522,)
(array([   75,   112,   161,   188,   197,   213,   220,   241,   383,
         394,   443,   460,   519,   524,   588,   637,   677,   689,
         714,   752,   799,   861,   907,   965,   987,   997,  1057,
        1059,  1098,  1197,  1276,  1300,  1359,  1396,  1402,  1413,
        1573,  1618,  1735,  1819,  1833,  1854,  2039,  2119,  2147,
        2170,  2182,  2205,  2300,  2319,  2431,  2465,  2505,  2575,
        2612,  2680,  2703,  2725,  2770,  2783,  2796,  2814,  2818,
        2871,  2876,  2922,  2927,  3015,  3050,  3073,  3097,  3105,
        3117,  3121,  3142,  3157,  3178,  3180,  3223,  3271,  3330,
        3448,  3480,  3593,  3615,  3695,  3716,  3794,  3803,  3812,
        3851,  3896,  3908,  3933,  4196,  4199,  4209,  4247,  4251,
        4321,  4358,  4400,  4410,  4428,  4429,  4433,  4487,  4496,
        4499,  4566,  4614,  4632,  4637,  4682,  4768,  4902,  4958,
        5084,  5094,  5117,  5215,  5232,  5267,  5280,  5289,  5327,
        5332,  5362,  5465,  5567,  5578,  5583,  5589,  5603,  5807,
        5812,  5848,  6082,  6095,  6128,  6296,  6316,  6319,  6389,
        6467,  6468,  6556,  6727,  6761,  6820,  6825,  6860,  6876,
        6946,  7110,  7145,  7307,  7387,  7389,  7473,  7506,  7538,
        7560,  7565,  7612,  7625,  7632,  7655,  7765,  7796,  7814,
        7928,  7980,  7985,  8044,  8059,  8101,  8215,  8232,  8237,
        8285,  8373,  8381,  8510,  8525,  8577,  8579,  8688,  8746,
        8778,  8780,  8787,  8824,  8893,  8909,  8931,  9006,  9025,
        9057,  9107,  9159,  9226,  9399,  9471,  9497,  9504,  9554,
        9562,  9645,  9674,  9675,  9752,  9759,  9782,  9792,  9835,
        9930,  9936,  9941, 10007, 10031, 10047, 10058, 10070, 10074,
       10149, 10215, 10254, 10408, 10445, 10453, 10460, 10482, 10589,
       10593, 10629, 10642, 10693, 10721, 10750, 10770, 10794, 10825,
       10877, 10946, 10973, 10985, 11004, 11027, 11112, 11116, 11132,
       11194, 11274, 11297, 11317, 11324, 11420, 11610, 11623, 11701,
       11783, 11785, 11827, 11905, 11939, 12031, 12083, 12154, 12226,
       12231, 12317, 12423, 12453, 12510, 12576, 12655, 12657, 12658,
       12665, 12699, 12721, 12759, 12802, 12845, 12974, 12984, 13051,
       13075, 13113, 13120, 13129, 13160, 13190, 13229, 13235, 13242,
       13260, 13292, 13300, 13320, 13337, 13352, 13388, 13389, 13409,
       13444, 13462, 13489, 13511, 13545, 13615, 13625, 13651, 13677,
       13724, 13795, 13911, 13940, 13967, 13976, 13988, 13991, 14052,
       14079, 14121, 14174, 14220, 14235, 14261, 14278, 14295, 14314,
       14361, 14459, 14461, 14506, 14534, 14578, 14579, 14593, 14634,
       14670, 14970, 14997, 15005, 15090, 15121, 15141, 15161, 15188,
       15229, 15257, 15340, 15354, 15575, 15592, 15613, 15731, 15752,
       15851, 15912, 16029, 16086, 16121, 16138, 16174, 16202, 16238,
       16312, 16474, 16480, 16515]),)
(16522, 16522)
(16149, 16522)
(16149, 16149)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.248948335647583s
The HC Re-cluster result: num cluster = 1537(model) // 1511(model_ema) 	 num outliers = 373(model) // 459(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.847693681716919s
The UCIS result: num clean cluster = 1510(model) 	 num outliers = 947(model)
mdoel:new class are [1511], length of new dataset is 15575
Epoch: [17][0/300]	Time 0.790 (0.790)	Data 0.115 (0.115)	Loss_ce_clean 0.065 	Loss_ct_clean 0.062 	Prec 99.22%
Epoch: [17][50/300]	Time 0.776 (0.775)	Data 0.107 (0.106)	Loss_ce_clean 0.063 	Loss_ct_clean 0.064 	Prec 99.07%
Epoch: [17][100/300]	Time 0.775 (0.775)	Data 0.105 (0.106)	Loss_ce_clean 0.063 	Loss_ct_clean 0.146 	Prec 99.21%
Epoch: [17][150/300]	Time 0.775 (0.775)	Data 0.105 (0.105)	Loss_ce_clean 0.063 	Loss_ct_clean 0.171 	Prec 99.25%
Epoch: [17][200/300]	Time 0.775 (0.775)	Data 0.106 (0.105)	Loss_ce_clean 0.065 	Loss_ct_clean 0.182 	Prec 99.26%
Epoch: [17][250/300]	Time 0.820 (0.791)	Data 0.150 (0.110)	Loss_ce_clean 0.066 	Loss_ct_clean 0.191 	Prec 99.25%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.023081064224243
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.162 (0.193)	Data 0.000 (0.035)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.076357364654541
The orignal cluster result: num cluster = 1552(model) // 1520(model_ema) 	 num outliers = 337(model) // 430(model_ema)
Applying hierarchical clustering
[ 609  155  875 ... 1155 1348   -1]
(16522,)
(array([  112,   188,   197,   220,   241,   266,   394,   443,   460,
         519,   577,   588,   676,   677,   714,   942,   965,   987,
         997,  1059,  1098,  1162,  1197,  1246,  1276,  1396,  1402,
        1413,  1460,  1473,  1587,  1631,  1723,  1781,  1819,  1833,
        1871,  1944,  1998,  2022,  2039,  2119,  2147,  2182,  2205,
        2282,  2319,  2465,  2501,  2505,  2575,  2584,  2703,  2725,
        2783,  2796,  2814,  2818,  2871,  2876,  2922,  3027,  3036,
        3050,  3105,  3117,  3121,  3129,  3142,  3157,  3223,  3271,
        3280,  3330,  3448,  3475,  3480,  3570,  3685,  3695,  3716,
        3764,  3794,  3803,  3851,  3873,  3908,  3933,  3963,  4106,
        4209,  4247,  4251,  4321,  4410,  4433,  4496,  4499,  4539,
        4566,  4632,  4637,  4682,  4768,  4902,  5084,  5220,  5232,
        5239,  5267,  5280,  5338,  5418,  5578,  5583,  5589,  5603,
        5712,  5795,  5812,  6065,  6082,  6083,  6111,  6144,  6195,
        6290,  6316,  6319,  6448,  6467,  6696,  6727,  6761,  6818,
        6822,  6825,  7110,  7145,  7181,  7307,  7325,  7387,  7389,
        7473,  7513,  7538,  7560,  7565,  7625,  7632,  7655,  7725,
        7765,  7796,  7928,  8044,  8059,  8101,  8186,  8285,  8340,
        8373,  8379,  8381,  8411,  8471,  8505,  8510,  8525,  8544,
        8576,  8577,  8746,  8778,  8780,  8824,  8893,  8909,  8931,
        9025,  9057,  9103,  9159,  9354,  9365,  9393,  9471,  9497,
        9504,  9562,  9600,  9675,  9720,  9752,  9782,  9792,  9794,
        9835,  9936,  9939,  9941,  9978, 10007, 10047, 10140, 10149,
       10205, 10215, 10369, 10408, 10445, 10453, 10460, 10482, 10540,
       10593, 10693, 10701, 10721, 10750, 10770, 10877, 10946, 10973,
       11004, 11027, 11089, 11092, 11112, 11116, 11194, 11274, 11297,
       11317, 11324, 11407, 11420, 11496, 11514, 11610, 11674, 11701,
       11724, 11827, 11939, 12031, 12231, 12397, 12414, 12423, 12449,
       12453, 12458, 12510, 12550, 12557, 12576, 12658, 12661, 12688,
       12699, 12721, 12751, 12802, 12945, 12980, 13051, 13077, 13160,
       13190, 13292, 13300, 13320, 13388, 13409, 13441, 13444, 13489,
       13511, 13528, 13545, 13601, 13615, 13680, 13717, 13724, 13742,
       13795, 13841, 13890, 13911, 13976, 13988, 13991, 14052, 14121,
       14220, 14226, 14295, 14306, 14459, 14461, 14534, 14578, 14579,
       14591, 14593, 14670, 14898, 14979, 14997, 15005, 15052, 15056,
       15076, 15090, 15121, 15161, 15288, 15352, 15354, 15424, 15575,
       15592, 15731, 15752, 15807, 15912, 16029, 16086, 16138, 16174,
       16202, 16238, 16251, 16521]),)
(16522, 16522)
(16185, 16522)
(16185, 16185)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.696082592010498s
The HC Re-cluster result: num cluster = 1552(model) // 1520(model_ema) 	 num outliers = 337(model) // 430(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9481618404388428s
The UCIS result: num clean cluster = 1528(model) 	 num outliers = 829(model)
mdoel:new class are [1529], length of new dataset is 15693
Epoch: [18][0/300]	Time 0.829 (0.829)	Data 0.146 (0.146)	Loss_ce_clean 0.075 	Loss_ct_clean 0.079 	Prec 97.66%
Epoch: [18][50/300]	Time 0.777 (0.783)	Data 0.102 (0.113)	Loss_ce_clean 0.065 	Loss_ct_clean 0.068 	Prec 98.99%
Epoch: [18][100/300]	Time 0.770 (0.780)	Data 0.100 (0.109)	Loss_ce_clean 0.066 	Loss_ct_clean 0.154 	Prec 99.06%
Epoch: [18][150/300]	Time 0.772 (0.780)	Data 0.102 (0.110)	Loss_ce_clean 0.067 	Loss_ct_clean 0.182 	Prec 99.08%
Epoch: [18][200/300]	Time 0.780 (0.779)	Data 0.110 (0.109)	Loss_ce_clean 0.066 	Loss_ct_clean 0.190 	Prec 99.15%
Epoch: [18][250/300]	Time 1.655 (0.810)	Data 0.980 (0.138)	Loss_ce_clean 0.065 	Loss_ct_clean 0.194 	Prec 99.22%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.155 (0.165)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.089522123336792
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.155 (0.193)	Data 0.000 (0.038)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.034000158309937
The orignal cluster result: num cluster = 1549(model) // 1541(model_ema) 	 num outliers = 289(model) // 397(model_ema)
Applying hierarchical clustering
[ 454 1365 1247 ... 1336 1275  797]
(16522,)
(array([   75,   182,   188,   197,   213,   220,   383,   394,   443,
         460,   481,   519,   588,   637,   676,   714,   907,   965,
         987,   996,   997,  1059,  1098,  1197,  1246,  1396,  1402,
        1413,  1520,  1685,  1723,  1746,  1833,  1854,  1871,  1875,
        1944,  1998,  2039,  2119,  2182,  2205,  2241,  2319,  2330,
        2406,  2431,  2465,  2501,  2575,  2584,  2703,  2758,  2770,
        2783,  2796,  2814,  2818,  2871,  2876,  2922,  3027,  3036,
        3037,  3105,  3117,  3121,  3126,  3129,  3142,  3180,  3223,
        3249,  3271,  3330,  3448,  3480,  3492,  3570,  3593,  3695,
        3716,  3728,  3764,  3786,  3794,  3873,  3896,  3908,  3933,
        3963,  4251,  4321,  4410,  4428,  4499,  4539,  4566,  4637,
        4768,  4828,  4902,  4914,  5117,  5232,  5267,  5302,  5567,
        5583,  5603,  5795,  5848,  6065,  6067,  6111,  6144,  6195,
        6316,  6336,  6448,  6467,  6566,  6658,  6696,  6713,  6860,
        6957,  7110,  7145,  7181,  7387,  7389,  7473,  7528,  7560,
        7565,  7632,  7722,  7725,  7748,  7765,  7796,  7928,  8044,
        8059,  8101,  8237,  8285,  8319,  8340,  8471,  8525,  8544,
        8577,  8584,  8705,  8746,  8778,  8780,  8824,  8893,  8909,
        9025,  9057,  9107,  9126,  9282,  9360,  9471,  9487,  9497,
        9504,  9600,  9675,  9720,  9752,  9794,  9936,  9939, 10007,
       10047, 10140, 10149, 10154, 10453, 10460, 10482, 10546, 10589,
       10593, 10750, 10770, 10825, 10877, 10933, 10946, 10973, 11004,
       11112, 11116, 11132, 11194, 11244, 11274, 11317, 11324, 11420,
       11610, 11693, 11724, 11827, 11939, 12031, 12154, 12208, 12210,
       12226, 12231, 12414, 12453, 12510, 12557, 12658, 12661, 12699,
       12721, 12802, 12974, 12980, 12984, 13051, 13190, 13260, 13292,
       13300, 13409, 13441, 13444, 13489, 13511, 13528, 13601, 13615,
       13680, 13724, 13890, 13967, 13988, 13991, 14052, 14121, 14135,
       14174, 14220, 14226, 14235, 14295, 14306, 14459, 14461, 14534,
       14578, 14593, 14634, 14670, 14898, 14970, 14979, 15005, 15090,
       15141, 15161, 15229, 15290, 15352, 15424, 15484, 15575, 15592,
       15731, 15969, 16058, 16086, 16138, 16174, 16202, 16240, 16334,
       16467]),)
(16522, 16522)
(16233, 16522)
(16233, 16233)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.650991916656494s
The HC Re-cluster result: num cluster = 1549(model) // 1541(model_ema) 	 num outliers = 289(model) // 397(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.208465576171875s
The UCIS result: num clean cluster = 1527(model) 	 num outliers = 764(model)
mdoel:new class are [1528], length of new dataset is 15758
Epoch: [19][0/300]	Time 1.287 (1.287)	Data 0.595 (0.595)	Loss_ce_clean 0.076 	Loss_ct_clean 0.078 	Prec 96.88%
Epoch: [19][50/300]	Time 0.990 (1.059)	Data 0.320 (0.388)	Loss_ce_clean 0.055 	Loss_ct_clean 0.061 	Prec 99.16%
Epoch: [19][100/300]	Time 0.797 (0.991)	Data 0.127 (0.320)	Loss_ce_clean 0.059 	Loss_ct_clean 0.133 	Prec 99.16%
Epoch: [19][150/300]	Time 0.829 (0.938)	Data 0.159 (0.267)	Loss_ce_clean 0.060 	Loss_ct_clean 0.155 	Prec 99.18%
Epoch: [19][200/300]	Time 0.780 (0.906)	Data 0.110 (0.235)	Loss_ce_clean 0.061 	Loss_ct_clean 0.166 	Prec 99.23%
Epoch: [19][250/300]	Time 0.889 (0.915)	Data 0.218 (0.243)	Loss_ce_clean 0.062 	Loss_ct_clean 0.171 	Prec 99.26%
Extract Features: [100/156]	Time 0.160 (0.362)	Data 0.000 (0.203)	
Mean AP: 48.2%
CMC Scores:
  top-1          65.0%
  top-5          78.2%
  top-10         83.4%
Extract Features: [100/156]	Time 0.155 (0.163)	Data 0.000 (0.008)	
Mean AP: 50.9%
CMC Scores:
  top-1          68.2%
  top-5          79.9%
  top-10         84.6%

 * Finished epoch  19  model no.1 mAP: 48.2% model no.2(mean-net) mAP: 50.9%  best: 53.9%

Test on the best model.
=> Loaded checkpoint 'logs/dbscan/market2duke/model_best.pth.tar'
Extract Features: [100/156]	Time 0.155 (0.162)	Data 0.000 (0.007)	
Mean AP: 53.9%
CMC Scores:
  top-1          70.0%
  top-5          81.1%
  top-10         85.3%
