==========
Args:Namespace(dataset_source='market1501', dataset_target='duke', batch_size=128, workers=6, choice_c=0, num_clusters=32621, ncs='60', k1=30, k2=6, height=256, width=128, num_instances=4, arch='resnet50', features=0, dropout=0, lr=3.5e-05, momentum=0.9, alpha=0.999, moving_avg_momentum=0, weight_decay=0.0005, soft_ce_weight=0.5, soft_tri_weight=0.8, epochs=400, iters=200, lambda_value=0, rr_gpu=False, init_1='/hgst/longdn/UCF-main/logs/pretrained/market2duke/model_best.pth.tar', seed=1, print_freq=100, eval_step=5, n_jobs=8, data_dir='/hgst/longdn/UCF-main/data', logs_dir='/hgst/longdn/UCF-main/logs/dbscan/market2dukev3/', log_name='', HC=True, UCIS=True)
==========
=> Dukemtmc loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   702 |    16522 |         8
  query    |   702 |     2228 |         8
  gallery  |  1110 |    17661 |         8
  ----------------------------------------
/hgst/longdn/UCF-main/data/market1501/Market-1501-v15.09.15/bounding_box_test




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































=> Market1501 loaded
Dataset statistics:
  ----------------------------------------
  subset   | # ids | # images | # cameras
  ----------------------------------------
  train    |   751 |    12936 |         6
  query    |   750 |     3368 |         6
  gallery  |   751 |    15913 |         6
  ----------------------------------------
=> Loaded checkpoint '/hgst/longdn/UCF-main/logs/pretrained/market2duke/model_best.pth.tar'
missing keys in state_dict: {'classifier0_32621.weight'}
missing keys in state_dict: {'classifier0_32621.weight'}
load pretrain model:/hgst/longdn/UCF-main/logs/pretrained/market2duke/model_best.pth.tar
Clustering criterion: eps: 0.600
Training begining~~~~~~!!!!!!!!!
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.186)	Data 0.000 (0.004)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.02948808670044
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.183)	Data 0.000 (0.027)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.025843620300293
The orignal cluster result: num cluster = 1039(model) // 1039(model_ema) 	 num outliers = 4082(model) // 4082(model_ema)
Applying hierarchical clustering
[860 615 734 ...  -1 573 923]
(16522,)
(array([    3,     4,     6, ..., 16509, 16515, 16519]),)
(16522, 16522)
(12440, 16522)
(12440, 12440)
reCluster!use silhouette score and tao=0.0
each uncer num= [19, 6, 5, 5] average= 8.75 uncer_average= -0.15315636
reCluster!use silhouette score and tao=0.0
each uncer num= [19, 6, 5, 5] average= 8.75 uncer_average= -0.15315636
HC finish! Cost time=1.5339694023132324s
The HC Re-cluster result: num cluster = 1039(model) // 1039(model_ema) 	 num outliers = 4082(model) // 4082(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.7084927558898926s
The UCIS result: num clean cluster = 1039(model) 	 num outliers = 4082(model)
mdoel:new class are [1040], length of new dataset is 12440
Epoch: [0][0/300]	Time 5.196 (5.196)	Data 0.116 (0.116)	Loss_ce_clean 1.153 	Loss_ct_clean 1.067 	Prec 81.25%
Epoch: [0][50/300]	Time 1.010 (0.892)	Data 0.340 (0.140)	Loss_ce_clean 0.731 	Loss_ct_clean 0.935 	Prec 89.41%
Epoch: [0][100/300]	Time 0.806 (0.952)	Data 0.136 (0.243)	Loss_ce_clean 0.647 	Loss_ct_clean 1.081 	Prec 91.03%
Epoch: [0][150/300]	Time 0.783 (0.895)	Data 0.117 (0.200)	Loss_ce_clean 0.603 	Loss_ct_clean 1.075 	Prec 91.87%
Epoch: [0][200/300]	Time 0.769 (0.864)	Data 0.104 (0.175)	Loss_ce_clean 0.566 	Loss_ct_clean 1.045 	Prec 92.55%
Epoch: [0][250/300]	Time 0.780 (0.846)	Data 0.115 (0.162)	Loss_ce_clean 0.540 	Loss_ct_clean 1.010 	Prec 92.98%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.103084325790405
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.164 (0.223)	Data 0.000 (0.065)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.114851713180542
The orignal cluster result: num cluster = 1174(model) // 1142(model_ema) 	 num outliers = 2367(model) // 2570(model_ema)
Applying hierarchical clustering
[  -1 1035  625 ...   -1  258  676]
(16522,)
(array([    0,     4,    17, ..., 16515, 16518, 16519]),)
(16522, 16522)
(14155, 16522)
(14155, 14155)
reCluster!use silhouette score and tao=0.0
each uncer num= [6] average= 6.0 uncer_average= -0.17086291
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.9117939472198486s
The HC Re-cluster result: num cluster = 1174(model) // 1142(model_ema) 	 num outliers = 2367(model) // 2570(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.3590402603149414s
The UCIS result: num clean cluster = 1040(model) 	 num outliers = 4566(model)
mdoel:new class are [1041], length of new dataset is 11956
Epoch: [1][0/300]	Time 0.786 (0.786)	Data 0.114 (0.114)	Loss_ce_clean 0.360 	Loss_ct_clean 0.299 	Prec 93.75%
Epoch: [1][50/300]	Time 1.239 (0.780)	Data 0.562 (0.113)	Loss_ce_clean 0.271 	Loss_ct_clean 0.413 	Prec 96.63%
Epoch: [1][100/300]	Time 1.060 (0.898)	Data 0.391 (0.231)	Loss_ce_clean 0.258 	Loss_ct_clean 0.582 	Prec 96.78%
Epoch: [1][150/300]	Time 0.855 (0.943)	Data 0.189 (0.276)	Loss_ce_clean 0.251 	Loss_ct_clean 0.610 	Prec 96.92%
Epoch: [1][200/300]	Time 0.902 (0.924)	Data 0.237 (0.258)	Loss_ce_clean 0.242 	Loss_ct_clean 0.608 	Prec 97.06%
Epoch: [1][250/300]	Time 0.811 (0.904)	Data 0.145 (0.237)	Loss_ce_clean 0.233 	Loss_ct_clean 0.601 	Prec 97.24%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.162 (0.167)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.075929164886475
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.172)	Data 0.000 (0.015)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.192519903182983
The orignal cluster result: num cluster = 1235(model) // 1185(model_ema) 	 num outliers = 1854(model) // 2197(model_ema)
Applying hierarchical clustering
[ -1 605 634 ... 964  -1 902]
(16522,)
(array([    0,     4,    10, ..., 16493, 16515, 16520]),)
(16522, 16522)
(14668, 16522)
(14668, 14668)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.0747716426849365s
The HC Re-cluster result: num cluster = 1235(model) // 1185(model_ema) 	 num outliers = 1854(model) // 2197(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9042232036590576s
The UCIS result: num clean cluster = 1096(model) 	 num outliers = 4098(model)
mdoel:new class are [1097], length of new dataset is 12424
Epoch: [2][0/300]	Time 0.798 (0.798)	Data 0.124 (0.124)	Loss_ce_clean 0.219 	Loss_ct_clean 0.187 	Prec 97.66%
Epoch: [2][50/300]	Time 0.775 (0.776)	Data 0.110 (0.110)	Loss_ce_clean 0.195 	Loss_ct_clean 0.295 	Prec 97.61%
Epoch: [2][100/300]	Time 0.768 (0.776)	Data 0.102 (0.111)	Loss_ce_clean 0.192 	Loss_ct_clean 0.446 	Prec 97.69%
Epoch: [2][150/300]	Time 0.771 (0.776)	Data 0.106 (0.111)	Loss_ce_clean 0.186 	Loss_ct_clean 0.474 	Prec 97.91%
Epoch: [2][200/300]	Time 0.776 (0.776)	Data 0.111 (0.111)	Loss_ce_clean 0.182 	Loss_ct_clean 0.487 	Prec 97.99%
Epoch: [2][250/300]	Time 0.777 (0.776)	Data 0.106 (0.110)	Loss_ce_clean 0.178 	Loss_ct_clean 0.483 	Prec 98.02%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.161 (0.164)	Data 0.005 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.743370056152344
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.171)	Data 0.000 (0.010)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.790266752243042
The orignal cluster result: num cluster = 1275(model) // 1224(model_ema) 	 num outliers = 1514(model) // 1966(model_ema)
Applying hierarchical clustering
[1074 1240  589 ...  229   -1  867]
(16522,)
(array([   10,    20,    23, ..., 16476, 16515, 16520]),)
(16522, 16522)
(15008, 16522)
(15008, 15008)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.079301595687866s
The HC Re-cluster result: num cluster = 1275(model) // 1224(model_ema) 	 num outliers = 1514(model) // 1966(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8169610500335693s
The UCIS result: num clean cluster = 1148(model) 	 num outliers = 3727(model)
mdoel:new class are [1149], length of new dataset is 12795
Epoch: [3][0/300]	Time 0.786 (0.786)	Data 0.114 (0.114)	Loss_ce_clean 0.156 	Loss_ct_clean 0.122 	Prec 98.44%
Epoch: [3][50/300]	Time 0.779 (0.769)	Data 0.114 (0.103)	Loss_ce_clean 0.168 	Loss_ct_clean 0.242 	Prec 97.66%
Epoch: [3][100/300]	Time 0.767 (0.769)	Data 0.101 (0.103)	Loss_ce_clean 0.165 	Loss_ct_clean 0.376 	Prec 97.93%
Epoch: [3][150/300]	Time 0.773 (0.769)	Data 0.108 (0.104)	Loss_ce_clean 0.162 	Loss_ct_clean 0.405 	Prec 98.03%
Epoch: [3][200/300]	Time 0.769 (0.769)	Data 0.103 (0.104)	Loss_ce_clean 0.156 	Loss_ct_clean 0.413 	Prec 98.18%
Epoch: [3][250/300]	Time 0.769 (0.769)	Data 0.104 (0.104)	Loss_ce_clean 0.152 	Loss_ct_clean 0.415 	Prec 98.31%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.666404724121094
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.774937391281128
The orignal cluster result: num cluster = 1313(model) // 1247(model_ema) 	 num outliers = 1357(model) // 1699(model_ema)
Applying hierarchical clustering
[ 406  641  734 ...  888  853 1205]
(16522,)
(array([    6,    10,    53, ..., 16493, 16515, 16518]),)
(16522, 16522)
(15165, 16522)
(15165, 15165)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=1.9635777473449707s
The HC Re-cluster result: num cluster = 1313(model) // 1247(model_ema) 	 num outliers = 1357(model) // 1699(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8293356895446777s
The UCIS result: num clean cluster = 1217(model) 	 num outliers = 3041(model)
mdoel:new class are [1218], length of new dataset is 13481
Epoch: [4][0/300]	Time 0.781 (0.781)	Data 0.110 (0.110)	Loss_ce_clean 0.124 	Loss_ct_clean 0.110 	Prec 97.66%
Epoch: [4][50/300]	Time 0.766 (0.766)	Data 0.101 (0.100)	Loss_ce_clean 0.145 	Loss_ct_clean 0.198 	Prec 98.22%
Epoch: [4][100/300]	Time 0.764 (0.765)	Data 0.098 (0.099)	Loss_ce_clean 0.141 	Loss_ct_clean 0.323 	Prec 98.39%
Epoch: [4][150/300]	Time 0.768 (0.764)	Data 0.103 (0.099)	Loss_ce_clean 0.141 	Loss_ct_clean 0.360 	Prec 98.40%
Epoch: [4][200/300]	Time 0.763 (0.764)	Data 0.098 (0.099)	Loss_ce_clean 0.139 	Loss_ct_clean 0.377 	Prec 98.45%
Epoch: [4][250/300]	Time 0.763 (0.764)	Data 0.097 (0.098)	Loss_ce_clean 0.136 	Loss_ct_clean 0.382 	Prec 98.55%
Extract Features: [100/156]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Mean AP: 51.4%
CMC Scores:
  top-1          68.5%
  top-5          79.6%
  top-10         83.8%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.006)	
Mean AP: 50.1%
CMC Scores:
  top-1          66.5%
  top-5          78.3%
  top-10         82.2%

 * Finished epoch   4  model no.1 mAP: 51.4% model no.2(mean-net) mAP: 50.1%  best: 51.4% *

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.710742473602295
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.172)	Data 0.000 (0.016)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.737494468688965
The orignal cluster result: num cluster = 1326(model) // 1287(model_ema) 	 num outliers = 1221(model) // 1613(model_ema)
Applying hierarchical clustering
[ 414 1288 1131 ...  773  633  983]
(16522,)
(array([    6,    23,    53, ..., 16475, 16505, 16515]),)
(16522, 16522)
(15301, 16522)
(15301, 15301)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.0003466606140137s
The HC Re-cluster result: num cluster = 1326(model) // 1287(model_ema) 	 num outliers = 1221(model) // 1613(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8453075885772705s
The UCIS result: num clean cluster = 1217(model) 	 num outliers = 3050(model)
mdoel:new class are [1218], length of new dataset is 13472
Epoch: [5][0/300]	Time 0.781 (0.781)	Data 0.111 (0.111)	Loss_ce_clean 0.098 	Loss_ct_clean 0.086 	Prec 99.22%
Epoch: [5][50/300]	Time 0.769 (0.768)	Data 0.104 (0.102)	Loss_ce_clean 0.119 	Loss_ct_clean 0.166 	Prec 98.48%
Epoch: [5][100/300]	Time 0.769 (0.769)	Data 0.104 (0.103)	Loss_ce_clean 0.117 	Loss_ct_clean 0.286 	Prec 98.66%
Epoch: [5][150/300]	Time 0.768 (0.768)	Data 0.102 (0.103)	Loss_ce_clean 0.114 	Loss_ct_clean 0.314 	Prec 98.70%
Epoch: [5][200/300]	Time 0.769 (0.768)	Data 0.104 (0.103)	Loss_ce_clean 0.114 	Loss_ct_clean 0.329 	Prec 98.69%
Epoch: [5][250/300]	Time 0.767 (0.769)	Data 0.101 (0.103)	Loss_ce_clean 0.112 	Loss_ct_clean 0.332 	Prec 98.72%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.739163160324097
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.081834077835083
The orignal cluster result: num cluster = 1361(model) // 1299(model_ema) 	 num outliers = 1214(model) // 1450(model_ema)
Applying hierarchical clustering
[ 502  887  693 ...  498  681 1268]
(16522,)
(array([    6,     7,    23, ..., 16467, 16493, 16515]),)
(16522, 16522)
(15308, 16522)
(15308, 15308)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.6153037548065186s
The HC Re-cluster result: num cluster = 1361(model) // 1299(model_ema) 	 num outliers = 1214(model) // 1450(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9870691299438477s
The UCIS result: num clean cluster = 1270(model) 	 num outliers = 2681(model)
mdoel:new class are [1271], length of new dataset is 13841
Epoch: [6][0/300]	Time 1.561 (1.561)	Data 0.158 (0.158)	Loss_ce_clean 0.071 	Loss_ct_clean 0.062 	Prec 100.00%
Epoch: [6][50/300]	Time 0.780 (1.248)	Data 0.115 (0.317)	Loss_ce_clean 0.118 	Loss_ct_clean 0.159 	Prec 98.47%
Epoch: [6][100/300]	Time 0.771 (1.014)	Data 0.106 (0.214)	Loss_ce_clean 0.117 	Loss_ct_clean 0.282 	Prec 98.58%
Epoch: [6][150/300]	Time 1.468 (1.038)	Data 0.803 (0.282)	Loss_ce_clean 0.114 	Loss_ct_clean 0.312 	Prec 98.72%
Epoch: [6][200/300]	Time 0.955 (1.027)	Data 0.290 (0.293)	Loss_ce_clean 0.112 	Loss_ct_clean 0.325 	Prec 98.79%
Epoch: [6][250/300]	Time 1.091 (1.005)	Data 0.425 (0.285)	Loss_ce_clean 0.111 	Loss_ct_clean 0.328 	Prec 98.80%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.161 (0.169)	Data 0.000 (0.010)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.89488673210144
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.175)	Data 0.000 (0.017)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.387909889221191
The orignal cluster result: num cluster = 1385(model) // 1329(model_ema) 	 num outliers = 1089(model) // 1270(model_ema)
Applying hierarchical clustering
[ 581  933  516 ... 1193  977 1165]
(16522,)
(array([    7,    19,    39, ..., 16467, 16505, 16515]),)
(16522, 16522)
(15433, 16522)
(15433, 15433)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2914624214172363s
The HC Re-cluster result: num cluster = 1385(model) // 1329(model_ema) 	 num outliers = 1089(model) // 1270(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.995762825012207s
The UCIS result: num clean cluster = 1302(model) 	 num outliers = 2409(model)
mdoel:new class are [1303], length of new dataset is 14113
Epoch: [7][0/300]	Time 0.877 (0.877)	Data 0.207 (0.207)	Loss_ce_clean 0.101 	Loss_ct_clean 0.090 	Prec 99.22%
Epoch: [7][50/300]	Time 0.777 (1.111)	Data 0.107 (0.130)	Loss_ce_clean 0.109 	Loss_ct_clean 0.139 	Prec 98.79%
Epoch: [7][100/300]	Time 0.840 (1.168)	Data 0.169 (0.342)	Loss_ce_clean 0.108 	Loss_ct_clean 0.248 	Prec 98.70%
Epoch: [7][150/300]	Time 0.771 (1.043)	Data 0.106 (0.270)	Loss_ce_clean 0.109 	Loss_ct_clean 0.291 	Prec 98.69%
Epoch: [7][200/300]	Time 0.850 (0.980)	Data 0.184 (0.233)	Loss_ce_clean 0.108 	Loss_ct_clean 0.307 	Prec 98.72%
Epoch: [7][250/300]	Time 0.772 (0.940)	Data 0.101 (0.210)	Loss_ce_clean 0.106 	Loss_ct_clean 0.310 	Prec 98.82%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.171)	Data 0.000 (0.013)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.334040403366089
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.165)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.663108348846436
The orignal cluster result: num cluster = 1399(model) // 1359(model_ema) 	 num outliers = 926(model) // 1177(model_ema)
Applying hierarchical clustering
[ 221  953 1048 ... 1238 1286 1383]
(16522,)
(array([    7,    19,    39,    85,    97,   104,   111,   161,   176,
         183,   188,   199,   207,   220,   225,   241,   248,   249,
         257,   269,   287,   341,   352,   356,   383,   394,   398,
         400,   417,   437,   443,   472,   519,   524,   531,   573,
         588,   596,   632,   643,   676,   689,   714,   728,   743,
         754,   755,   795,   807,   808,   827,   832,   851,   853,
         857,   861,   887,   905,   911,   918,   957,  1005,  1030,
        1037,  1059,  1063,  1070,  1097,  1098,  1154,  1209,  1263,
        1299,  1319,  1328,  1354,  1402,  1413,  1417,  1430,  1433,
        1439,  1473,  1494,  1571,  1573,  1575,  1618,  1644,  1654,
        1670,  1672,  1685,  1687,  1723,  1731,  1735,  1741,  1746,
        1783,  1812,  1833,  1849,  1860,  1922,  1931,  1947,  1971,
        1984,  1998,  2057,  2097,  2127,  2147,  2160,  2170,  2179,
        2182,  2199,  2205,  2241,  2252,  2264,  2282,  2295,  2299,
        2316,  2330,  2334,  2385,  2406,  2431,  2438,  2465,  2501,
        2559,  2569,  2580,  2680,  2684,  2690,  2695,  2710,  2724,
        2732,  2756,  2769,  2770,  2784,  2796,  2802,  2814,  2818,
        2830,  2862,  2878,  2913,  2922,  2947,  3015,  3018,  3027,
        3030,  3036,  3038,  3045,  3046,  3073,  3077,  3090,  3107,
        3114,  3117,  3121,  3126,  3142,  3143,  3180,  3202,  3271,
        3283,  3302,  3311,  3318,  3330,  3337,  3392,  3404,  3414,
        3437,  3448,  3480,  3492,  3502,  3524,  3540,  3544,  3560,
        3570,  3571,  3582,  3598,  3641,  3670,  3672,  3677,  3685,
        3695,  3708,  3713,  3728,  3742,  3754,  3764,  3774,  3794,
        3815,  3842,  3887,  3896,  3933,  3956,  3961,  4045,  4061,
        4065,  4072,  4094,  4100,  4105,  4106,  4209,  4221,  4238,
        4242,  4247,  4249,  4251,  4257,  4319,  4324,  4334,  4351,
        4360,  4390,  4420,  4424,  4428,  4429,  4440,  4450,  4484,
        4487,  4527,  4539,  4566,  4609,  4628,  4632,  4637,  4639,
        4651,  4653,  4681,  4682,  4685,  4696,  4703,  4747,  4753,
        4764,  4774,  4939,  5008,  5016,  5023,  5053,  5082,  5094,
        5104,  5107,  5129,  5141,  5148,  5174,  5180,  5184,  5220,
        5239,  5255,  5265,  5267,  5280,  5302,  5304,  5317,  5331,
        5361,  5362,  5367,  5379,  5388,  5394,  5418,  5420,  5440,
        5466,  5492,  5513,  5524,  5526,  5546,  5558,  5563,  5567,
        5575,  5578,  5585,  5603,  5613,  5631,  5649,  5704,  5712,
        5721,  5730,  5739,  5750,  5773,  5790,  5806,  5807,  5816,
        5848,  5849,  5853,  5869,  5912,  5913,  5926,  5945,  5995,
        6011,  6028,  6035,  6067,  6079,  6080,  6082,  6095,  6132,
        6142,  6144,  6194,  6199,  6208,  6211,  6239,  6261,  6296,
        6301,  6322,  6442,  6447,  6467,  6531,  6541,  6556,  6568,
        6574,  6593,  6618,  6629,  6632,  6658,  6666,  6709,  6721,
        6742,  6788,  6792,  6818,  6820,  6825,  6847,  6859,  6860,
        6883,  6946,  6964,  6965,  7022,  7028,  7045,  7059,  7105,
        7110,  7111,  7130,  7145,  7168,  7206,  7211,  7214,  7218,
        7245,  7272,  7282,  7286,  7307,  7323,  7378,  7387,  7389,
        7427,  7440,  7444,  7446,  7492,  7513,  7514,  7515,  7538,
        7565,  7575,  7612,  7625,  7630,  7631,  7682,  7696,  7722,
        7748,  7761,  7765,  7796,  7831,  7858,  7880,  7912,  7919,
        7980,  7981,  7985,  8033,  8045,  8068,  8076,  8101,  8117,
        8129,  8134,  8141,  8160,  8167,  8173,  8203,  8222,  8227,
        8232,  8237,  8263,  8285,  8319,  8332,  8373,  8379,  8381,
        8383,  8392,  8395,  8458,  8471,  8479,  8485,  8487,  8525,
        8528,  8576,  8579,  8593,  8594,  8609,  8657,  8662,  8688,
        8697,  8721,  8738,  8746,  8775,  8799,  8818,  8892,  8893,
        8910,  8916,  8926,  8931,  8946,  8947,  8961,  8971,  8973,
        8996,  9023,  9029,  9049,  9059,  9081,  9084,  9107,  9159,
        9172,  9175,  9246,  9250,  9260,  9282,  9288,  9312,  9322,
        9328,  9360,  9365,  9398,  9399,  9416,  9471,  9485,  9497,
        9504,  9513,  9528,  9554,  9562,  9600,  9610,  9640,  9643,
        9649,  9679,  9720,  9725,  9740,  9743,  9746,  9756,  9757,
        9775,  9779,  9794,  9810,  9835,  9854,  9892,  9922,  9930,
        9936,  9944,  9963,  9978,  9988, 10007, 10030, 10047, 10058,
       10061, 10070, 10072, 10076, 10140, 10154, 10177, 10206, 10213,
       10215, 10233, 10251, 10281, 10298, 10337, 10338, 10351, 10368,
       10369, 10408, 10411, 10435, 10453, 10457, 10479, 10484, 10504,
       10535, 10541, 10561, 10589, 10608, 10629, 10642, 10665, 10682,
       10697, 10749, 10750, 10764, 10770, 10794, 10796, 10814, 10825,
       10846, 10854, 10877, 10923, 10932, 10933, 10946, 10964, 10973,
       10979, 11019, 11024, 11025, 11112, 11116, 11152, 11163, 11166,
       11194, 11195, 11224, 11243, 11244, 11256, 11274, 11297, 11324,
       11337, 11342, 11359, 11387, 11408, 11420, 11441, 11463, 11464,
       11472, 11545, 11553, 11605, 11610, 11622, 11639, 11645, 11686,
       11698, 11701, 11714, 11738, 11749, 11750, 11764, 11767, 11790,
       11827, 11849, 11854, 11858, 11863, 11874, 11877, 11900, 11905,
       11939, 11958, 11968, 11972, 12031, 12079, 12090, 12094, 12099,
       12116, 12130, 12148, 12153, 12154, 12164, 12208, 12212, 12226,
       12234, 12253, 12283, 12308, 12340, 12386, 12394, 12397, 12412,
       12414, 12434, 12441, 12453, 12458, 12477, 12510, 12537, 12550,
       12557, 12558, 12585, 12658, 12661, 12688, 12699, 12715, 12721,
       12743, 12753, 12793, 12805, 12823, 12845, 12902, 12916, 12973,
       12974, 12977, 12980, 13035, 13063, 13072, 13076, 13094, 13099,
       13102, 13120, 13153, 13162, 13167, 13190, 13200, 13201, 13218,
       13224, 13229, 13247, 13248, 13271, 13277, 13292, 13296, 13300,
       13303, 13311, 13321, 13337, 13368, 13388, 13407, 13409, 13420,
       13478, 13495, 13519, 13528, 13545, 13566, 13571, 13601, 13606,
       13615, 13619, 13625, 13644, 13680, 13703, 13707, 13717, 13724,
       13728, 13734, 13795, 13799, 13816, 13861, 13864, 13875, 13890,
       13942, 13945, 13955, 13976, 13991, 14033, 14037, 14112, 14121,
       14122, 14147, 14154, 14164, 14174, 14220, 14222, 14226, 14235,
       14255, 14258, 14266, 14267, 14278, 14348, 14412, 14421, 14448,
       14461, 14506, 14520, 14521, 14525, 14564, 14579, 14594, 14603,
       14634, 14691, 14727, 14743, 14810, 14857, 14865, 14877, 14880,
       14898, 14933, 14943, 14950, 14970, 14979, 14985, 15005, 15006,
       15037, 15053, 15063, 15090, 15091, 15100, 15111, 15112, 15141,
       15156, 15161, 15166, 15182, 15183, 15197, 15200, 15229, 15245,
       15258, 15288, 15295, 15303, 15324, 15340, 15352, 15402, 15406,
       15407, 15424, 15427, 15432, 15443, 15447, 15454, 15484, 15500,
       15519, 15524, 15547, 15592, 15597, 15608, 15728, 15736, 15752,
       15837, 15841, 15851, 15898, 15912, 15915, 15950, 15963, 15969,
       15973, 15995, 16029, 16054, 16058, 16086, 16110, 16130, 16138,
       16148, 16195, 16202, 16203, 16206, 16235, 16238, 16259, 16270,
       16292, 16300, 16307, 16326, 16442, 16449, 16467, 16515]),)
(16522, 16522)
(15596, 16522)
(15596, 15596)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1145942211151123s
The HC Re-cluster result: num cluster = 1399(model) // 1359(model_ema) 	 num outliers = 926(model) // 1177(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9231867790222168s
The UCIS result: num clean cluster = 1339(model) 	 num outliers = 2037(model)
mdoel:new class are [1340], length of new dataset is 14485
Epoch: [8][0/300]	Time 0.820 (0.820)	Data 0.139 (0.139)	Loss_ce_clean 0.051 	Loss_ct_clean 0.042 	Prec 100.00%
Epoch: [8][50/300]	Time 0.767 (0.774)	Data 0.101 (0.108)	Loss_ce_clean 0.096 	Loss_ct_clean 0.128 	Prec 98.93%
Epoch: [8][100/300]	Time 0.764 (0.773)	Data 0.099 (0.107)	Loss_ce_clean 0.097 	Loss_ct_clean 0.235 	Prec 98.89%
Epoch: [8][150/300]	Time 1.535 (0.839)	Data 0.110 (0.106)	Loss_ce_clean 0.098 	Loss_ct_clean 0.271 	Prec 98.86%
Epoch: [8][200/300]	Time 0.800 (0.898)	Data 0.135 (0.108)	Loss_ce_clean 0.099 	Loss_ct_clean 0.284 	Prec 98.86%
Epoch: [8][250/300]	Time 1.535 (0.937)	Data 0.104 (0.108)	Loss_ce_clean 0.097 	Loss_ct_clean 0.289 	Prec 98.91%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.160 (0.173)	Data 0.000 (0.015)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.227994441986084
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.162 (0.165)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.924928426742554
The orignal cluster result: num cluster = 1414(model) // 1378(model_ema) 	 num outliers = 782(model) // 1059(model_ema)
Applying hierarchical clustering
[ 118 1026  783 ... 1273 1401 1342]
(16522,)
(array([    7,    19,    23,    75,    85,    97,   111,   161,   171,
         183,   186,   188,   199,   207,   241,   247,   248,   257,
         269,   283,   287,   341,   356,   394,   400,   412,   417,
         436,   437,   443,   460,   464,   472,   487,   519,   524,
         531,   573,   588,   596,   608,   637,   643,   651,   676,
         689,   714,   728,   754,   755,   808,   827,   832,   844,
         851,   853,   861,   905,   911,   918,   979,  1005,  1030,
        1059,  1063,  1098,  1154,  1159,  1162,  1197,  1209,  1263,
        1389,  1396,  1402,  1417,  1473,  1494,  1571,  1573,  1594,
        1631,  1644,  1654,  1672,  1723,  1731,  1735,  1741,  1746,
        1794,  1833,  1849,  1856,  1860,  1922,  1984,  1998,  2036,
        2066,  2097,  2117,  2127,  2147,  2148,  2170,  2205,  2241,
        2282,  2295,  2299,  2330,  2332,  2334,  2406,  2431,  2438,
        2465,  2486,  2501,  2567,  2680,  2690,  2694,  2724,  2732,
        2754,  2756,  2769,  2770,  2776,  2796,  2814,  2910,  2913,
        2927,  2947,  2955,  2983,  3030,  3046,  3073,  3077,  3090,
        3114,  3117,  3121,  3126,  3178,  3180,  3185,  3200,  3202,
        3245,  3249,  3271,  3302,  3318,  3337,  3392,  3404,  3437,
        3507,  3524,  3560,  3570,  3571,  3582,  3598,  3641,  3677,
        3685,  3708,  3713,  3716,  3720,  3728,  3749,  3754,  3764,
        3812,  3837,  3842,  3908,  3933,  3956,  4061,  4065,  4072,
        4085,  4105,  4106,  4196,  4209,  4221,  4242,  4247,  4249,
        4251,  4257,  4310,  4319,  4334,  4351,  4358,  4428,  4429,
        4440,  4484,  4487,  4539,  4566,  4609,  4628,  4637,  4638,
        4639,  4651,  4653,  4663,  4676,  4682,  4685,  4703,  4747,
        4753,  4764,  4798,  4849,  4902,  4914,  4921,  4939,  4987,
        5016,  5023,  5053,  5085,  5094,  5104,  5107,  5141,  5148,
        5174,  5180,  5184,  5220,  5253,  5280,  5298,  5317,  5331,
        5361,  5362,  5367,  5379,  5394,  5420,  5440,  5492,  5513,
        5524,  5526,  5546,  5558,  5563,  5567,  5578,  5585,  5631,
        5702,  5704,  5712,  5773,  5816,  5838,  5848,  5849,  5853,
        5869,  5912,  5926,  5945,  5995,  6004,  6011,  6028,  6035,
        6063,  6067,  6079,  6080,  6082,  6095,  6132,  6142,  6194,
        6199,  6208,  6211,  6253,  6261,  6296,  6301,  6316,  6322,
        6346,  6442,  6443,  6447,  6450,  6456,  6491,  6535,  6546,
        6556,  6568,  6576,  6593,  6607,  6632,  6634,  6658,  6666,
        6696,  6709,  6721,  6742,  6788,  6818,  6820,  6825,  6859,
        6860,  6876,  6883,  6940,  6964,  6965,  7022,  7028,  7045,
        7071,  7111,  7145,  7168,  7181,  7211,  7214,  7218,  7282,
        7307,  7323,  7332,  7336,  7387,  7389,  7427,  7513,  7538,
        7542,  7604,  7612,  7625,  7630,  7652,  7675,  7682,  7696,
        7722,  7752,  7761,  7765,  7796,  7809,  7831,  7858,  7912,
        7928,  7929,  7933,  7953,  7980,  8033,  8045,  8063,  8076,
        8101,  8104,  8117,  8129,  8134,  8160,  8167,  8222,  8232,
        8237,  8263,  8285,  8319,  8332,  8335,  8360,  8373,  8379,
        8381,  8383,  8395,  8471,  8479,  8487,  8525,  8545,  8554,
        8576,  8579,  8594,  8609,  8657,  8662,  8688,  8705,  8721,
        8725,  8738,  8746,  8775,  8799,  8818,  8893,  8910,  8931,
        8946,  8961,  9005,  9006,  9029,  9058,  9059,  9081,  9084,
        9093,  9107,  9136,  9175,  9246,  9250,  9260,  9282,  9312,
        9360,  9398,  9399,  9412,  9471,  9480,  9485,  9497,  9513,
        9554,  9562,  9600,  9610,  9629,  9645,  9675,  9676,  9700,
        9707,  9720,  9725,  9740,  9759,  9775,  9779,  9794,  9810,
        9814,  9835,  9892,  9902,  9939,  9944,  9963,  9988, 10030,
       10047, 10052, 10061, 10066, 10070, 10076, 10128, 10177, 10211,
       10215, 10258, 10272, 10281, 10298, 10335, 10338, 10351, 10369,
       10386, 10408, 10435, 10452, 10453, 10457, 10479, 10484, 10493,
       10504, 10546, 10589, 10604, 10608, 10629, 10642, 10665, 10670,
       10721, 10725, 10750, 10764, 10770, 10794, 10814, 10825, 10877,
       10923, 10932, 10946, 10973, 10979, 11024, 11025, 11116, 11126,
       11129, 11132, 11163, 11166, 11194, 11195, 11224, 11243, 11244,
       11255, 11274, 11297, 11324, 11337, 11342, 11359, 11408, 11472,
       11545, 11553, 11610, 11623, 11645, 11674, 11681, 11686, 11701,
       11714, 11738, 11827, 11849, 11854, 11874, 11877, 11912, 11939,
       12031, 12068, 12073, 12088, 12090, 12094, 12148, 12153, 12154,
       12171, 12208, 12234, 12253, 12283, 12313, 12325, 12340, 12387,
       12397, 12412, 12414, 12426, 12441, 12453, 12458, 12510, 12523,
       12557, 12558, 12561, 12658, 12661, 12688, 12699, 12715, 12719,
       12721, 12743, 12753, 12818, 12845, 12876, 12885, 12916, 12974,
       12980, 12986, 13072, 13094, 13102, 13110, 13120, 13159, 13162,
       13167, 13173, 13224, 13229, 13248, 13258, 13292, 13296, 13300,
       13303, 13320, 13337, 13340, 13407, 13409, 13420, 13464, 13528,
       13601, 13606, 13615, 13617, 13619, 13680, 13707, 13708, 13717,
       13724, 13734, 13799, 13841, 13890, 13942, 13945, 13955, 13976,
       13991, 13999, 14079, 14112, 14121, 14122, 14154, 14174, 14222,
       14235, 14237, 14255, 14258, 14266, 14267, 14278, 14295, 14418,
       14421, 14461, 14506, 14514, 14520, 14559, 14567, 14579, 14594,
       14604, 14634, 14743, 14775, 14776, 14811, 14824, 14836, 14898,
       14933, 14943, 14950, 14970, 14979, 14985, 15005, 15006, 15037,
       15078, 15084, 15090, 15091, 15111, 15112, 15141, 15156, 15166,
       15182, 15183, 15185, 15194, 15197, 15200, 15229, 15245, 15257,
       15288, 15295, 15303, 15324, 15340, 15352, 15402, 15423, 15424,
       15427, 15443, 15482, 15484, 15519, 15547, 15571, 15592, 15597,
       15608, 15613, 15712, 15728, 15752, 15822, 15840, 15841, 15912,
       15915, 15950, 15969, 15978, 15995, 16023, 16029, 16045, 16054,
       16058, 16066, 16086, 16138, 16148, 16202, 16206, 16211, 16235,
       16238, 16247, 16259, 16292, 16307, 16449, 16467, 16515]),)
(16522, 16522)
(15740, 16522)
(15740, 15740)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.5369620323181152s
The HC Re-cluster result: num cluster = 1414(model) // 1378(model_ema) 	 num outliers = 782(model) // 1059(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.125169277191162s
The UCIS result: num clean cluster = 1364(model) 	 num outliers = 1831(model)
mdoel:new class are [1365], length of new dataset is 14691
Epoch: [9][0/300]	Time 3.584 (3.584)	Data 1.274 (1.274)	Loss_ce_clean 0.086 	Loss_ct_clean 0.075 	Prec 99.22%
Epoch: [9][50/300]	Time 1.472 (1.685)	Data 0.802 (0.986)	Loss_ce_clean 0.099 	Loss_ct_clean 0.124 	Prec 98.87%
Epoch: [9][100/300]	Time 0.904 (1.475)	Data 0.239 (0.792)	Loss_ce_clean 0.098 	Loss_ct_clean 0.230 	Prec 98.87%
Epoch: [9][150/300]	Time 0.899 (1.322)	Data 0.233 (0.645)	Loss_ce_clean 0.094 	Loss_ct_clean 0.255 	Prec 98.98%
Epoch: [9][200/300]	Time 0.864 (1.205)	Data 0.198 (0.530)	Loss_ce_clean 0.092 	Loss_ct_clean 0.267 	Prec 99.05%
Epoch: [9][250/300]	Time 0.913 (1.129)	Data 0.247 (0.457)	Loss_ce_clean 0.091 	Loss_ct_clean 0.269 	Prec 99.10%
Extract Features: [100/156]	Time 0.157 (0.168)	Data 0.000 (0.010)	
Mean AP: 52.7%
CMC Scores:
  top-1          69.9%
  top-5          80.8%
  top-10         84.9%
Extract Features: [100/156]	Time 0.162 (0.164)	Data 0.005 (0.008)	
Mean AP: 53.8%
CMC Scores:
  top-1          70.2%
  top-5          81.0%
  top-10         85.1%

 * Finished epoch   9  model no.1 mAP: 52.7% model no.2(mean-net) mAP: 53.8%  best: 53.8% *

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.167)	Data 0.000 (0.011)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.715534210205078
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.181)	Data 0.000 (0.024)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.879207134246826
The orignal cluster result: num cluster = 1429(model) // 1391(model_ema) 	 num outliers = 740(model) // 918(model_ema)
Applying hierarchical clustering
[ 147 1094 1336 ... 1030 1140 1339]
(16522,)
(array([    6,     7,    19,    23,    75,    85,    97,   111,   161,
         176,   182,   183,   188,   199,   220,   241,   248,   257,
         269,   287,   338,   341,   356,   361,   383,   394,   400,
         402,   412,   414,   417,   437,   443,   460,   464,   472,
         480,   487,   519,   524,   531,   547,   573,   588,   592,
         596,   608,   637,   643,   644,   651,   676,   680,   689,
         714,   728,   743,   752,   754,   759,   761,   795,   827,
         832,   851,   861,   905,   911,   918,   957,  1037,  1047,
        1059,  1063,  1097,  1159,  1209,  1328,  1389,  1402,  1417,
        1473,  1494,  1531,  1573,  1594,  1605,  1618,  1635,  1644,
        1654,  1685,  1687,  1723,  1735,  1736,  1741,  1780,  1783,
        1812,  1833,  1849,  2057,  2119,  2127,  2148,  2170,  2185,
        2205,  2241,  2282,  2297,  2330,  2334,  2406,  2431,  2465,
        2494,  2501,  2567,  2684,  2690,  2710,  2724,  2750,  2754,
        2769,  2770,  2790,  2814,  2880,  2913,  2927,  2947,  2955,
        3030,  3036,  3037,  3045,  3073,  3077,  3090,  3107,  3118,
        3121,  3148,  3178,  3180,  3185,  3200,  3202,  3249,  3271,
        3302,  3306,  3318,  3337,  3388,  3392,  3404,  3448,  3480,
        3502,  3570,  3575,  3582,  3598,  3641,  3670,  3672,  3677,
        3685,  3695,  3713,  3716,  3764,  3774,  3812,  3842,  3908,
        3933,  3951,  4061,  4065,  4072,  4105,  4156,  4196,  4209,
        4221,  4242,  4247,  4248,  4249,  4251,  4257,  4311,  4319,
        4334,  4351,  4360,  4410,  4420,  4424,  4428,  4429,  4438,
        4440,  4448,  4484,  4487,  4528,  4539,  4566,  4609,  4628,
        4632,  4636,  4638,  4639,  4651,  4653,  4682,  4684,  4753,
        4764,  4774,  4798,  4849,  4902,  4914,  4921,  4939,  5016,
        5023,  5035,  5094,  5104,  5107,  5113,  5129,  5141,  5148,
        5180,  5184,  5220,  5255,  5267,  5279,  5280,  5298,  5302,
        5306,  5317,  5331,  5332,  5361,  5362,  5379,  5418,  5420,
        5440,  5513,  5524,  5526,  5534,  5546,  5558,  5563,  5578,
        5585,  5602,  5603,  5631,  5704,  5710,  5790,  5806,  5848,
        5849,  5853,  5869,  5899,  5912,  5913,  5945,  5995,  6028,
        6063,  6079,  6080,  6082,  6095,  6142,  6194,  6199,  6208,
        6211,  6261,  6296,  6322,  6442,  6443,  6447,  6450,  6556,
        6568,  6574,  6576,  6607,  6629,  6632,  6634,  6696,  6788,
        6818,  6820,  6825,  6827,  6837,  6859,  6860,  6876,  6883,
        6940,  6956,  6964,  7045,  7071,  7105,  7111,  7145,  7173,
        7181,  7211,  7214,  7282,  7307,  7336,  7389,  7395,  7427,
        7440,  7446,  7513,  7538,  7612,  7625,  7630,  7632,  7652,
        7655,  7682,  7696,  7748,  7752,  7765,  7796,  7831,  7842,
        7858,  7912,  7915,  7933,  7953,  7980,  8033,  8045,  8063,
        8101,  8104,  8117,  8134,  8160,  8167,  8195,  8222,  8237,
        8263,  8285,  8299,  8319,  8324,  8332,  8360,  8373,  8379,
        8381,  8383,  8392,  8395,  8471,  8479,  8487,  8525,  8554,
        8579,  8609,  8616,  8678,  8679,  8721,  8746,  8775,  8799,
        8818,  8893,  8931,  8946,  8947,  8973,  9005,  9058,  9059,
        9064,  9081,  9084,  9093,  9107,  9136,  9147,  9159,  9282,
        9300,  9312,  9360,  9399,  9471,  9480,  9485,  9497,  9504,
        9513,  9528,  9562,  9645,  9675,  9676,  9700,  9707,  9720,
        9725,  9733,  9740,  9759,  9771,  9779,  9810,  9835,  9930,
        9939,  9941,  9944,  9963,  9988, 10030, 10047, 10059, 10060,
       10061, 10070, 10076, 10111, 10140, 10154, 10177, 10211, 10213,
       10215, 10298, 10337, 10345, 10368, 10369, 10399, 10435, 10453,
       10457, 10479, 10493, 10504, 10546, 10588, 10589, 10604, 10608,
       10629, 10665, 10725, 10750, 10764, 10770, 10825, 10877, 10923,
       10932, 10973, 11024, 11025, 11116, 11129, 11152, 11166, 11224,
       11230, 11243, 11244, 11255, 11274, 11291, 11297, 11342, 11359,
       11408, 11441, 11461, 11463, 11472, 11504, 11545, 11553, 11566,
       11579, 11645, 11674, 11686, 11698, 11701, 11714, 11750, 11764,
       11767, 11798, 11827, 11849, 11854, 11858, 11874, 11877, 11912,
       11939, 11958, 11972, 12063, 12079, 12153, 12154, 12171, 12208,
       12234, 12253, 12283, 12286, 12313, 12339, 12340, 12387, 12397,
       12412, 12414, 12453, 12458, 12510, 12523, 12556, 12557, 12558,
       12585, 12658, 12661, 12699, 12715, 12721, 12743, 12759, 12818,
       12845, 12885, 12916, 12974, 12980, 13072, 13076, 13102, 13120,
       13157, 13159, 13162, 13167, 13173, 13190, 13200, 13201, 13224,
       13229, 13238, 13248, 13258, 13292, 13300, 13303, 13337, 13407,
       13418, 13464, 13489, 13528, 13534, 13545, 13566, 13601, 13606,
       13615, 13617, 13619, 13625, 13644, 13673, 13677, 13707, 13708,
       13717, 13724, 13731, 13734, 13799, 13890, 13990, 13991, 14079,
       14112, 14121, 14122, 14154, 14174, 14183, 14222, 14226, 14235,
       14255, 14258, 14266, 14267, 14278, 14418, 14461, 14520, 14521,
       14534, 14559, 14564, 14567, 14579, 14604, 14634, 14761, 14775,
       14776, 14810, 14812, 14822, 14824, 14865, 14877, 14943, 14950,
       14970, 14979, 14985, 15005, 15006, 15037, 15053, 15078, 15090,
       15100, 15111, 15141, 15156, 15161, 15166, 15182, 15183, 15185,
       15197, 15200, 15229, 15240, 15245, 15257, 15258, 15287, 15288,
       15292, 15295, 15324, 15402, 15407, 15424, 15432, 15443, 15474,
       15484, 15495, 15519, 15524, 15547, 15592, 15597, 15608, 15642,
       15653, 15678, 15728, 15731, 15752, 15840, 15841, 15851, 15887,
       15915, 15950, 15969, 15978, 15995, 16029, 16045, 16058, 16086,
       16138, 16149, 16202, 16211, 16238, 16259, 16290, 16307, 16442,
       16467, 16515]),)
(16522, 16522)
(15782, 16522)
(15782, 15782)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.5167086124420166s
The HC Re-cluster result: num cluster = 1429(model) // 1391(model_ema) 	 num outliers = 740(model) // 918(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.0106184482574463s
The UCIS result: num clean cluster = 1380(model) 	 num outliers = 1617(model)
mdoel:new class are [1381], length of new dataset is 14905
Epoch: [10][0/300]	Time 1.610 (1.610)	Data 0.202 (0.202)	Loss_ce_clean 0.078 	Loss_ct_clean 0.075 	Prec 99.22%
Epoch: [10][50/300]	Time 0.783 (1.408)	Data 0.113 (0.398)	Loss_ce_clean 0.086 	Loss_ct_clean 0.106 	Prec 98.93%
Epoch: [10][100/300]	Time 1.566 (1.231)	Data 0.108 (0.257)	Loss_ce_clean 0.086 	Loss_ct_clean 0.206 	Prec 99.02%
Epoch: [10][150/300]	Time 1.584 (1.340)	Data 0.116 (0.209)	Loss_ce_clean 0.087 	Loss_ct_clean 0.240 	Prec 99.02%
Epoch: [10][200/300]	Time 0.768 (1.245)	Data 0.102 (0.184)	Loss_ce_clean 0.088 	Loss_ct_clean 0.256 	Prec 99.05%
Epoch: [10][250/300]	Time 0.769 (1.151)	Data 0.103 (0.169)	Loss_ce_clean 0.088 	Loss_ct_clean 0.261 	Prec 99.08%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.159 (0.173)	Data 0.000 (0.013)	
Computing jaccard distance...
Jaccard distance computing time cost: 13.68972134590149
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.239)	Data 0.000 (0.069)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.026821374893188
The orignal cluster result: num cluster = 1432(model) // 1417(model_ema) 	 num outliers = 648(model) // 886(model_ema)
Applying hierarchical clustering
[ 280 1175  999 ... 1300 1054 1400]
(16522,)
(array([    6,     7,    19,    39,    75,    85,    97,   111,   161,
         182,   183,   188,   199,   207,   220,   241,   248,   257,
         269,   287,   338,   341,   356,   400,   412,   417,   436,
         437,   443,   460,   464,   472,   519,   531,   547,   588,
         608,   643,   651,   676,   689,   714,   728,   735,   754,
         759,   808,   827,   832,   851,   854,   861,   905,   918,
         951,   957,  1020,  1030,  1037,  1059,  1063,  1098,  1263,
        1374,  1402,  1413,  1417,  1494,  1573,  1635,  1644,  1654,
        1670,  1685,  1735,  1736,  1746,  1769,  1780,  1817,  1833,
        1835,  1837,  1931,  2127,  2133,  2147,  2148,  2170,  2185,
        2205,  2291,  2299,  2319,  2330,  2334,  2406,  2438,  2465,
        2486,  2559,  2662,  2724,  2732,  2754,  2769,  2790,  2814,
        2818,  2858,  2889,  2913,  2947,  3015,  3027,  3030,  3037,
        3046,  3073,  3077,  3090,  3107,  3117,  3121,  3126,  3178,
        3202,  3271,  3318,  3330,  3337,  3448,  3480,  3502,  3570,
        3575,  3582,  3598,  3615,  3641,  3672,  3713,  3716,  3728,
        3764,  3774,  3794,  3812,  3842,  3908,  3933,  3951,  3956,
        4045,  4072,  4105,  4156,  4161,  4221,  4242,  4248,  4249,
        4254,  4311,  4319,  4334,  4351,  4393,  4424,  4429,  4438,
        4440,  4539,  4566,  4609,  4628,  4632,  4639,  4651,  4653,
        4663,  4682,  4685,  4747,  4753,  4764,  4774,  4798,  4828,
        4902,  4914,  4921,  4939,  5016,  5023,  5035,  5107,  5129,
        5180,  5184,  5220,  5233,  5239,  5267,  5279,  5280,  5298,
        5317,  5332,  5361,  5362,  5367,  5379,  5394,  5398,  5418,
        5420,  5440,  5492,  5513,  5524,  5546,  5558,  5563,  5567,
        5578,  5585,  5602,  5603,  5631,  5702,  5807,  5816,  5843,
        5848,  5849,  5894,  5913,  6011,  6023,  6028,  6063,  6067,
        6080,  6132,  6134,  6144,  6194,  6199,  6208,  6211,  6261,
        6301,  6322,  6410,  6442,  6443,  6447,  6450,  6491,  6540,
        6541,  6568,  6607,  6632,  6658,  6666,  6738,  6788,  6860,
        6883,  6898,  6911,  6964,  7045,  7059,  7100,  7110,  7111,
        7145,  7168,  7173,  7181,  7211,  7214,  7218,  7245,  7282,
        7323,  7332,  7336,  7389,  7395,  7513,  7538,  7542,  7565,
        7612,  7625,  7630,  7652,  7682,  7696,  7761,  7765,  7796,
        7831,  7858,  7953,  7980,  7991,  8033,  8045,  8063,  8117,
        8129,  8221,  8222,  8237,  8263,  8285,  8299,  8332,  8373,
        8379,  8381,  8383,  8392,  8395,  8428,  8458,  8471,  8479,
        8487,  8523,  8525,  8529,  8554,  8576,  8609,  8650,  8657,
        8662,  8688,  8697,  8721,  8746,  8775,  8799,  8818,  8892,
        8893,  8897,  8910,  8931,  8946,  8947,  8971,  8973,  9023,
        9052,  9059,  9064,  9081,  9084,  9093,  9107,  9136,  9159,
        9282,  9288,  9312,  9360,  9398,  9399,  9416,  9471,  9485,
        9497,  9513,  9535,  9562,  9610,  9675,  9707,  9720,  9725,
        9779,  9810,  9835,  9939,  9944,  9963, 10007, 10030, 10047,
       10059, 10061, 10070, 10072, 10076, 10213, 10215, 10245, 10338,
       10399, 10408, 10435, 10445, 10453, 10457, 10479, 10492, 10493,
       10533, 10546, 10589, 10604, 10613, 10682, 10725, 10750, 10762,
       10764, 10770, 10800, 10825, 10923, 10932, 10946, 10973, 11024,
       11025, 11112, 11116, 11166, 11195, 11224, 11235, 11255, 11274,
       11275, 11297, 11359, 11408, 11420, 11472, 11553, 11610, 11622,
       11639, 11645, 11681, 11686, 11698, 11701, 11714, 11767, 11827,
       11858, 11874, 11877, 11905, 11912, 11939, 11972, 12031, 12063,
       12068, 12148, 12153, 12154, 12164, 12208, 12253, 12313, 12392,
       12394, 12412, 12414, 12434, 12441, 12449, 12458, 12491, 12510,
       12550, 12556, 12557, 12585, 12614, 12658, 12661, 12688, 12699,
       12715, 12721, 12743, 12753, 12759, 12805, 12818, 12916, 12974,
       12980, 13072, 13076, 13099, 13102, 13120, 13134, 13136, 13153,
       13190, 13218, 13223, 13224, 13247, 13271, 13292, 13296, 13300,
       13303, 13320, 13321, 13337, 13356, 13368, 13407, 13464, 13489,
       13528, 13601, 13606, 13615, 13619, 13625, 13629, 13673, 13677,
       13707, 13717, 13724, 13734, 13841, 13890, 13945, 13976, 13990,
       13991, 14044, 14079, 14112, 14121, 14122, 14154, 14174, 14183,
       14222, 14235, 14237, 14255, 14266, 14269, 14278, 14418, 14425,
       14461, 14506, 14520, 14521, 14564, 14579, 14634, 14680, 14708,
       14775, 14776, 14822, 14824, 14865, 14877, 14970, 14985, 15006,
       15037, 15053, 15066, 15090, 15111, 15141, 15156, 15166, 15182,
       15183, 15185, 15197, 15200, 15229, 15245, 15292, 15295, 15312,
       15324, 15352, 15407, 15424, 15427, 15432, 15443, 15447, 15454,
       15474, 15484, 15495, 15519, 15524, 15547, 15592, 15597, 15608,
       15613, 15642, 15752, 15822, 15840, 15841, 15848, 15851, 15915,
       15969, 15978, 16029, 16045, 16058, 16086, 16110, 16138, 16202,
       16206, 16211, 16238, 16259, 16270, 16292, 16307, 16467, 16515]),)
(16522, 16522)
(15874, 16522)
(15874, 15874)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.473708152770996s
The HC Re-cluster result: num cluster = 1432(model) // 1417(model_ema) 	 num outliers = 648(model) // 886(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.5807666778564453s
The UCIS result: num clean cluster = 1386(model) 	 num outliers = 1568(model)
mdoel:new class are [1387], length of new dataset is 14954
Epoch: [11][0/300]	Time 3.467 (3.467)	Data 0.447 (0.447)	Loss_ce_clean 0.069 	Loss_ct_clean 0.064 	Prec 98.44%
Epoch: [11][50/300]	Time 0.772 (0.827)	Data 0.106 (0.116)	Loss_ce_clean 0.080 	Loss_ct_clean 0.099 	Prec 99.03%
Epoch: [11][100/300]	Time 0.768 (0.800)	Data 0.102 (0.111)	Loss_ce_clean 0.080 	Loss_ct_clean 0.203 	Prec 99.10%
Epoch: [11][150/300]	Time 0.766 (0.790)	Data 0.101 (0.109)	Loss_ce_clean 0.081 	Loss_ct_clean 0.238 	Prec 99.08%
Epoch: [11][200/300]	Time 0.776 (0.785)	Data 0.106 (0.107)	Loss_ce_clean 0.081 	Loss_ct_clean 0.244 	Prec 99.11%
Epoch: [11][250/300]	Time 0.765 (0.782)	Data 0.100 (0.107)	Loss_ce_clean 0.081 	Loss_ct_clean 0.252 	Prec 99.11%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.162 (0.165)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.564244747161865
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.167)	Data 0.000 (0.011)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.574456453323364
The orignal cluster result: num cluster = 1454(model) // 1425(model_ema) 	 num outliers = 585(model) // 755(model_ema)
Applying hierarchical clustering
[  89 1169  865 ...  506 1360 1224]
(16522,)
(array([   19,    23,    85,   111,   161,   182,   183,   188,   199,
         220,   241,   257,   269,   287,   341,   394,   400,   412,
         431,   437,   443,   460,   464,   472,   481,   499,   519,
         524,   531,   588,   608,   643,   651,   689,   728,   743,
         754,   808,   827,   851,   861,   903,   911,   918,   927,
         957,  1030,  1059,  1097,  1098,  1230,  1263,  1328,  1396,
        1402,  1413,  1417,  1494,  1528,  1605,  1644,  1654,  1685,
        1687,  1735,  1746,  1780,  1808,  1833,  1849,  1922,  1931,
        2057,  2119,  2127,  2170,  2182,  2205,  2241,  2284,  2319,
        2330,  2334,  2406,  2431,  2465,  2486,  2535,  2536,  2559,
        2589,  2680,  2684,  2690,  2710,  2732,  2754,  2769,  2814,
        2818,  2819,  2889,  2913,  2922,  2947,  3018,  3036,  3037,
        3045,  3077,  3090,  3114,  3117,  3120,  3142,  3143,  3178,
        3180,  3200,  3202,  3249,  3271,  3330,  3337,  3404,  3431,
        3448,  3502,  3571,  3575,  3577,  3582,  3593,  3615,  3641,
        3672,  3695,  3713,  3716,  3764,  3774,  3794,  3812,  3842,
        3908,  3918,  3933,  3941,  3956,  4065,  4072,  4094,  4105,
        4106,  4161,  4209,  4242,  4247,  4251,  4311,  4312,  4319,
        4334,  4351,  4360,  4428,  4438,  4440,  4539,  4566,  4609,
        4632,  4639,  4651,  4663,  4707,  4753,  4764,  4774,  4902,
        4914,  4921,  4939,  4941,  5016,  5023,  5042,  5094,  5104,
        5113,  5180,  5184,  5239,  5255,  5265,  5317,  5331,  5361,
        5362,  5379,  5420,  5440,  5513,  5524,  5534,  5546,  5558,
        5578,  5580,  5585,  5602,  5603,  5631,  5669,  5702,  5704,
        5773,  5816,  5848,  5849,  5912,  5913,  5926,  6040,  6060,
        6063,  6067,  6079,  6080,  6082,  6132,  6144,  6194,  6199,
        6208,  6301,  6322,  6442,  6447,  6467,  6568,  6574,  6576,
        6607,  6629,  6632,  6658,  6709,  6758,  6788,  6825,  6859,
        6860,  6883,  6964,  7059,  7105,  7110,  7145,  7181,  7211,
        7214,  7282,  7307,  7310,  7323,  7332,  7336,  7387,  7389,
        7395,  7513,  7538,  7565,  7612,  7630,  7632,  7652,  7655,
        7682,  7696,  7761,  7765,  7796,  7831,  7842,  7858,  7859,
        7882,  7912,  7933,  7980,  7985,  8033,  8045,  8063,  8076,
        8117,  8222,  8237,  8263,  8285,  8299,  8319,  8332,  8360,
        8373,  8379,  8383,  8395,  8523,  8525,  8554,  8576,  8609,
        8662,  8678,  8721,  8725,  8738,  8746,  8799,  8818,  8931,
        8937,  8947,  8961,  8973,  9005,  9025,  9058,  9059,  9064,
        9081,  9084,  9093,  9107,  9136,  9159,  9282,  9312,  9322,
        9398,  9399,  9471,  9480,  9485,  9497,  9528,  9562,  9610,
        9675,  9720,  9725,  9746,  9771,  9779,  9808,  9810,  9835,
        9892,  9902,  9922,  9930,  9939,  9963,  9978,  9991, 10007,
       10047, 10059, 10061, 10074, 10076, 10125, 10140, 10154, 10213,
       10215, 10258, 10275, 10298, 10338, 10399, 10408, 10435, 10445,
       10453, 10457, 10509, 10533, 10546, 10589, 10604, 10629, 10665,
       10697, 10750, 10764, 10770, 10800, 10814, 10825, 10877, 10932,
       10946, 10973, 11019, 11024, 11025, 11116, 11129, 11152, 11166,
       11194, 11195, 11201, 11255, 11274, 11275, 11297, 11324, 11359,
       11408, 11463, 11472, 11553, 11610, 11622, 11645, 11701, 11767,
       11785, 11827, 11858, 11899, 11912, 11927, 11934, 11939, 11972,
       12031, 12032, 12099, 12153, 12154, 12208, 12234, 12253, 12313,
       12414, 12449, 12453, 12458, 12459, 12491, 12510, 12556, 12557,
       12658, 12688, 12699, 12715, 12721, 12743, 12753, 12818, 12845,
       12885, 12916, 12974, 12980, 13035, 13099, 13102, 13120, 13162,
       13167, 13190, 13200, 13292, 13300, 13303, 13337, 13368, 13407,
       13489, 13545, 13606, 13619, 13629, 13673, 13677, 13708, 13713,
       13717, 13724, 13728, 13734, 13799, 13841, 13861, 13945, 13967,
       13976, 13991, 14044, 14079, 14101, 14112, 14121, 14122, 14174,
       14183, 14222, 14226, 14235, 14255, 14266, 14278, 14339, 14412,
       14461, 14579, 14604, 14634, 14680, 14708, 14763, 14775, 14776,
       14822, 14824, 14865, 14898, 14943, 14950, 14970, 14985, 15005,
       15053, 15090, 15100, 15141, 15156, 15166, 15182, 15185, 15197,
       15229, 15258, 15292, 15295, 15407, 15432, 15443, 15484, 15547,
       15577, 15592, 15608, 15626, 15642, 15712, 15731, 15752, 15841,
       15851, 15915, 15969, 15995, 16029, 16045, 16058, 16066, 16086,
       16138, 16206, 16211, 16238, 16259, 16290, 16307, 16442, 16467]),)
(16522, 16522)
(15937, 16522)
(15937, 15937)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1865170001983643s
The HC Re-cluster result: num cluster = 1454(model) // 1425(model_ema) 	 num outliers = 585(model) // 755(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8274123668670654s
The UCIS result: num clean cluster = 1423(model) 	 num outliers = 1205(model)
mdoel:new class are [1424], length of new dataset is 15317
Epoch: [12][0/300]	Time 0.791 (0.791)	Data 0.120 (0.120)	Loss_ce_clean 0.174 	Loss_ct_clean 0.164 	Prec 97.66%
Epoch: [12][50/300]	Time 0.777 (0.771)	Data 0.112 (0.106)	Loss_ce_clean 0.091 	Loss_ct_clean 0.102 	Prec 98.70%
Epoch: [12][100/300]	Time 0.765 (0.790)	Data 0.100 (0.106)	Loss_ce_clean 0.086 	Loss_ct_clean 0.201 	Prec 98.86%
Epoch: [12][150/300]	Time 1.696 (0.915)	Data 0.291 (0.118)	Loss_ce_clean 0.083 	Loss_ct_clean 0.227 	Prec 99.03%
Epoch: [12][200/300]	Time 0.777 (0.955)	Data 0.106 (0.123)	Loss_ce_clean 0.081 	Loss_ct_clean 0.237 	Prec 99.11%
Epoch: [12][250/300]	Time 0.776 (0.919)	Data 0.111 (0.120)	Loss_ce_clean 0.079 	Loss_ct_clean 0.238 	Prec 99.18%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.158 (0.167)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.712651491165161
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.581579208374023
The orignal cluster result: num cluster = 1469(model) // 1440(model_ema) 	 num outliers = 510(model) // 646(model_ema)
Applying hierarchical clustering
[ 171 1336 1378 ...  910 1150  796]
(16522,)
(array([   23,    75,    85,    97,   111,   182,   188,   199,   220,
         231,   241,   248,   269,   276,   287,   338,   341,   394,
         412,   417,   437,   443,   472,   481,   499,   519,   524,
         531,   583,   608,   643,   651,   676,   689,   714,   728,
         754,   808,   851,   861,   911,   918,  1030,  1043,  1059,
        1063,  1098,  1246,  1402,  1413,  1439,  1473,  1494,  1594,
        1635,  1644,  1687,  1735,  1780,  1833,  1849,  1931,  2127,
        2170,  2185,  2205,  2241,  2282,  2330,  2334,  2406,  2431,
        2465,  2584,  2662,  2710,  2724,  2732,  2754,  2790,  2814,
        2818,  2862,  2889,  2913,  2922,  2947,  2983,  3030,  3036,
        3037,  3046,  3073,  3077,  3090,  3142,  3178,  3200,  3249,
        3271,  3304,  3330,  3337,  3370,  3404,  3414,  3431,  3448,
        3502,  3540,  3570,  3575,  3577,  3582,  3593,  3615,  3672,
        3695,  3713,  3716,  3749,  3764,  3794,  3842,  3873,  3933,
        3951,  4037,  4045,  4065,  4072,  4105,  4106,  4156,  4161,
        4221,  4242,  4247,  4249,  4251,  4311,  4312,  4319,  4334,
        4351,  4360,  4424,  4428,  4429,  4438,  4440,  4484,  4527,
        4539,  4566,  4609,  4628,  4632,  4639,  4651,  4653,  4696,
        4776,  4914,  4921,  5008,  5016,  5023,  5035,  5104,  5113,
        5180,  5184,  5229,  5239,  5265,  5298,  5331,  5332,  5361,
        5362,  5379,  5418,  5440,  5513,  5534,  5546,  5578,  5580,
        5585,  5603,  5631,  5669,  5730,  5750,  5816,  5843,  5848,
        5872,  5926,  5943,  6067,  6079,  6080,  6082,  6144,  6194,
        6239,  6301,  6322,  6442,  6447,  6467,  6556,  6576,  6709,
        6788,  6825,  6860,  6883,  6957,  6964,  7111,  7115,  7130,
        7145,  7173,  7181,  7211,  7214,  7323,  7332,  7336,  7387,
        7389,  7395,  7427,  7513,  7538,  7565,  7612,  7630,  7632,
        7652,  7655,  7682,  7696,  7765,  7796,  7817,  7831,  7858,
        7933,  7980,  7985,  8045,  8129,  8134,  8222,  8237,  8263,
        8285,  8299,  8319,  8360,  8379,  8471,  8487,  8523,  8525,
        8554,  8576,  8579,  8609,  8662,  8688,  8697,  8721,  8738,
        8799,  8818,  8825,  8893,  8910,  8931,  8947,  8973,  9005,
        9025,  9064,  9081,  9084,  9093,  9107,  9159,  9282,  9312,
        9322,  9360,  9398,  9399,  9427,  9471,  9480,  9528,  9562,
        9610,  9675,  9679,  9707,  9740,  9743,  9746,  9775,  9794,
        9810,  9835,  9944,  9978, 10007, 10047, 10059, 10061, 10070,
       10074, 10076, 10140, 10154, 10177, 10213, 10258, 10408, 10435,
       10479, 10533, 10589, 10604, 10628, 10697, 10749, 10750, 10764,
       10770, 10825, 10933, 10946, 10973, 11024, 11025, 11116, 11129,
       11166, 11194, 11195, 11255, 11274, 11297, 11324, 11342, 11359,
       11408, 11441, 11472, 11610, 11674, 11698, 11767, 11790, 11827,
       11854, 11858, 11863, 11874, 11912, 11939, 11967, 12031, 12032,
       12153, 12154, 12208, 12210, 12234, 12253, 12340, 12394, 12412,
       12414, 12449, 12453, 12491, 12500, 12510, 12537, 12548, 12550,
       12556, 12557, 12597, 12658, 12688, 12699, 12715, 12721, 12743,
       12753, 12902, 12980, 13035, 13099, 13102, 13108, 13120, 13134,
       13153, 13190, 13200, 13224, 13258, 13292, 13300, 13320, 13528,
       13533, 13601, 13615, 13619, 13699, 13717, 13731, 13734, 13841,
       13861, 13890, 13945, 13967, 13976, 13991, 14044, 14079, 14101,
       14112, 14121, 14122, 14174, 14183, 14222, 14226, 14235, 14255,
       14278, 14339, 14461, 14564, 14579, 14603, 14634, 14708, 14761,
       14775, 14776, 14865, 14877, 14970, 14985, 14999, 15005, 15090,
       15111, 15141, 15156, 15161, 15183, 15185, 15197, 15229, 15292,
       15295, 15407, 15424, 15432, 15443, 15447, 15484, 15519, 15547,
       15592, 15642, 15653, 15736, 15752, 15822, 15841, 15851, 15877,
       15915, 15969, 15978, 16029, 16045, 16092, 16202, 16211, 16238,
       16259, 16270, 16290, 16292, 16307, 16467]),)
(16522, 16522)
(16012, 16522)
(16012, 16012)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.140716791152954s
The HC Re-cluster result: num cluster = 1469(model) // 1440(model_ema) 	 num outliers = 510(model) // 646(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8562958240509033s
The UCIS result: num clean cluster = 1432(model) 	 num outliers = 1204(model)
mdoel:new class are [1433], length of new dataset is 15318
Epoch: [13][0/300]	Time 0.802 (0.802)	Data 0.130 (0.130)	Loss_ce_clean 0.039 	Loss_ct_clean 0.039 	Prec 99.22%
Epoch: [13][50/300]	Time 0.767 (0.772)	Data 0.102 (0.106)	Loss_ce_clean 0.071 	Loss_ct_clean 0.077 	Prec 99.16%
Epoch: [13][100/300]	Time 0.774 (0.772)	Data 0.108 (0.106)	Loss_ce_clean 0.076 	Loss_ct_clean 0.178 	Prec 98.99%
Epoch: [13][150/300]	Time 0.771 (0.771)	Data 0.105 (0.105)	Loss_ce_clean 0.077 	Loss_ct_clean 0.212 	Prec 99.04%
Epoch: [13][200/300]	Time 0.767 (0.771)	Data 0.101 (0.105)	Loss_ce_clean 0.077 	Loss_ct_clean 0.224 	Prec 99.10%
Epoch: [13][250/300]	Time 1.534 (0.811)	Data 0.111 (0.105)	Loss_ce_clean 0.078 	Loss_ct_clean 0.229 	Prec 99.10%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.162 (0.173)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.916351795196533
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.247)	Data 0.000 (0.090)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.724524974822998
The orignal cluster result: num cluster = 1485(model) // 1453(model_ema) 	 num outliers = 499(model) // 617(model_ema)
Applying hierarchical clustering
[ 836 1269 1434 ... 1190  968 1449]
(16522,)
(array([    6,    19,    75,    97,   111,   182,   183,   188,   199,
         207,   220,   241,   257,   269,   287,   338,   341,   394,
         412,   437,   443,   472,   519,   524,   531,   588,   608,
         617,   643,   651,   689,   728,   754,   808,   826,   861,
         907,   911,   918,  1030,  1042,  1053,  1059,  1063,  1098,
        1140,  1149,  1300,  1396,  1402,  1413,  1417,  1494,  1644,
        1672,  1685,  1687,  1703,  1735,  1796,  1833,  1849,  2127,
        2205,  2241,  2281,  2284,  2330,  2334,  2349,  2406,  2431,
        2441,  2474,  2486,  2680,  2684,  2696,  2710,  2714,  2724,
        2741,  2758,  2769,  2790,  2814,  2818,  2850,  2889,  2913,
        2947,  3030,  3037,  3046,  3073,  3077,  3090,  3142,  3143,
        3178,  3249,  3271,  3304,  3306,  3330,  3337,  3377,  3414,
        3431,  3448,  3502,  3540,  3575,  3582,  3641,  3695,  3713,
        3716,  3764,  3774,  3794,  3803,  3842,  3887,  3918,  3933,
        4072,  4094,  4098,  4105,  4161,  4221,  4242,  4249,  4251,
        4319,  4334,  4351,  4358,  4360,  4400,  4424,  4428,  4429,
        4438,  4440,  4484,  4539,  4628,  4639,  4651,  4682,  4685,
        4696,  4774,  4776,  4798,  4849,  4902,  4914,  4958,  5008,
        5016,  5023,  5035,  5066,  5104,  5174,  5180,  5184,  5265,
        5267,  5289,  5297,  5331,  5361,  5362,  5403,  5418,  5440,
        5513,  5526,  5534,  5546,  5563,  5578,  5580,  5585,  5603,
        5631,  5702,  5748,  5750,  5763,  5816,  5848,  5872,  5894,
        5912,  5926,  6071,  6079,  6080,  6082,  6126,  6144,  6194,
        6199,  6239,  6332,  6346,  6447,  6467,  6562,  6568,  6629,
        6709,  6788,  6826,  6859,  6860,  6883,  6964,  7059,  7105,
        7111,  7130,  7145,  7168,  7181,  7211,  7214,  7282,  7332,
        7336,  7389,  7427,  7513,  7528,  7538,  7565,  7573,  7625,
        7630,  7652,  7682,  7721,  7765,  7796,  7805,  7831,  7842,
        7858,  7933,  7980,  7985,  8045,  8129,  8222,  8237,  8263,
        8285,  8299,  8319,  8332,  8360,  8373,  8379,  8471,  8487,
        8523,  8525,  8609,  8646,  8688,  8697,  8705,  8721,  8799,
        8818,  8893,  8931,  8973,  9005,  9006,  9081,  9084,  9093,
        9107,  9136,  9159,  9183,  9282,  9316,  9399,  9416,  9471,
        9554,  9562,  9585,  9610,  9675,  9740,  9743,  9746,  9775,
        9794,  9810,  9835,  9944,  9963,  9978, 10007, 10059, 10061,
       10076, 10125, 10140, 10154, 10172, 10177, 10213, 10237, 10399,
       10408, 10479, 10493, 10589, 10604, 10665, 10677, 10697, 10750,
       10764, 10770, 10814, 10825, 10865, 10877, 10933, 10973, 11024,
       11025, 11116, 11129, 11255, 11324, 11342, 11354, 11408, 11441,
       11553, 11622, 11623, 11693, 11714, 11767, 11818, 11849, 11858,
       11863, 11874, 11939, 11972, 12044, 12154, 12164, 12234, 12240,
       12253, 12329, 12387, 12391, 12412, 12414, 12449, 12458, 12491,
       12510, 12537, 12557, 12661, 12699, 12715, 12721, 12743, 12818,
       12833, 12879, 12902, 12949, 12980, 13035, 13072, 13102, 13120,
       13162, 13190, 13200, 13224, 13235, 13258, 13292, 13296, 13300,
       13303, 13337, 13407, 13420, 13464, 13545, 13606, 13615, 13619,
       13629, 13630, 13724, 13734, 13791, 13841, 13861, 13903, 13945,
       13976, 13991, 14044, 14059, 14079, 14112, 14121, 14122, 14222,
       14226, 14235, 14255, 14278, 14339, 14421, 14459, 14461, 14519,
       14520, 14564, 14579, 14593, 14623, 14634, 14775, 14777, 14822,
       14865, 14943, 14950, 14970, 14999, 15005, 15037, 15053, 15076,
       15090, 15111, 15141, 15156, 15166, 15182, 15183, 15185, 15197,
       15200, 15229, 15258, 15295, 15303, 15333, 15407, 15432, 15443,
       15447, 15516, 15519, 15592, 15608, 15731, 15736, 15841, 15851,
       15915, 15969, 15995, 16029, 16058, 16138, 16202, 16206, 16211,
       16259, 16307, 16467, 16475]),)
(16522, 16522)
(16023, 16522)
(16023, 16023)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.284421682357788s
The HC Re-cluster result: num cluster = 1485(model) // 1453(model_ema) 	 num outliers = 499(model) // 617(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8679132461547852s
The UCIS result: num clean cluster = 1458(model) 	 num outliers = 1082(model)
mdoel:new class are [1459], length of new dataset is 15440
Epoch: [14][0/300]	Time 1.586 (1.586)	Data 0.241 (0.241)	Loss_ce_clean 0.078 	Loss_ct_clean 0.073 	Prec 99.22%
Epoch: [14][50/300]	Time 0.857 (1.115)	Data 0.186 (0.114)	Loss_ce_clean 0.079 	Loss_ct_clean 0.083 	Prec 98.84%
Epoch: [14][100/300]	Time 0.780 (1.125)	Data 0.109 (0.138)	Loss_ce_clean 0.075 	Loss_ct_clean 0.173 	Prec 99.03%
Epoch: [14][150/300]	Time 0.789 (1.090)	Data 0.123 (0.209)	Loss_ce_clean 0.074 	Loss_ct_clean 0.203 	Prec 99.09%
Epoch: [14][200/300]	Time 1.576 (1.196)	Data 0.117 (0.185)	Loss_ce_clean 0.073 	Loss_ct_clean 0.216 	Prec 99.13%
Epoch: [14][250/300]	Time 0.942 (1.215)	Data 0.122 (0.171)	Loss_ce_clean 0.073 	Loss_ct_clean 0.220 	Prec 99.18%
Extract Features: [100/156]	Time 0.167 (0.205)	Data 0.000 (0.022)	
Mean AP: 50.3%
CMC Scores:
  top-1          68.1%
  top-5          80.1%
  top-10         83.8%
Extract Features: [100/156]	Time 0.156 (0.192)	Data 0.000 (0.011)	
Mean AP: 53.6%
CMC Scores:
  top-1          70.2%
  top-5          81.3%
  top-10         85.2%

 * Finished epoch  14  model no.1 mAP: 50.3% model no.2(mean-net) mAP: 53.6%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.165)	Data 0.000 (0.009)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.708033323287964
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.563011646270752
The orignal cluster result: num cluster = 1501(model) // 1465(model_ema) 	 num outliers = 473(model) // 527(model_ema)
Applying hierarchical clustering
[ 578 1318  774 ... 1282 1193 1468]
(16522,)
(array([    7,    19,    23,    75,    76,    85,    97,   111,   133,
         182,   183,   188,   199,   220,   248,   257,   269,   271,
         287,   383,   394,   412,   464,   472,   481,   486,   499,
         531,   547,   588,   608,   643,   651,   689,   714,   728,
         754,   808,   832,   851,   861,   874,   893,   911,   918,
         927,  1042,  1053,  1059,  1063,  1098,  1140,  1228,  1246,
        1300,  1396,  1402,  1417,  1528,  1634,  1644,  1672,  1685,
        1715,  1735,  1796,  1833,  1849,  1916,  1931,  2057,  2119,
        2127,  2170,  2199,  2205,  2319,  2330,  2332,  2334,  2406,
        2441,  2465,  2567,  2584,  2680,  2684,  2710,  2750,  2758,
        2790,  2818,  2850,  2913,  2947,  2983,  3030,  3036,  3037,
        3046,  3073,  3077,  3178,  3271,  3330,  3377,  3448,  3454,
        3480,  3489,  3540,  3571,  3582,  3641,  3672,  3716,  3749,
        3764,  3779,  3794,  3803,  3842,  3873,  3887,  4072,  4105,
        4161,  4177,  4242,  4249,  4251,  4311,  4319,  4334,  4351,
        4358,  4360,  4400,  4424,  4440,  4527,  4566,  4639,  4651,
        4653,  4685,  4696,  4776,  4798,  4849,  4914,  4934,  4939,
        4958,  5008,  5016,  5023,  5104,  5174,  5180,  5184,  5220,
        5255,  5265,  5267,  5289,  5297,  5331,  5361,  5362,  5418,
        5438,  5440,  5513,  5546,  5567,  5578,  5580,  5585,  5603,
        5631,  5763,  5816,  5848,  5849,  5869,  5872,  5893,  5894,
        5912,  5926,  5943,  6067,  6079,  6080,  6082,  6194,  6199,
        6301,  6322,  6467,  6568,  6574,  6629,  6709,  6785,  6788,
        6825,  6859,  6860,  6934,  6957,  7045,  7105,  7115,  7130,
        7145,  7168,  7181,  7211,  7214,  7282,  7389,  7395,  7513,
        7515,  7528,  7538,  7573,  7612,  7625,  7630,  7652,  7682,
        7765,  7796,  7805,  7858,  7933,  7980,  8045,  8063,  8117,
        8178,  8222,  8237,  8263,  8285,  8332,  8392,  8471,  8487,
        8497,  8525,  8554,  8608,  8609,  8616,  8688,  8721,  8799,
        8818,  8893,  8897,  8931,  8947,  9005,  9006,  9064,  9081,
        9084,  9093,  9107,  9159,  9282,  9312,  9360,  9398,  9399,
        9416,  9471,  9480,  9528,  9562,  9610,  9675,  9676,  9720,
        9743,  9746,  9771,  9775,  9810,  9835,  9930,  9939,  9944,
        9963,  9978, 10047, 10059, 10061, 10140, 10154, 10188, 10213,
       10215, 10298, 10399, 10408, 10453, 10479, 10493, 10533, 10589,
       10604, 10665, 10677, 10750, 10764, 10770, 10814, 10825, 10865,
       10877, 10923, 10932, 10933, 11024, 11025, 11194, 11195, 11255,
       11297, 11359, 11383, 11441, 11463, 11496, 11610, 11622, 11623,
       11631, 11693, 11714, 11767, 11827, 11849, 11858, 11863, 11874,
       11939, 11940, 11972, 12044, 12090, 12118, 12153, 12154, 12208,
       12210, 12253, 12340, 12387, 12391, 12394, 12412, 12414, 12449,
       12491, 12510, 12537, 12556, 12557, 12614, 12658, 12715, 12721,
       12743, 12806, 12833, 12879, 12885, 12908, 12980, 13035, 13099,
       13102, 13120, 13190, 13258, 13292, 13296, 13320, 13337, 13420,
       13601, 13606, 13615, 13619, 13724, 13734, 13861, 13903, 13976,
       13990, 14044, 14079, 14112, 14122, 14154, 14174, 14183, 14222,
       14226, 14235, 14255, 14278, 14295, 14301, 14339, 14461, 14520,
       14579, 14593, 14594, 14623, 14634, 14708, 14761, 14777, 14822,
       14865, 14877, 14898, 14970, 14985, 15005, 15041, 15053, 15063,
       15076, 15090, 15141, 15156, 15166, 15185, 15197, 15229, 15258,
       15340, 15432, 15443, 15484, 15592, 15608, 15642, 15778, 15822,
       15841, 15876, 15915, 15969, 15995, 16058, 16086, 16138, 16202,
       16211, 16259, 16292, 16467, 16475]),)
(16522, 16522)
(16049, 16522)
(16049, 16049)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2707157135009766s
The HC Re-cluster result: num cluster = 1501(model) // 1465(model_ema) 	 num outliers = 473(model) // 527(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9182944297790527s
The UCIS result: num clean cluster = 1476(model) 	 num outliers = 972(model)
mdoel:new class are [1477], length of new dataset is 15550
Epoch: [15][0/300]	Time 0.791 (0.791)	Data 0.115 (0.115)	Loss_ce_clean 0.058 	Loss_ct_clean 0.052 	Prec 99.22%
Epoch: [15][50/300]	Time 0.771 (0.772)	Data 0.105 (0.106)	Loss_ce_clean 0.077 	Loss_ct_clean 0.081 	Prec 98.68%
Epoch: [15][100/300]	Time 0.778 (0.771)	Data 0.113 (0.105)	Loss_ce_clean 0.073 	Loss_ct_clean 0.167 	Prec 98.85%
Epoch: [15][150/300]	Time 0.778 (0.771)	Data 0.112 (0.105)	Loss_ce_clean 0.075 	Loss_ct_clean 0.195 	Prec 98.94%
Epoch: [15][200/300]	Time 0.771 (0.771)	Data 0.105 (0.105)	Loss_ce_clean 0.075 	Loss_ct_clean 0.207 	Prec 99.01%
Epoch: [15][250/300]	Time 0.779 (0.771)	Data 0.113 (0.105)	Loss_ce_clean 0.075 	Loss_ct_clean 0.213 	Prec 99.01%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.162 (0.166)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.650649785995483
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.63284945487976
The orignal cluster result: num cluster = 1516(model) // 1486(model_ema) 	 num outliers = 383(model) // 526(model_ema)
Applying hierarchical clustering
[ 472 1353  745 ...  824  899  901]
(16522,)
(array([    7,    85,   111,   145,   182,   199,   241,   247,   257,
         269,   287,   341,   394,   412,   437,   472,   524,   531,
         608,   651,   689,   754,   808,   851,   911,   918,  1030,
        1042,  1059,  1063,  1140,  1300,  1402,  1594,  1635,  1644,
        1672,  1796,  1849,  1944,  1971,  2057,  2127,  2133,  2205,
        2241,  2334,  2349,  2406,  2431,  2441,  2465,  2684,  2710,
        2724,  2750,  2758,  2790,  2818,  2913,  2947,  2983,  3036,
        3037,  3046,  3077,  3142,  3200,  3249,  3271,  3285,  3330,
        3337,  3414,  3431,  3448,  3454,  3507,  3540,  3575,  3582,
        3641,  3672,  3695,  3716,  3749,  3764,  3794,  3803,  3842,
        3918,  3933,  3961,  4065,  4072,  4105,  4242,  4249,  4251,
        4319,  4334,  4351,  4358,  4360,  4428,  4527,  4539,  4566,
        4639,  4651,  4685,  4696,  4798,  4902,  4914,  4987,  5016,
        5023,  5104,  5113,  5180,  5184,  5239,  5265,  5267,  5289,
        5297,  5331,  5361,  5440,  5513,  5524,  5534,  5578,  5580,
        5585,  5603,  5631,  5763,  5848,  5849,  5869,  5894,  5943,
        6067,  6079,  6080,  6113,  6144,  6194,  6199,  6239,  6322,
        6442,  6447,  6467,  6568,  6576,  6709,  6785,  6788,  6825,
        6859,  6860,  6876,  6883,  7045,  7059,  7105,  7111,  7130,
        7168,  7214,  7282,  7332,  7389,  7503,  7528,  7538,  7612,
        7630,  7652,  7682,  7796,  7859,  7933,  7980,  7985,  8129,
        8222,  8232,  8237,  8263,  8285,  8299,  8319,  8379,  8392,
        8471,  8487,  8497,  8525,  8566,  8576,  8697,  8705,  8799,
        8818,  8893,  8931,  8947,  9006,  9064,  9081,  9084,  9107,
        9159,  9282,  9312,  9399,  9416,  9427,  9471,  9480,  9505,
        9562,  9610,  9645,  9675,  9743,  9810,  9835,  9902,  9944,
       10047, 10059, 10061, 10140, 10154, 10213, 10335, 10399, 10408,
       10453, 10479, 10589, 10604, 10665, 10697, 10749, 10750, 10764,
       10770, 10814, 10825, 10877, 10932, 10933, 10946, 11024, 11025,
       11037, 11129, 11194, 11195, 11324, 11359, 11472, 11496, 11553,
       11610, 11623, 11693, 11757, 11767, 11827, 11849, 11858, 11863,
       11874, 11939, 11940, 11943, 11972, 12044, 12063, 12153, 12154,
       12208, 12391, 12412, 12414, 12416, 12491, 12510, 12557, 12715,
       12743, 12806, 12818, 12833, 12885, 12902, 12974, 12980, 13035,
       13072, 13102, 13120, 13190, 13292, 13300, 13303, 13320, 13340,
       13467, 13601, 13606, 13615, 13619, 13724, 13734, 13841, 13861,
       13976, 14044, 14079, 14122, 14154, 14183, 14222, 14226, 14235,
       14255, 14278, 14295, 14301, 14461, 14520, 14564, 14579, 14593,
       14623, 14634, 14670, 14763, 14865, 14877, 14898, 14950, 14999,
       15005, 15037, 15066, 15076, 15090, 15141, 15185, 15197, 15200,
       15229, 15258, 15292, 15432, 15443, 15484, 15547, 15608, 15626,
       15736, 15752, 15851, 15969, 15978, 16138, 16202, 16211, 16238,
       16259, 16334, 16442, 16467, 16475]),)
(16522, 16522)
(16139, 16522)
(16139, 16139)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1624841690063477s
The HC Re-cluster result: num cluster = 1516(model) // 1486(model_ema) 	 num outliers = 383(model) // 526(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.861356258392334s
The UCIS result: num clean cluster = 1495(model) 	 num outliers = 826(model)
mdoel:new class are [1496], length of new dataset is 15696
Epoch: [16][0/300]	Time 0.793 (0.793)	Data 0.122 (0.122)	Loss_ce_clean 0.052 	Loss_ct_clean 0.057 	Prec 100.00%
Epoch: [16][50/300]	Time 0.773 (0.770)	Data 0.107 (0.104)	Loss_ce_clean 0.070 	Loss_ct_clean 0.075 	Prec 99.08%
Epoch: [16][100/300]	Time 0.770 (0.770)	Data 0.104 (0.104)	Loss_ce_clean 0.070 	Loss_ct_clean 0.157 	Prec 99.13%
Epoch: [16][150/300]	Time 0.770 (0.769)	Data 0.104 (0.104)	Loss_ce_clean 0.070 	Loss_ct_clean 0.190 	Prec 99.16%
Epoch: [16][200/300]	Time 0.770 (0.770)	Data 0.104 (0.104)	Loss_ce_clean 0.070 	Loss_ct_clean 0.196 	Prec 99.18%
Epoch: [16][250/300]	Time 0.779 (0.770)	Data 0.113 (0.104)	Loss_ce_clean 0.068 	Loss_ct_clean 0.200 	Prec 99.24%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.634286642074585
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.585408926010132
The orignal cluster result: num cluster = 1520(model) // 1497(model_ema) 	 num outliers = 354(model) // 481(model_ema)
Applying hierarchical clustering
[ 454 1394  125 ... 1493  649  961]
(16522,)
(array([    7,   145,   182,   183,   188,   199,   213,   257,   269,
         394,   400,   412,   423,   437,   443,   472,   499,   519,
         531,   547,   588,   608,   651,   689,   754,   808,   851,
         861,   911,   918,  1030,  1042,  1059,  1063,  1140,  1228,
        1402,  1413,  1644,  1672,  1685,  1796,  1849,  1944,  2127,
        2205,  2241,  2330,  2332,  2334,  2365,  2406,  2431,  2441,
        2465,  2758,  2770,  2793,  2818,  2913,  2983,  3030,  3036,
        3037,  3077,  3097,  3121,  3142,  3178,  3249,  3271,  3330,
        3337,  3404,  3431,  3448,  3454,  3473,  3480,  3489,  3502,
        3571,  3575,  3672,  3695,  3716,  3764,  3794,  3842,  3918,
        3933,  4072,  4105,  4249,  4251,  4311,  4334,  4360,  4424,
        4428,  4440,  4463,  4527,  4609,  4639,  4653,  4682,  4685,
        4776,  4798,  4902,  4939,  5008,  5016,  5023,  5104,  5184,
        5239,  5265,  5267,  5297,  5331,  5379,  5418,  5440,  5513,
        5546,  5558,  5578,  5580,  5603,  5631,  5667,  5702,  5757,
        5763,  5816,  5848,  5894,  5943,  6065,  6067,  6079,  6080,
        6111,  6113,  6144,  6199,  6322,  6447,  6467,  6574,  6576,
        6788,  6860,  6883,  6934,  7059,  7145,  7168,  7181,  7214,
        7282,  7389,  7395,  7513,  7528,  7538,  7612,  7625,  7630,
        7652,  7725,  7796,  7805,  7831,  7858,  7882,  7933,  7980,
        8045,  8222,  8232,  8237,  8285,  8299,  8525,  8609,  8616,
        8688,  8697,  8705,  8799,  8818,  8824,  8881,  8893,  8931,
        8973,  9064,  9081,  9084,  9093,  9107,  9136,  9159,  9282,
        9312,  9399,  9416,  9471,  9480,  9562,  9610,  9675,  9775,
        9810,  9835,  9930,  9944, 10007, 10031, 10047, 10061, 10154,
       10177, 10188, 10213, 10319, 10408, 10479, 10493, 10589, 10604,
       10665, 10750, 10764, 10825, 10932, 10933, 10973, 10985, 11024,
       11025, 11116, 11166, 11194, 11195, 11255, 11297, 11324, 11365,
       11441, 11472, 11553, 11686, 11693, 11698, 11714, 11767, 11827,
       11874, 11912, 11939, 11972, 12044, 12083, 12153, 12154, 12208,
       12210, 12387, 12391, 12394, 12491, 12510, 12537, 12557, 12699,
       12721, 12743, 12779, 12802, 12806, 12818, 12833, 12974, 13035,
       13072, 13102, 13162, 13190, 13200, 13280, 13292, 13368, 13511,
       13545, 13553, 13601, 13606, 13724, 13734, 13861, 13976, 13991,
       14079, 14121, 14122, 14174, 14183, 14222, 14235, 14255, 14295,
       14301, 14418, 14461, 14520, 14593, 14634, 14877, 14898, 14985,
       15005, 15090, 15141, 15197, 15229, 15292, 15332, 15407, 15484,
       15592, 15608, 15642, 15712, 15736, 15841, 15847, 15876, 15978,
       15980, 16045, 16058, 16138, 16211, 16238, 16292, 16307, 16334,
       16467, 16475, 16480]),)
(16522, 16522)
(16168, 16522)
(16168, 16168)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1784543991088867s
The HC Re-cluster result: num cluster = 1520(model) // 1497(model_ema) 	 num outliers = 354(model) // 481(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8801758289337158s
The UCIS result: num clean cluster = 1500(model) 	 num outliers = 862(model)
mdoel:new class are [1501], length of new dataset is 15660
Epoch: [17][0/300]	Time 0.781 (0.781)	Data 0.112 (0.112)	Loss_ce_clean 0.035 	Loss_ct_clean 0.034 	Prec 99.22%
Epoch: [17][50/300]	Time 0.768 (0.768)	Data 0.102 (0.103)	Loss_ce_clean 0.060 	Loss_ct_clean 0.068 	Prec 99.34%
Epoch: [17][100/300]	Time 0.772 (0.769)	Data 0.107 (0.103)	Loss_ce_clean 0.063 	Loss_ct_clean 0.141 	Prec 99.22%
Epoch: [17][150/300]	Time 0.769 (0.769)	Data 0.103 (0.103)	Loss_ce_clean 0.064 	Loss_ct_clean 0.168 	Prec 99.27%
Epoch: [17][200/300]	Time 0.768 (0.769)	Data 0.102 (0.104)	Loss_ce_clean 0.065 	Loss_ct_clean 0.182 	Prec 99.28%
Epoch: [17][250/300]	Time 0.770 (0.769)	Data 0.104 (0.104)	Loss_ce_clean 0.065 	Loss_ct_clean 0.187 	Prec 99.30%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.647703170776367
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.697383403778076
The orignal cluster result: num cluster = 1541(model) // 1513(model_ema) 	 num outliers = 374(model) // 430(model_ema)
Applying hierarchical clustering
[ 823 1190  472 ... 1084 1211   -1]
(16522,)
(array([   75,    97,   145,   182,   188,   199,   207,   269,   287,
         394,   412,   437,   443,   472,   519,   547,   588,   608,
         643,   689,   723,   754,   761,   808,   851,   861,   903,
         911,   918,   965,   987,  1059,  1063,  1098,  1300,  1402,
        1417,  1528,  1644,  1796,  1849,  1944,  2127,  2140,  2170,
        2205,  2241,  2278,  2282,  2319,  2330,  2406,  2431,  2441,
        2465,  2684,  2710,  2724,  2732,  2758,  2760,  2818,  2913,
        2947,  2983,  3030,  3036,  3037,  3077,  3097,  3142,  3143,
        3178,  3180,  3249,  3271,  3304,  3330,  3431,  3441,  3448,
        3480,  3507,  3518,  3575,  3641,  3672,  3695,  3713,  3716,
        3764,  3775,  3794,  3803,  3842,  3851,  3933,  4072,  4105,
        4242,  4251,  4319,  4334,  4358,  4360,  4428,  4440,  4487,
        4527,  4539,  4566,  4651,  4747,  4774,  4902,  4914,  4921,
        4939,  4946,  5016,  5023,  5045,  5104,  5113,  5180,  5232,
        5239,  5265,  5267,  5331,  5379,  5440,  5505,  5513,  5534,
        5546,  5578,  5580,  5583,  5589,  5603,  5631,  5667,  5812,
        5848,  5872,  6079,  6126,  6144,  6199,  6301,  6322,  6409,
        6447,  6467,  6472,  6574,  6629,  6727,  6788,  6822,  6825,
        6859,  6860,  6876,  7105,  7130,  7181,  7211,  7214,  7282,
        7389,  7440,  7513,  7528,  7538,  7586,  7625,  7630,  7652,
        7796,  7882,  7933,  7980,  8117,  8129,  8186,  8222,  8232,
        8237,  8263,  8285,  8299,  8419,  8471,  8497,  8525,  8566,
        8576,  8594,  8678,  8688,  8705,  8799,  8893,  8909,  8931,
        8947,  9064,  9081,  9084,  9107,  9159,  9282,  9312,  9328,
        9399,  9471,  9480,  9528,  9562,  9610,  9675,  9743,  9752,
        9771,  9810,  9943,  9944, 10007, 10031, 10047, 10054, 10125,
       10154, 10177, 10212, 10298, 10319, 10408, 10445, 10453, 10479,
       10532, 10533, 10589, 10604, 10665, 10697, 10750, 10764, 10814,
       10825, 10932, 10933, 10967, 11024, 11025, 11027, 11116, 11129,
       11194, 11255, 11317, 11324, 11359, 11496, 11553, 11623, 11674,
       11693, 11698, 11757, 11767, 11849, 11874, 11939, 11972, 12045,
       12083, 12090, 12130, 12153, 12154, 12254, 12387, 12449, 12458,
       12491, 12510, 12557, 12721, 12806, 12939, 12980, 13035, 13072,
       13077, 13102, 13190, 13200, 13235, 13300, 13489, 13545, 13601,
       13606, 13615, 13630, 13724, 13734, 13805, 13861, 14079, 14112,
       14222, 14235, 14255, 14278, 14295, 14301, 14314, 14342, 14459,
       14461, 14512, 14534, 14578, 14579, 14593, 14634, 14670, 14763,
       14777, 14877, 14898, 14985, 14999, 15005, 15061, 15066, 15090,
       15166, 15178, 15185, 15197, 15245, 15258, 15292, 15303, 15407,
       15443, 15484, 15498, 15547, 15608, 15661, 15778, 15915, 15978,
       16045, 16078, 16086, 16098, 16138, 16202, 16238, 16259, 16290,
       16292, 16334, 16480, 16515, 16521]),)
(16522, 16522)
(16148, 16522)
(16148, 16148)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.0812337398529053s
The HC Re-cluster result: num cluster = 1541(model) // 1513(model_ema) 	 num outliers = 374(model) // 430(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8486082553863525s
The UCIS result: num clean cluster = 1514(model) 	 num outliers = 838(model)
mdoel:new class are [1515], length of new dataset is 15684
Epoch: [18][0/300]	Time 0.793 (0.793)	Data 0.123 (0.123)	Loss_ce_clean 0.070 	Loss_ct_clean 0.065 	Prec 99.22%
Epoch: [18][50/300]	Time 0.781 (0.772)	Data 0.115 (0.106)	Loss_ce_clean 0.059 	Loss_ct_clean 0.054 	Prec 99.33%
Epoch: [18][100/300]	Time 0.865 (0.939)	Data 0.199 (0.112)	Loss_ce_clean 0.063 	Loss_ct_clean 0.146 	Prec 99.32%
Epoch: [18][150/300]	Time 1.359 (1.065)	Data 0.693 (0.171)	Loss_ce_clean 0.063 	Loss_ct_clean 0.172 	Prec 99.31%
Epoch: [18][200/300]	Time 1.624 (1.091)	Data 0.110 (0.237)	Loss_ce_clean 0.064 	Loss_ct_clean 0.181 	Prec 99.27%
Epoch: [18][250/300]	Time 1.567 (1.189)	Data 0.109 (0.212)	Loss_ce_clean 0.066 	Loss_ct_clean 0.187 	Prec 99.28%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.161 (0.190)	Data 0.000 (0.027)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.810611486434937
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.251)	Data 0.000 (0.090)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.959639310836792
The orignal cluster result: num cluster = 1554(model) // 1526(model_ema) 	 num outliers = 298(model) // 374(model_ema)
Applying hierarchical clustering
[ 730 1483 1071 ...  402 1423 1350]
(16522,)
(array([    6,    76,    97,   145,   188,   199,   241,   246,   264,
         269,   288,   394,   412,   437,   472,   588,   608,   643,
         689,   715,   754,   808,   851,   861,   911,   918,   965,
        1030,  1098,  1162,  1396,  1402,  1685,  1796,  1849,  1902,
        1944,  2170,  2216,  2241,  2330,  2349,  2406,  2430,  2431,
        2441,  2575,  2754,  2758,  2770,  2792,  2818,  2878,  2922,
        3030,  3037,  3038,  3077,  3097,  3142,  3180,  3249,  3271,
        3304,  3404,  3431,  3448,  3507,  3584,  3764,  3842,  3851,
        3933,  4072,  4161,  4242,  4251,  4319,  4334,  4353,  4428,
        4440,  4487,  4527,  4539,  4561,  4651,  4653,  4774,  4776,
        4902,  4914,  5008,  5016,  5023,  5104,  5113,  5265,  5267,
        5331,  5534,  5546,  5578,  5580,  5583,  5603,  5631,  5757,
        5763,  5848,  5873,  6065,  6067,  6079,  6080,  6199,  6301,
        6406,  6447,  6467,  6574,  6788,  6822,  6825,  6860,  6876,
        6883,  6898,  7181,  7211,  7214,  7282,  7389,  7513,  7528,
        7538,  7586,  7612,  7625,  7630,  7632,  7682,  7796,  7858,
        7933,  7980,  8186,  8222,  8237,  8249,  8263,  8285,  8299,
        8320,  8525,  8566,  8594,  8705,  8746,  8799,  8818,  8824,
        8893,  8931,  8973,  9064,  9081,  9084,  9107,  9159,  9282,
        9312,  9399,  9453,  9471,  9480,  9562,  9610,  9675,  9752,
        9810,  9841,  9902,  9944,  9978, 10031, 10054, 10069, 10125,
       10154, 10213, 10408, 10533, 10589, 10697, 10750, 10764, 10825,
       10877, 10933, 11024, 11050, 11116, 11129, 11194, 11195, 11255,
       11297, 11317, 11349, 11441, 11456, 11553, 11568, 11693, 11767,
       11827, 11849, 11874, 11939, 11940, 11972, 12044, 12083, 12154,
       12416, 12449, 12458, 12491, 12510, 12557, 12715, 12743, 12802,
       12806, 12833, 13035, 13072, 13102, 13130, 13190, 13235, 13292,
       13489, 13511, 13545, 13606, 13724, 13734, 13861, 14079, 14112,
       14122, 14174, 14183, 14222, 14226, 14235, 14255, 14278, 14295,
       14301, 14459, 14461, 14512, 14578, 14593, 14634, 14763, 14898,
       14950, 14999, 15066, 15141, 15166, 15185, 15197, 15229, 15361,
       15407, 15443, 15484, 15547, 15592, 15732, 15736, 15915, 15978,
       16138, 16202, 16238, 16249, 16292, 16321, 16334, 16442, 16467,
       16501]),)
(16522, 16522)
(16224, 16522)
(16224, 16224)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=3.4848039150238037s
The HC Re-cluster result: num cluster = 1554(model) // 1526(model_ema) 	 num outliers = 298(model) // 374(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9210431575775146s
The UCIS result: num clean cluster = 1536(model) 	 num outliers = 659(model)
mdoel:new class are [1537], length of new dataset is 15863
Epoch: [19][0/300]	Time 1.527 (1.527)	Data 0.434 (0.434)	Loss_ce_clean 0.070 	Loss_ct_clean 0.071 	Prec 98.44%
Epoch: [19][50/300]	Time 0.779 (0.903)	Data 0.113 (0.122)	Loss_ce_clean 0.060 	Loss_ct_clean 0.062 	Prec 99.19%
Epoch: [19][100/300]	Time 0.769 (0.841)	Data 0.103 (0.116)	Loss_ce_clean 0.061 	Loss_ct_clean 0.139 	Prec 99.17%
Epoch: [19][150/300]	Time 0.778 (0.817)	Data 0.111 (0.113)	Loss_ce_clean 0.061 	Loss_ct_clean 0.163 	Prec 99.26%
Epoch: [19][200/300]	Time 0.770 (0.806)	Data 0.105 (0.111)	Loss_ce_clean 0.060 	Loss_ct_clean 0.169 	Prec 99.34%
Epoch: [19][250/300]	Time 1.535 (0.829)	Data 0.112 (0.110)	Loss_ce_clean 0.061 	Loss_ct_clean 0.174 	Prec 99.33%
Extract Features: [100/156]	Time 0.162 (0.228)	Data 0.000 (0.021)	
Mean AP: 46.8%
CMC Scores:
  top-1          65.7%
  top-5          78.2%
  top-10         82.6%
Extract Features: [100/156]	Time 0.156 (0.430)	Data 0.000 (0.272)	
Mean AP: 51.1%
CMC Scores:
  top-1          68.6%
  top-5          80.1%
  top-10         84.6%

 * Finished epoch  19  model no.1 mAP: 46.8% model no.2(mean-net) mAP: 51.1%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.886015176773071
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.230)	Data 0.000 (0.072)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.931232213973999
The orignal cluster result: num cluster = 1564(model) // 1535(model_ema) 	 num outliers = 265(model) // 335(model_ema)
Applying hierarchical clustering
[ 621 1462  952 ...  767 1444 1556]
(16522,)
(array([   75,    76,    97,   183,   188,   394,   412,   437,   547,
         608,   643,   689,   754,   808,   854,   965,   987,  1030,
        1042,  1059,  1063,  1098,  1162,  1402,  1644,  1685,  1796,
        1849,  1902,  1944,  2127,  2133,  2170,  2205,  2241,  2282,
        2319,  2330,  2349,  2406,  2441,  2758,  2818,  2835,  2913,
        3030,  3037,  3178,  3285,  3431,  3448,  3489,  3582,  3716,
        3794,  3842,  3918,  3933,  4072,  4105,  4108,  4249,  4251,
        4319,  4334,  4393,  4428,  4440,  4487,  4527,  4539,  4609,
        4651,  4653,  4685,  4902,  4914,  5023,  5104,  5113,  5239,
        5267,  5297,  5298,  5331,  5418,  5420,  5440,  5546,  5578,
        5585,  5603,  5631,  5702,  5757,  5763,  5813,  6065,  6067,
        6079,  6080,  6199,  6447,  6467,  6825,  6860,  6898,  7168,
        7181,  7282,  7417,  7528,  7538,  7542,  7586,  7612,  7625,
        7630,  7652,  7725,  7796,  7831,  7858,  7980,  8045,  8222,
        8285,  8299,  8497,  8525,  8594,  8705,  8818,  8824,  8893,
        9005,  9084,  9107,  9136,  9159,  9282,  9312,  9399,  9416,
        9471,  9562,  9610,  9645,  9740,  9752,  9810,  9835,  9902,
        9944, 10031, 10047, 10066, 10105, 10408, 10453, 10493, 10589,
       10604, 10750, 10825, 10973, 10997, 11025, 11116, 11129, 11166,
       11172, 11194, 11195, 11255, 11297, 11324, 11441, 11553, 11693,
       11750, 11827, 11849, 11874, 11912, 11939, 11972, 12044, 12118,
       12153, 12154, 12253, 12412, 12449, 12458, 12491, 12510, 12537,
       12658, 12802, 12806, 12833, 13072, 13102, 13190, 13235, 13292,
       13368, 13420, 13489, 13511, 13545, 13606, 13615, 13617, 13976,
       14050, 14079, 14112, 14122, 14222, 14235, 14255, 14278, 14295,
       14301, 14459, 14461, 14512, 14578, 14593, 14634, 14670, 14763,
       14775, 14877, 14950, 14999, 15076, 15090, 15110, 15141, 15156,
       15166, 15185, 15197, 15391, 15407, 15484, 15592, 15732, 15736,
       15841, 15915, 16045, 16086, 16138, 16202, 16211, 16238, 16292,
       16307, 16334, 16475, 16493]),)
(16522, 16522)
(16257, 16522)
(16257, 16257)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.6619009971618652s
The HC Re-cluster result: num cluster = 1564(model) // 1535(model_ema) 	 num outliers = 265(model) // 335(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9657442569732666s
The UCIS result: num clean cluster = 1549(model) 	 num outliers = 614(model)
mdoel:new class are [1550], length of new dataset is 15908
Epoch: [20][0/300]	Time 2.489 (2.489)	Data 0.303 (0.303)	Loss_ce_clean 0.074 	Loss_ct_clean 0.077 	Prec 98.44%
Epoch: [20][50/300]	Time 0.924 (0.970)	Data 0.107 (0.118)	Loss_ce_clean 0.060 	Loss_ct_clean 0.056 	Prec 99.10%
Epoch: [20][100/300]	Time 0.783 (0.932)	Data 0.118 (0.117)	Loss_ce_clean 0.063 	Loss_ct_clean 0.132 	Prec 99.09%
Epoch: [20][150/300]	Time 0.774 (0.879)	Data 0.108 (0.114)	Loss_ce_clean 0.064 	Loss_ct_clean 0.163 	Prec 99.12%
Epoch: [20][200/300]	Time 0.777 (0.852)	Data 0.111 (0.111)	Loss_ce_clean 0.063 	Loss_ct_clean 0.175 	Prec 99.20%
Epoch: [20][250/300]	Time 0.770 (0.836)	Data 0.104 (0.110)	Loss_ce_clean 0.063 	Loss_ct_clean 0.177 	Prec 99.23%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.162 (0.165)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.667973756790161
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.167)	Data 0.000 (0.010)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.793804407119751
The orignal cluster result: num cluster = 1574(model) // 1547(model_ema) 	 num outliers = 243(model) // 298(model_ema)
Applying hierarchical clustering
[ 898 1268  489 ...  158  879 1565]
(16522,)
(array([   97,   145,   183,   188,   197,   412,   437,   465,   608,
         689,   754,   808,   911,   918,   965,  1059,  1066,  1098,
        1162,  1396,  1402,  1417,  1590,  1644,  1796,  1849,  1902,
        1944,  2017,  2170,  2205,  2330,  2414,  2441,  2685,  2758,
        2818,  2835,  2862,  2913,  2947,  3030,  3037,  3271,  3281,
        3431,  3441,  3480,  3716,  3764,  3775,  3794,  3842,  3851,
        3918,  3933,  4257,  4319,  4334,  4428,  4440,  4487,  4499,
        4539,  4565,  4609,  4651,  4653,  4685,  4776,  4902,  4914,
        5023,  5104,  5184,  5267,  5331,  5534,  5546,  5548,  5558,
        5578,  5580,  5583,  5603,  5631,  5702,  5757,  5816,  5888,
        6065,  6067,  6079,  6080,  6199,  6389,  6409,  6447,  6467,
        6627,  6788,  6818,  6822,  6825,  6876,  6959,  7168,  7181,
        7282,  7513,  7526,  7528,  7612,  7625,  7652,  7796,  7933,
        7980,  8045,  8104,  8186,  8222,  8525,  8594,  8609,  8705,
        8818,  8824,  9003,  9005,  9081,  9084,  9107,  9282,  9312,
        9327,  9328,  9360,  9399,  9448,  9562,  9610,  9675,  9746,
        9752,  9810,  9979, 10105, 10154, 10213, 10408, 10493, 10589,
       10814, 10825, 10833, 10877, 10946, 10973, 11024, 11116, 11129,
       11172, 11194, 11195, 11255, 11297, 11324, 11553, 11674, 11693,
       11827, 12153, 12154, 12210, 12253, 12254, 12257, 12449, 12510,
       12655, 12658, 12715, 12743, 12802, 13072, 13102, 13159, 13160,
       13420, 13432, 13511, 13545, 13601, 13606, 13724, 13734, 13841,
       14050, 14079, 14122, 14222, 14226, 14235, 14255, 14256, 14295,
       14342, 14459, 14461, 14512, 14520, 14578, 14593, 14634, 14670,
       14761, 14898, 14950, 14963, 15090, 15110, 15141, 15166, 15229,
       15257, 15484, 15547, 15592, 15736, 15778, 15841, 16029, 16058,
       16138, 16202, 16211, 16238, 16292, 16307, 16334, 16401, 16467]),)
(16522, 16522)
(16279, 16522)
(16279, 16279)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.825486660003662s
The HC Re-cluster result: num cluster = 1574(model) // 1547(model_ema) 	 num outliers = 243(model) // 298(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8265953063964844s
The UCIS result: num clean cluster = 1559(model) 	 num outliers = 606(model)
mdoel:new class are [1560], length of new dataset is 15916
Epoch: [21][0/300]	Time 0.807 (0.807)	Data 0.116 (0.116)	Loss_ce_clean 0.034 	Loss_ct_clean 0.031 	Prec 99.22%
Epoch: [21][50/300]	Time 0.778 (0.771)	Data 0.113 (0.105)	Loss_ce_clean 0.056 	Loss_ct_clean 0.053 	Prec 99.39%
Epoch: [21][100/300]	Time 0.773 (0.770)	Data 0.108 (0.104)	Loss_ce_clean 0.057 	Loss_ct_clean 0.129 	Prec 99.37%
Epoch: [21][150/300]	Time 0.772 (0.770)	Data 0.106 (0.104)	Loss_ce_clean 0.057 	Loss_ct_clean 0.151 	Prec 99.42%
Epoch: [21][200/300]	Time 0.767 (0.770)	Data 0.102 (0.104)	Loss_ce_clean 0.058 	Loss_ct_clean 0.161 	Prec 99.41%
Epoch: [21][250/300]	Time 1.534 (0.820)	Data 0.112 (0.105)	Loss_ce_clean 0.058 	Loss_ct_clean 0.163 	Prec 99.46%
Extract Features: [100/156]	Time 0.158 (0.166)	Data 0.000 (0.008)	
Mean AP: 46.7%
CMC Scores:
  top-1          65.2%
  top-5          78.3%
  top-10         82.8%
Extract Features: [100/156]	Time 0.156 (0.339)	Data 0.000 (0.182)	
Mean AP: 50.2%
CMC Scores:
  top-1          67.5%
  top-5          79.9%
  top-10         84.6%

 * Finished epoch  21  model no.1 mAP: 46.7% model no.2(mean-net) mAP: 50.2%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.219)	Data 0.000 (0.062)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.858210325241089
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.596669435501099
The orignal cluster result: num cluster = 1587(model) // 1561(model_ema) 	 num outliers = 263(model) // 260(model_ema)
Applying hierarchical clustering
[ 719  125  474 ...  693 1505 1571]
(16522,)
(array([   76,    97,   182,   183,   188,   199,   207,   394,   412,
         472,   588,   608,   689,   715,   754,   808,   857,   911,
         918,   965,  1063,  1154,  1159,  1328,  1402,  1417,  1644,
        1871,  1902,  2127,  2170,  2205,  2241,  2330,  2349,  2431,
        2441,  2575,  2685,  2756,  2758,  2818,  2835,  2913,  3030,
        3037,  3046,  3077,  3142,  3143,  3178,  3271,  3304,  3480,
        3502,  3518,  3582,  3670,  3716,  3764,  3842,  3918,  3933,
        4072,  4101,  4105,  4249,  4251,  4334,  4397,  4421,  4428,
        4440,  4487,  4588,  4651,  4653,  4776,  4886,  4902,  5016,
        5113,  5180,  5265,  5267,  5440,  5510,  5513,  5534,  5540,
        5578,  5580,  5583,  5585,  5603,  5631,  5816,  5848,  5872,
        6028,  6065,  6080,  6126,  6193,  6199,  6447,  6629,  6721,
        6774,  6818,  6825,  7130,  7181,  7214,  7245,  7282,  7389,
        7513,  7528,  7538,  7612,  7630,  7652,  7725,  7796,  7858,
        7933,  8045,  8237,  8285,  8525,  8594,  8609,  8705,  8818,
        8824,  8879,  8893,  8947,  8973,  9005,  9081,  9084,  9159,
        9312,  9399,  9471,  9480,  9565,  9675,  9752,  9771,  9810,
        9944,  9967,  9979, 10072, 10105, 10213, 10408, 10583, 10589,
       10678, 10764, 10814, 10825, 10933, 11024, 11025, 11116, 11129,
       11172, 11194, 11195, 11255, 11276, 11324, 11337, 11545, 11553,
       11674, 11693, 11767, 11827, 11849, 11874, 11912, 11939, 11940,
       12044, 12153, 12154, 12210, 12253, 12412, 12449, 12510, 12537,
       12548, 12557, 12602, 12658, 12715, 12802, 12805, 13072, 13102,
       13160, 13190, 13213, 13245, 13292, 13321, 13420, 13432, 13511,
       13545, 13601, 13630, 13724, 13734, 13841, 14079, 14122, 14226,
       14235, 14255, 14278, 14295, 14459, 14461, 14512, 14525, 14578,
       14593, 14691, 14921, 14999, 15090, 15110, 15141, 15166, 15197,
       15229, 15303, 15564, 15592, 15642, 15732, 15736, 15915, 15950,
       16045, 16110, 16138, 16202, 16211, 16238, 16272, 16307, 16321,
       16334, 16467]),)
(16522, 16522)
(16259, 16522)
(16259, 16259)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2375757694244385s
The HC Re-cluster result: num cluster = 1587(model) // 1561(model_ema) 	 num outliers = 263(model) // 260(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.0525166988372803s
The UCIS result: num clean cluster = 1572(model) 	 num outliers = 519(model)
mdoel:new class are [1573], length of new dataset is 16003
Epoch: [22][0/300]	Time 0.951 (0.951)	Data 0.226 (0.226)	Loss_ce_clean 0.045 	Loss_ct_clean 0.046 	Prec 99.22%
Epoch: [22][50/300]	Time 0.773 (0.776)	Data 0.108 (0.110)	Loss_ce_clean 0.059 	Loss_ct_clean 0.054 	Prec 99.10%
Epoch: [22][100/300]	Time 0.772 (0.773)	Data 0.102 (0.107)	Loss_ce_clean 0.058 	Loss_ct_clean 0.131 	Prec 99.19%
Epoch: [22][150/300]	Time 0.772 (0.772)	Data 0.107 (0.106)	Loss_ce_clean 0.058 	Loss_ct_clean 0.151 	Prec 99.29%
Epoch: [22][200/300]	Time 0.764 (0.771)	Data 0.099 (0.105)	Loss_ce_clean 0.059 	Loss_ct_clean 0.157 	Prec 99.34%
Epoch: [22][250/300]	Time 0.771 (0.771)	Data 0.106 (0.105)	Loss_ce_clean 0.059 	Loss_ct_clean 0.163 	Prec 99.33%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.162 (0.166)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.660644054412842
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.644723415374756
The orignal cluster result: num cluster = 1595(model) // 1576(model_ema) 	 num outliers = 222(model) // 260(model_ema)
Applying hierarchical clustering
[ 990  606  449 ...  720 1378 1590]
(16522,)
(array([   97,   183,   188,   199,   266,   269,   394,   412,   437,
         465,   472,   506,   577,   608,   689,   715,   754,   808,
         911,   916,   918,   965,  1059,  1063,  1066,  1098,  1328,
        1396,  1402,  1849,  1902,  2127,  2182,  2205,  2330,  2441,
        2575,  2685,  2714,  2758,  2818,  2835,  2947,  3046,  3143,
        3431,  3448,  3582,  3670,  3716,  3933,  4105,  4249,  4251,
        4334,  4428,  4440,  4487,  4499,  4632,  4653,  4902,  4914,
        5016,  5023,  5104,  5180,  5331,  5338,  5418,  5420,  5440,
        5513,  5546,  5548,  5578,  5585,  5631,  5757,  5816,  5848,
        5872,  6028,  6065,  6079,  6083,  6199,  6447,  6627,  6629,
        6774,  6843,  7214,  7282,  7410,  7513,  7528,  7576,  7612,
        7652,  7682,  7725,  7796,  7933,  8045,  8206,  8222,  8232,
        8237,  8263,  8299,  8379,  8411,  8505,  8525,  8594,  8799,
        8893,  8947,  9081,  9084,  9105,  9107,  9282,  9312,  9328,
        9399,  9471,  9480,  9610,  9752,  9810,  9944,  9979, 10072,
       10105, 10298, 10408, 10453, 10589, 10764, 10814, 10825, 11024,
       11025, 11116, 11172, 11194, 11195, 11229, 11255, 11324, 11456,
       11545, 11553, 11639, 11693, 11750, 11827, 11939, 12153, 12154,
       12253, 12412, 12458, 12510, 12548, 12602, 12655, 12658, 12715,
       12802, 13102, 13213, 13292, 13420, 13511, 13545, 13606, 13615,
       13724, 13841, 13976, 14050, 14079, 14122, 14226, 14235, 14255,
       14256, 14278, 14295, 14461, 14512, 14578, 14593, 14634, 14877,
       14921, 14950, 14999, 15090, 15110, 15115, 15166, 15188, 15197,
       15229, 15484, 15592, 15732, 15736, 15841, 15915, 15950, 16045,
       16073, 16138, 16202, 16307, 16334, 16467]),)
(16522, 16522)
(16300, 16522)
(16300, 16300)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.125007152557373s
The HC Re-cluster result: num cluster = 1595(model) // 1576(model_ema) 	 num outliers = 222(model) // 260(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8566200733184814s
The UCIS result: num clean cluster = 1581(model) 	 num outliers = 511(model)
mdoel:new class are [1582], length of new dataset is 16011
Epoch: [23][0/300]	Time 0.781 (0.781)	Data 0.114 (0.114)	Loss_ce_clean 0.039 	Loss_ct_clean 0.040 	Prec 99.22%
Epoch: [23][50/300]	Time 0.774 (0.770)	Data 0.108 (0.105)	Loss_ce_clean 0.051 	Loss_ct_clean 0.044 	Prec 99.37%
Epoch: [23][100/300]	Time 0.768 (0.770)	Data 0.103 (0.105)	Loss_ce_clean 0.053 	Loss_ct_clean 0.117 	Prec 99.41%
Epoch: [23][150/300]	Time 0.780 (0.770)	Data 0.114 (0.105)	Loss_ce_clean 0.053 	Loss_ct_clean 0.141 	Prec 99.47%
Epoch: [23][200/300]	Time 0.769 (0.770)	Data 0.103 (0.105)	Loss_ce_clean 0.054 	Loss_ct_clean 0.149 	Prec 99.49%
Epoch: [23][250/300]	Time 0.771 (0.770)	Data 0.105 (0.105)	Loss_ce_clean 0.054 	Loss_ct_clean 0.152 	Prec 99.47%
Extract Features: [100/156]	Time 0.314 (0.383)	Data 0.000 (0.098)	
Mean AP: 44.7%
CMC Scores:
  top-1          64.0%
  top-5          77.3%
  top-10         81.7%
Extract Features: [100/156]	Time 0.156 (0.548)	Data 0.000 (0.369)	
Mean AP: 49.1%
CMC Scores:
  top-1          67.2%
  top-5          79.4%
  top-10         83.9%

 * Finished epoch  23  model no.1 mAP: 44.7% model no.2(mean-net) mAP: 49.1%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.162 (0.166)	Data 0.000 (0.010)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.727209568023682
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.198)	Data 0.000 (0.040)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.625300168991089
The orignal cluster result: num cluster = 1604(model) // 1584(model_ema) 	 num outliers = 219(model) // 222(model_ema)
Applying hierarchical clustering
[1134   28  354 ...  624 1116 1372]
(16522,)
(array([   76,    97,   145,   161,   183,   188,   190,   207,   269,
         412,   437,   465,   472,   483,   487,   608,   689,   808,
         911,   918,   965,  1059,  1063,  1066,  1098,  1162,  1644,
        1849,  1902,  1944,  2014,  2127,  2170,  2182,  2205,  2282,
        2319,  2441,  2575,  2666,  2714,  2758,  2818,  2835,  2947,
        3030,  3039,  3143,  3271,  3431,  3448,  3518,  3573,  3582,
        3685,  3716,  3794,  3918,  3933,  4101,  4105,  4196,  4249,
        4319,  4334,  4440,  4487,  4651,  4653,  4776,  4902,  4914,
        5023,  5104,  5165,  5267,  5362,  5418,  5440,  5534,  5546,
        5578,  5583,  5598,  5603,  5631,  5872,  5888,  6065,  6199,
        6202,  6447,  6774,  6818,  6825,  7181,  7214,  7282,  7513,
        7528,  7652,  7796,  7827,  7842,  8045,  8222,  8232,  8237,
        8285,  8471,  8497,  8594,  8609,  8705,  8799,  8818,  8824,
        8893,  8947,  9005,  9084,  9282,  9312,  9328,  9399,  9471,
        9610,  9675,  9746,  9752,  9810,  9979, 10105, 10154, 10172,
       10213, 10298, 10346, 10408, 10825, 10932, 11116, 11194, 11255,
       11324, 11553, 11674, 11693, 11874, 11939, 11972, 12153, 12210,
       12253, 12381, 12412, 12414, 12449, 12458, 12510, 12537, 12630,
       12658, 12802, 12980, 13102, 13245, 13292, 13396, 13420, 13432,
       13511, 13537, 13606, 13622, 13724, 13796, 13841, 14008, 14050,
       14122, 14235, 14255, 14278, 14295, 14338, 14405, 14459, 14461,
       14512, 14578, 14593, 14670, 14761, 14877, 14898, 14950, 14999,
       15005, 15053, 15110, 15197, 15229, 15257, 15292, 15303, 15484,
       15516, 15648, 15732, 15736, 15841, 16045, 16202, 16211, 16272,
       16307, 16334, 16467]),)
(16522, 16522)
(16303, 16522)
(16303, 16303)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2155628204345703s
The HC Re-cluster result: num cluster = 1604(model) // 1584(model_ema) 	 num outliers = 219(model) // 222(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9391589164733887s
The UCIS result: num clean cluster = 1592(model) 	 num outliers = 459(model)
mdoel:new class are [1593], length of new dataset is 16063
Epoch: [24][0/300]	Time 0.889 (0.889)	Data 0.190 (0.190)	Loss_ce_clean 0.053 	Loss_ct_clean 0.054 	Prec 97.66%
Epoch: [24][50/300]	Time 0.765 (0.778)	Data 0.100 (0.111)	Loss_ce_clean 0.053 	Loss_ct_clean 0.047 	Prec 99.13%
Epoch: [24][100/300]	Time 0.765 (0.774)	Data 0.100 (0.108)	Loss_ce_clean 0.054 	Loss_ct_clean 0.117 	Prec 99.27%
Epoch: [24][150/300]	Time 0.767 (0.773)	Data 0.100 (0.106)	Loss_ce_clean 0.054 	Loss_ct_clean 0.138 	Prec 99.31%
Epoch: [24][200/300]	Time 0.769 (0.772)	Data 0.104 (0.106)	Loss_ce_clean 0.054 	Loss_ct_clean 0.145 	Prec 99.39%
Epoch: [24][250/300]	Time 0.767 (0.772)	Data 0.102 (0.106)	Loss_ce_clean 0.055 	Loss_ct_clean 0.147 	Prec 99.39%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.163 (0.166)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.732391834259033
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.165)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.681025266647339
The orignal cluster result: num cluster = 1610(model) // 1593(model_ema) 	 num outliers = 165(model) // 222(model_ema)
Applying hierarchical clustering
[1267  662 1376 ...  102 1091 1585]
(16522,)
(array([   97,   188,   199,   400,   472,   483,   588,   608,   689,
         754,   911,  1059,  1063,  1098,  1328,  1634,  1782,  1783,
        1849,  2014,  2205,  2406,  2666,  2741,  2818,  2835,  2947,
        3037,  3039,  3046,  3143,  3271,  3304,  3431,  3448,  3502,
        3670,  3918,  3933,  4101,  4196,  4319,  4334,  4632,  4653,
        5016,  5023,  5104,  5180,  5331,  5362,  5418,  5513,  5534,
        5546,  5578,  5580,  5583,  5603,  5631,  5763,  5848,  5872,
        6028,  6079,  6144,  6202,  6301,  6447,  6629,  6774,  6825,
        7181,  7513,  7682,  7796,  8222,  8232,  8237,  8263,  8285,
        8379,  8594,  8705,  8818,  8893,  9084,  9107,  9282,  9373,
        9399,  9480,  9810,  9944, 10105, 10154, 10172, 10408, 10589,
       10697, 10764, 10825, 11024, 11146, 11194, 11229, 11255, 11324,
       11349, 11456, 11545, 11553, 11826, 11827, 11874, 11939, 12044,
       12412, 12510, 12557, 12658, 12715, 12806, 13102, 13213, 13292,
       13420, 13537, 13601, 13606, 13724, 13734, 13796, 13976, 14050,
       14079, 14122, 14222, 14226, 14255, 14278, 14461, 14512, 14761,
       14865, 14898, 14950, 15076, 15110, 15141, 15145, 15292, 15592,
       15625, 15709, 15950, 16029, 16073, 16138, 16202, 16211, 16238,
       16307, 16442, 16467]),)
(16522, 16522)
(16357, 16522)
(16357, 16357)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.14530348777771s
The HC Re-cluster result: num cluster = 1610(model) // 1593(model_ema) 	 num outliers = 165(model) // 222(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8702127933502197s
The UCIS result: num clean cluster = 1598(model) 	 num outliers = 427(model)
mdoel:new class are [1599], length of new dataset is 16095
Epoch: [25][0/300]	Time 0.783 (0.783)	Data 0.113 (0.113)	Loss_ce_clean 0.051 	Loss_ct_clean 0.050 	Prec 100.00%
Epoch: [25][50/300]	Time 0.771 (0.769)	Data 0.106 (0.104)	Loss_ce_clean 0.048 	Loss_ct_clean 0.044 	Prec 99.45%
Epoch: [25][100/300]	Time 0.769 (0.769)	Data 0.103 (0.104)	Loss_ce_clean 0.048 	Loss_ct_clean 0.109 	Prec 99.44%
Epoch: [25][150/300]	Time 0.775 (0.769)	Data 0.110 (0.104)	Loss_ce_clean 0.050 	Loss_ct_clean 0.133 	Prec 99.45%
Epoch: [25][200/300]	Time 0.771 (0.769)	Data 0.106 (0.104)	Loss_ce_clean 0.052 	Loss_ct_clean 0.143 	Prec 99.46%
Epoch: [25][250/300]	Time 0.772 (0.770)	Data 0.106 (0.104)	Loss_ce_clean 0.052 	Loss_ct_clean 0.146 	Prec 99.44%
Extract Features: [100/156]	Time 0.156 (0.321)	Data 0.000 (0.164)	
Mean AP: 45.4%
CMC Scores:
  top-1          63.6%
  top-5          77.2%
  top-10         81.5%
Extract Features: [100/156]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Mean AP: 48.5%
CMC Scores:
  top-1          67.1%
  top-5          79.4%
  top-10         83.7%

 * Finished epoch  25  model no.1 mAP: 45.4% model no.2(mean-net) mAP: 48.5%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.732815265655518
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.746529817581177
The orignal cluster result: num cluster = 1613(model) // 1602(model_ema) 	 num outliers = 154(model) // 202(model_ema)
Applying hierarchical clustering
[1062  592 1398 ...  590  876 1372]
(16522,)
(array([  183,   188,   207,   412,   588,   608,   689,   754,   911,
         916,   918,  1063,  1098,  1402,  1644,  1690,  1783,  1849,
        2127,  2205,  2282,  2431,  2441,  2575,  2758,  2818,  3030,
        3143,  3249,  3271,  3304,  3404,  3448,  3582,  3781,  3918,
        3933,  4101,  4319,  4334,  4440,  4487,  4776,  4914,  5180,
        5267,  5418,  5440,  5534,  5546,  5578,  5580,  5631,  5848,
        5872,  6065,  6144,  6199,  6202,  6447,  6467,  6774,  6825,
        6843,  6883,  7181,  7329,  7513,  7528,  7612,  7652,  7655,
        7682,  7725,  7796,  7842,  8045,  8222,  8237,  8263,  8497,
        8818,  8824,  8893,  9064,  9084,  9312,  9399,  9471,  9610,
        9746,  9810,  9943,  9944, 10105, 10298, 10408, 10589, 10814,
       10825, 11024, 11087, 11116, 11194, 11229, 11255, 11324, 11472,
       11553, 11693, 11863, 11939, 12153, 12154, 12253, 12412, 12510,
       12557, 12658, 12802, 13102, 13213, 13292, 13420, 13511, 13545,
       13601, 13606, 13724, 13841, 13976, 14050, 14079, 14112, 14226,
       14235, 14255, 14278, 14593, 14634, 14865, 14877, 14950, 15110,
       15292, 15303, 15484, 15715, 15841, 15851, 16073, 16138, 16272,
       16334]),)
(16522, 16522)
(16368, 16522)
(16368, 16368)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=3.001685380935669s
The HC Re-cluster result: num cluster = 1613(model) // 1602(model_ema) 	 num outliers = 154(model) // 202(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8613684177398682s
The UCIS result: num clean cluster = 1604(model) 	 num outliers = 357(model)
mdoel:new class are [1605], length of new dataset is 16165
Epoch: [26][0/300]	Time 0.787 (0.787)	Data 0.117 (0.117)	Loss_ce_clean 0.016 	Loss_ct_clean 0.018 	Prec 100.00%
Epoch: [26][50/300]	Time 0.776 (0.769)	Data 0.111 (0.104)	Loss_ce_clean 0.044 	Loss_ct_clean 0.037 	Prec 99.56%
Epoch: [26][100/300]	Time 0.785 (0.770)	Data 0.120 (0.104)	Loss_ce_clean 0.049 	Loss_ct_clean 0.107 	Prec 99.46%
Epoch: [26][150/300]	Time 0.780 (0.770)	Data 0.114 (0.104)	Loss_ce_clean 0.051 	Loss_ct_clean 0.131 	Prec 99.40%
Epoch: [26][200/300]	Time 0.783 (0.770)	Data 0.116 (0.104)	Loss_ce_clean 0.053 	Loss_ct_clean 0.142 	Prec 99.42%
Epoch: [26][250/300]	Time 0.778 (0.770)	Data 0.113 (0.104)	Loss_ce_clean 0.053 	Loss_ct_clean 0.144 	Prec 99.44%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.706377983093262
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.874090909957886
The orignal cluster result: num cluster = 1619(model) // 1611(model_ema) 	 num outliers = 161(model) // 175(model_ema)
Applying hierarchical clustering
[1399  558  990 ... 1107 1556 1543]
(16522,)
(array([   97,   183,   188,   207,   257,   262,   288,   487,   588,
         689,   754,   911,   918,   965,  1059,  1063,  1098,  1328,
        1402,  1525,  1644,  1902,  1944,  2127,  2170,  2205,  2319,
        2644,  2666,  2792,  3030,  3143,  3448,  3582,  3918,  3933,
        4082,  4196,  4319,  4334,  4353,  4440,  4487,  4653,  4902,
        4914,  5023,  5267,  5362,  5418,  5440,  5546,  5578,  5583,
        5598,  5603,  5631,  5667,  5848,  6080,  6199,  6202,  6447,
        6467,  6774,  6825,  7181,  7389,  7513,  7612,  7796,  8045,
        8164,  8232,  8237,  8263,  8525,  8609,  8818,  8824,  8893,
        9084,  9312,  9399,  9471,  9746,  9752,  9810,  9835, 10031,
       10047, 10069, 10105, 10145, 10408, 10589, 10701, 10825, 10997,
       11087, 11116, 11194, 11255, 11324, 11553, 11674, 11750, 11827,
       11939, 12083, 12154, 12210, 12412, 12414, 12458, 12523, 12657,
       12658, 12802, 12980, 13102, 13159, 13213, 13420, 13511, 13601,
       13606, 13734, 13976, 14050, 14079, 14112, 14226, 14235, 14255,
       14278, 14459, 14461, 14578, 14593, 14634, 14670, 14761, 14877,
       14950, 15005, 15110, 15141, 15229, 15484, 15592, 15715, 15841,
       16045, 16202, 16249, 16272, 16307, 16334, 16442, 16467]),)
(16522, 16522)
(16361, 16522)
(16361, 16361)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2341132164001465s
The HC Re-cluster result: num cluster = 1619(model) // 1611(model_ema) 	 num outliers = 161(model) // 175(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8655211925506592s
The UCIS result: num clean cluster = 1609(model) 	 num outliers = 366(model)
mdoel:new class are [1610], length of new dataset is 16156
Epoch: [27][0/300]	Time 0.786 (0.786)	Data 0.116 (0.116)	Loss_ce_clean 0.048 	Loss_ct_clean 0.053 	Prec 100.00%
Epoch: [27][50/300]	Time 0.783 (0.771)	Data 0.118 (0.106)	Loss_ce_clean 0.045 	Loss_ct_clean 0.038 	Prec 99.49%
Epoch: [27][100/300]	Time 0.776 (0.770)	Data 0.111 (0.104)	Loss_ce_clean 0.047 	Loss_ct_clean 0.103 	Prec 99.46%
Epoch: [27][150/300]	Time 0.775 (0.882)	Data 0.109 (0.108)	Loss_ce_clean 0.048 	Loss_ct_clean 0.125 	Prec 99.47%
Epoch: [27][200/300]	Time 0.773 (0.854)	Data 0.108 (0.107)	Loss_ce_clean 0.048 	Loss_ct_clean 0.131 	Prec 99.50%
Epoch: [27][250/300]	Time 0.790 (0.904)	Data 0.124 (0.107)	Loss_ce_clean 0.049 	Loss_ct_clean 0.134 	Prec 99.53%
Extract Features: [100/156]	Time 0.157 (0.299)	Data 0.000 (0.143)	
Mean AP: 46.0%
CMC Scores:
  top-1          64.8%
  top-5          77.4%
  top-10         82.5%
Extract Features: [100/156]	Time 0.324 (0.208)	Data 0.000 (0.008)	
Mean AP: 47.2%
CMC Scores:
  top-1          65.5%
  top-5          78.5%
  top-10         82.5%

 * Finished epoch  27  model no.1 mAP: 46.0% model no.2(mean-net) mAP: 47.2%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.177)	Data 0.000 (0.010)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.739856243133545
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.235)	Data 0.000 (0.078)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.679089784622192
The orignal cluster result: num cluster = 1625(model) // 1617(model_ema) 	 num outliers = 142(model) // 184(model_ema)
Applying hierarchical clustering
[ 966  685  985 ...  440 1544 1550]
(16522,)
(array([   97,   182,   188,   207,   257,   288,   588,   689,   715,
         754,   808,   911,   918,   965,  1098,  1402,  1644,  1783,
        2127,  2170,  2205,  2374,  2431,  2575,  2792,  2818,  3030,
        3037,  3143,  3304,  3431,  3448,  3582,  3781,  4072,  4319,
        4334,  4353,  4487,  4653,  4902,  5023,  5267,  5440,  5534,
        5540,  5546,  5578,  5580,  5603,  5700,  5816,  5848,  5872,
        6065,  6080,  6202,  6447,  6467,  6468,  6883,  7282,  7513,
        7612,  7652,  7796,  7827,  8237,  8263,  8594,  8609,  8818,
        8824,  8893,  9064,  9084,  9282,  9312,  9399,  9471,  9810,
       10069, 10105, 10408, 10589, 10701, 10825, 11087, 11116, 11194,
       11324, 11553, 11674, 11827, 11863, 11939, 11972, 12153, 12154,
       12381, 12510, 12557, 12630, 12658, 12715, 12802, 12980, 13102,
       13396, 13420, 13511, 13606, 13841, 13976, 13988, 14050, 14079,
       14122, 14226, 14235, 14255, 14593, 14634, 14670, 14761, 14865,
       14877, 14950, 15090, 15141, 15229, 15484, 15592, 15715, 15848,
       16045, 16202, 16249, 16307, 16334, 16442, 16467]),)
(16522, 16522)
(16380, 16522)
(16380, 16380)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2243456840515137s
The HC Re-cluster result: num cluster = 1625(model) // 1617(model_ema) 	 num outliers = 142(model) // 184(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.0503830909729004s
The UCIS result: num clean cluster = 1613(model) 	 num outliers = 362(model)
mdoel:new class are [1614], length of new dataset is 16160
Epoch: [28][0/300]	Time 1.242 (1.242)	Data 0.447 (0.447)	Loss_ce_clean 0.029 	Loss_ct_clean 0.031 	Prec 100.00%
Epoch: [28][50/300]	Time 0.844 (0.922)	Data 0.179 (0.253)	Loss_ce_clean 0.042 	Loss_ct_clean 0.035 	Prec 99.46%
Epoch: [28][100/300]	Time 0.820 (0.888)	Data 0.150 (0.221)	Loss_ce_clean 0.046 	Loss_ct_clean 0.100 	Prec 99.44%
Epoch: [28][150/300]	Time 0.833 (0.883)	Data 0.168 (0.216)	Loss_ce_clean 0.048 	Loss_ct_clean 0.122 	Prec 99.47%
Epoch: [28][200/300]	Time 1.552 (0.930)	Data 0.128 (0.222)	Loss_ce_clean 0.048 	Loss_ct_clean 0.128 	Prec 99.49%
Epoch: [28][250/300]	Time 1.184 (0.960)	Data 0.519 (0.223)	Loss_ce_clean 0.048 	Loss_ct_clean 0.130 	Prec 99.51%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.160 (0.299)	Data 0.000 (0.012)	
Computing jaccard distance...
Jaccard distance computing time cost: 29.642168521881104
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.406 (0.223)	Data 0.250 (0.066)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.8044273853302
The orignal cluster result: num cluster = 1629(model) // 1623(model_ema) 	 num outliers = 135(model) // 166(model_ema)
Applying hierarchical clustering
[ 510  413 1340 ...  498  782 1209]
(16522,)
(array([   97,   188,   207,   394,   689,   754,   918,  1059,  1063,
        1098,  1402,  1644,  1871,  1902,  1944,  2127,  2205,  2282,
        2319,  2758,  2818,  2833,  3046,  3226,  3271,  3431,  3582,
        3873,  4319,  4334,  4902,  5440,  5534,  5546,  5603,  5631,
        5816,  5848,  6065,  6199,  6202,  6467,  6825,  7181,  7214,
        7389,  7513,  7612,  7725,  7796,  7827,  8005,  8104,  8232,
        8237,  8263,  8471,  8609,  8818,  8824,  8893,  9005,  9084,
        9282,  9312,  9471,  9746,  9810,  9944, 10105, 10213, 10814,
       10825, 11116, 11194, 11229, 11324, 11553, 11750, 11849, 11863,
       11874, 11939, 12154, 12210, 12381, 12412, 12458, 12523, 12557,
       12630, 12658, 12715, 12802, 12980, 13102, 13159, 13245, 13396,
       13432, 13511, 13606, 13630, 13724, 13976, 14079, 14122, 14226,
       14235, 14278, 14425, 14461, 14593, 14627, 14634, 14650, 14670,
       14761, 14898, 14950, 15005, 15053, 15115, 15141, 15229, 15292,
       15484, 15736, 16045, 16064, 16202, 16211, 16307, 16334, 16467]),)
(16522, 16522)
(16387, 16522)
(16387, 16387)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.3467071056365967s
The HC Re-cluster result: num cluster = 1629(model) // 1623(model_ema) 	 num outliers = 135(model) // 166(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.1373047828674316s
The UCIS result: num clean cluster = 1613(model) 	 num outliers = 375(model)
mdoel:new class are [1614], length of new dataset is 16147
Epoch: [29][0/300]	Time 0.832 (0.832)	Data 0.162 (0.162)	Loss_ce_clean 0.020 	Loss_ct_clean 0.022 	Prec 100.00%
Epoch: [29][50/300]	Time 0.783 (0.775)	Data 0.117 (0.109)	Loss_ce_clean 0.039 	Loss_ct_clean 0.034 	Prec 99.36%
Epoch: [29][100/300]	Time 1.533 (0.799)	Data 0.123 (0.108)	Loss_ce_clean 0.042 	Loss_ct_clean 0.096 	Prec 99.41%
Epoch: [29][150/300]	Time 1.556 (0.960)	Data 0.172 (0.126)	Loss_ce_clean 0.044 	Loss_ct_clean 0.114 	Prec 99.45%
Epoch: [29][200/300]	Time 0.785 (0.945)	Data 0.119 (0.123)	Loss_ce_clean 0.047 	Loss_ct_clean 0.123 	Prec 99.41%
Epoch: [29][250/300]	Time 0.780 (0.911)	Data 0.114 (0.119)	Loss_ce_clean 0.047 	Loss_ct_clean 0.127 	Prec 99.44%
Extract Features: [100/156]	Time 0.159 (0.330)	Data 0.000 (0.169)	
Mean AP: 44.3%
CMC Scores:
  top-1          62.7%
  top-5          76.4%
  top-10         81.9%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 46.7%
CMC Scores:
  top-1          65.1%
  top-5          77.8%
  top-10         82.5%

 * Finished epoch  29  model no.1 mAP: 44.3% model no.2(mean-net) mAP: 46.7%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.884251356124878
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.716652393341064
The orignal cluster result: num cluster = 1630(model) // 1625(model_ema) 	 num outliers = 115(model) // 136(model_ema)
Applying hierarchical clustering
[1273  431 1479 ... 1007 1093 1578]
(16522,)
(array([   76,    97,   188,   190,   199,   394,   680,   689,  1059,
        1063,  1098,  1402,  1902,  2127,  2170,  2205,  2575,  2818,
        2935,  3030,  3143,  3271,  3582,  3781,  3794,  3918,  4101,
        4319,  4334,  4902,  4921,  5016,  5440,  5513,  5546,  5578,
        5631,  5667,  5848,  5872,  5888,  6065,  6199,  6447,  6450,
        6467,  6825,  7181,  7214,  7389,  7725,  8232,  8237,  8497,
        8525,  8609,  8818,  8824,  8893,  9084,  9282,  9399,  9471,
        9810,  9826, 10031, 10084, 10105, 10346, 10706, 10825, 11087,
       11116, 11194, 11324, 11553, 11750, 11849, 11863, 11874, 11939,
       12083, 12154, 12412, 12510, 12523, 12557, 12658, 12802, 13213,
       13420, 13606, 13827, 13841, 14050, 14079, 14122, 14235, 14255,
       14278, 14405, 14418, 14461, 14593, 14634, 14877, 14898, 14950,
       15110, 15229, 15484, 16045, 16307, 16442, 16467]),)
(16522, 16522)
(16407, 16522)
(16407, 16407)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.284961223602295s
The HC Re-cluster result: num cluster = 1630(model) // 1625(model_ema) 	 num outliers = 115(model) // 136(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8389401435852051s
The UCIS result: num clean cluster = 1624(model) 	 num outliers = 228(model)
mdoel:new class are [1625], length of new dataset is 16294
Epoch: [30][0/300]	Time 0.816 (0.816)	Data 0.146 (0.146)	Loss_ce_clean 0.026 	Loss_ct_clean 0.025 	Prec 100.00%
Epoch: [30][50/300]	Time 0.793 (1.100)	Data 0.128 (0.112)	Loss_ce_clean 0.040 	Loss_ct_clean 0.033 	Prec 99.39%
Epoch: [30][100/300]	Time 1.860 (1.157)	Data 0.134 (0.208)	Loss_ce_clean 0.045 	Loss_ct_clean 0.100 	Prec 99.39%
Epoch: [30][150/300]	Time 1.008 (1.282)	Data 0.343 (0.413)	Loss_ce_clean 0.046 	Loss_ct_clean 0.121 	Prec 99.41%
Epoch: [30][200/300]	Time 0.923 (1.218)	Data 0.258 (0.400)	Loss_ce_clean 0.047 	Loss_ct_clean 0.127 	Prec 99.43%
Epoch: [30][250/300]	Time 0.852 (1.156)	Data 0.186 (0.368)	Loss_ce_clean 0.048 	Loss_ct_clean 0.128 	Prec 99.44%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.158 (0.172)	Data 0.000 (0.012)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.476324319839478
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.175)	Data 0.000 (0.018)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.78788423538208
The orignal cluster result: num cluster = 1646(model) // 1636(model_ema) 	 num outliers = 159(model) // 135(model_ema)
Applying hierarchical clustering
[ 814  374 1583 ...  953  661 1472]
(16522,)
(array([   76,   188,   190,   199,   207,   288,   394,   472,   481,
         487,   689,   715,   754,   911,   918,  1063,  1098,  1396,
        1605,  1644,  1871,  1902,  2066,  2127,  2170,  2205,  2241,
        2282,  2319,  2431,  2575,  2741,  2792,  3143,  3198,  3226,
        3271,  3304,  3363,  3518,  3582,  3794,  3933,  4196,  4257,
        4334,  4353,  4401,  4432,  4653,  4681,  4836,  4902,  4921,
        5016,  5220,  5362,  5418,  5440,  5513,  5534,  5546,  5578,
        5598,  5603,  5631,  5667,  5725,  5816,  5872,  6065,  6126,
        6144,  6199,  6447,  6467,  6825,  6843,  6965,  7181,  7219,
        7251,  7389,  7513,  7612,  7796,  7842,  8097,  8237,  8263,
        8471,  8609,  8824,  8893,  9084,  9399,  9471,  9480,  9810,
       10048, 10069, 10084, 10105, 10213, 10298, 10338, 10346, 10764,
       10825, 11194, 11255, 11301, 11324, 11553, 11750, 11874, 11939,
       11954, 12154, 12210, 12510, 12523, 12557, 12657, 12658, 12802,
       12980, 13102, 13159, 13245, 13432, 13511, 13606, 13630, 13827,
       13841, 13976, 14079, 14255, 14278, 14425, 14461, 14593, 14599,
       14634, 14670, 14898, 15076, 15141, 15229, 15608, 15732, 15869,
       16202, 16203, 16249, 16334, 16442, 16467]),)
(16522, 16522)
(16363, 16522)
(16363, 16363)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.7561535835266113s
The HC Re-cluster result: num cluster = 1646(model) // 1636(model_ema) 	 num outliers = 159(model) // 135(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.1345207691192627s
The UCIS result: num clean cluster = 1637(model) 	 num outliers = 339(model)
mdoel:new class are [1638], length of new dataset is 16183
Epoch: [31][0/300]	Time 1.628 (1.628)	Data 0.262 (0.262)	Loss_ce_clean 0.023 	Loss_ct_clean 0.025 	Prec 100.00%
Epoch: [31][50/300]	Time 2.279 (1.257)	Data 1.615 (0.386)	Loss_ce_clean 0.043 	Loss_ct_clean 0.033 	Prec 99.40%
Epoch: [31][100/300]	Time 1.031 (1.245)	Data 0.366 (0.476)	Loss_ce_clean 0.044 	Loss_ct_clean 0.095 	Prec 99.46%
Epoch: [31][150/300]	Time 0.915 (1.157)	Data 0.245 (0.422)	Loss_ce_clean 0.044 	Loss_ct_clean 0.115 	Prec 99.46%
Epoch: [31][200/300]	Time 0.839 (1.093)	Data 0.175 (0.375)	Loss_ce_clean 0.046 	Loss_ct_clean 0.121 	Prec 99.44%
Epoch: [31][250/300]	Time 1.138 (1.076)	Data 0.473 (0.368)	Loss_ce_clean 0.047 	Loss_ct_clean 0.124 	Prec 99.46%
Extract Features: [100/156]	Time 0.160 (0.355)	Data 0.000 (0.062)	
Mean AP: 44.7%
CMC Scores:
  top-1          62.4%
  top-5          76.3%
  top-10         81.8%
Extract Features: [100/156]	Time 0.327 (0.424)	Data 0.000 (0.221)	
Mean AP: 46.3%
CMC Scores:
  top-1          64.0%
  top-5          77.3%
  top-10         82.2%

 * Finished epoch  31  model no.1 mAP: 44.7% model no.2(mean-net) mAP: 46.3%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.325 (0.328)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.359333276748657
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.159 (0.247)	Data 0.000 (0.085)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.096834182739258
The orignal cluster result: num cluster = 1651(model) // 1639(model_ema) 	 num outliers = 125(model) // 129(model_ema)
Applying hierarchical clustering
[1108  376 1430 ...  726  428 1435]
(16522,)
(array([    6,    97,   188,   199,   394,   487,   689,   754,   911,
         921,  1063,  1098,  1396,  1644,  1871,  1902,  2066,  2127,
        2241,  2282,  2335,  2431,  2758,  2947,  3030,  3143,  3271,
        3363,  3540,  3582,  3794,  3933,  4196,  4257,  4334,  4401,
        4424,  4440,  4653,  4681,  4836,  4902,  5016,  5362,  5418,
        5440,  5513,  5534,  5546,  5598,  5603,  5631,  5872,  6126,
        6199,  6447,  6467,  6574,  6825,  6965,  7214,  7389,  7513,
        7612,  7725,  7842,  7953,  8232,  8237,  8263,  8471,  8609,
        8818,  8893,  9084,  9399,  9471,  9480,  9810, 10105, 10163,
       10213, 10439, 10764, 11172, 11194, 11301, 11553, 11750, 11849,
       11874, 12154, 12210, 12412, 12510, 12523, 12557, 12658, 12802,
       12980, 13511, 13606, 14009, 14050, 14079, 14278, 14405, 14459,
       14578, 14593, 14634, 14950, 15110, 15141, 15484, 15608, 15732,
       15736, 16045, 16202, 16203, 16307, 16334, 16442, 16467]),)
(16522, 16522)
(16397, 16522)
(16397, 16397)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=3.1704883575439453s
The HC Re-cluster result: num cluster = 1651(model) // 1639(model_ema) 	 num outliers = 125(model) // 129(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9354531764984131s
The UCIS result: num clean cluster = 1643(model) 	 num outliers = 297(model)
mdoel:new class are [1644], length of new dataset is 16225
Epoch: [32][0/300]	Time 2.436 (2.436)	Data 1.120 (1.120)	Loss_ce_clean 0.022 	Loss_ct_clean 0.023 	Prec 100.00%
Epoch: [32][50/300]	Time 1.987 (1.885)	Data 1.266 (1.078)	Loss_ce_clean 0.036 	Loss_ct_clean 0.028 	Prec 99.65%
Epoch: [32][100/300]	Time 0.952 (1.598)	Data 0.287 (0.836)	Loss_ce_clean 0.042 	Loss_ct_clean 0.087 	Prec 99.53%
Epoch: [32][150/300]	Time 0.962 (1.402)	Data 0.297 (0.672)	Loss_ce_clean 0.043 	Loss_ct_clean 0.109 	Prec 99.61%
Epoch: [32][200/300]	Time 0.844 (1.269)	Data 0.179 (0.554)	Loss_ce_clean 0.045 	Loss_ct_clean 0.115 	Prec 99.58%
Epoch: [32][250/300]	Time 0.840 (1.182)	Data 0.175 (0.477)	Loss_ce_clean 0.047 	Loss_ct_clean 0.117 	Prec 99.58%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.166)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.779421091079712
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.166)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.795746564865112
The orignal cluster result: num cluster = 1659(model) // 1650(model_ema) 	 num outliers = 88(model) // 139(model_ema)
Applying hierarchical clustering
[ 405  932  722 ...  247  563 1029]
(16522,)
(array([   97,   188,   190,   199,   262,   689,   754,   808,   911,
        1059,  1063,  1644,  1821,  1871,  1902,  2066,  2127,  2170,
        2205,  2575,  2947,  3030,  3143,  3582,  3794,  3933,  4334,
        4439,  4681,  4921,  5016,  5023,  5362,  5418,  5440,  5444,
        5513,  5578,  5631,  5816,  5848,  5872,  6199,  6447,  6965,
        6978,  7389,  7612,  7725,  8237,  8525,  8609,  8618,  8818,
        8824,  9084,  9399,  9471,  9480,  9754,  9810, 10346, 10825,
       11116, 11324, 11553, 11555, 11750, 11939, 12154, 12510, 12802,
       13432, 13511, 13606, 13709, 14079, 14291, 14593, 15076, 15141,
       15297, 15304, 15732, 16045, 16203, 16442, 16467]),)
(16522, 16522)
(16434, 16522)
(16434, 16434)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.228862762451172s
The HC Re-cluster result: num cluster = 1659(model) // 1650(model_ema) 	 num outliers = 88(model) // 139(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8834536075592041s
The UCIS result: num clean cluster = 1649(model) 	 num outliers = 312(model)
mdoel:new class are [1650], length of new dataset is 16210
Epoch: [33][0/300]	Time 0.946 (0.946)	Data 0.276 (0.276)	Loss_ce_clean 0.029 	Loss_ct_clean 0.028 	Prec 99.22%
Epoch: [33][50/300]	Time 0.854 (0.895)	Data 0.185 (0.229)	Loss_ce_clean 0.038 	Loss_ct_clean 0.031 	Prec 99.56%
Epoch: [33][100/300]	Time 0.832 (0.860)	Data 0.167 (0.194)	Loss_ce_clean 0.040 	Loss_ct_clean 0.087 	Prec 99.57%
Epoch: [33][150/300]	Time 0.835 (0.840)	Data 0.169 (0.174)	Loss_ce_clean 0.042 	Loss_ct_clean 0.105 	Prec 99.54%
Epoch: [33][200/300]	Time 0.779 (0.826)	Data 0.114 (0.161)	Loss_ce_clean 0.042 	Loss_ct_clean 0.111 	Prec 99.60%
Epoch: [33][250/300]	Time 0.825 (0.822)	Data 0.159 (0.156)	Loss_ce_clean 0.043 	Loss_ct_clean 0.113 	Prec 99.60%
Extract Features: [100/156]	Time 2.025 (0.297)	Data 1.861 (0.128)	
Mean AP: 41.3%
CMC Scores:
  top-1          60.5%
  top-5          74.1%
  top-10         79.6%
Extract Features: [100/156]	Time 0.157 (0.403)	Data 0.000 (0.245)	
Mean AP: 45.3%
CMC Scores:
  top-1          63.5%
  top-5          76.4%
  top-10         81.7%

 * Finished epoch  33  model no.1 mAP: 41.3% model no.2(mean-net) mAP: 45.3%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.170)	Data 0.000 (0.013)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.390905380249023
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.295 (0.332)	Data 0.000 (0.022)	
Computing jaccard distance...
Jaccard distance computing time cost: 11.092670679092407
The orignal cluster result: num cluster = 1667(model) // 1655(model_ema) 	 num outliers = 118(model) // 131(model_ema)
Applying hierarchical clustering
[ 374  880  652 ...  519 1359 1125]
(16522,)
(array([    6,     7,    42,   188,   190,   199,   487,   680,   689,
         911,  1063,  1097,  1246,  1644,  1871,  1944,  2066,  2127,
        2205,  2282,  2319,  2431,  2575,  2584,  2930,  3143,  3518,
        3582,  3608,  3773,  3873,  3933,  4196,  4257,  4334,  4681,
        4902,  5016,  5023,  5362,  5418,  5440,  5513,  5534,  5546,
        5578,  5598,  5631,  5848,  6065,  6199,  6574,  6729,  6939,
        6957,  6965,  7292,  7389,  7612,  8232,  8237,  8471,  8525,
        8705,  8818,  8824,  8974,  9084,  9115,  9276,  9312,  9399,
        9480,  9810, 10105, 10346, 10585, 10764, 10825, 11038, 11116,
       11256, 11324, 11553, 11555, 11750, 12154, 12210, 12414, 12557,
       12802, 12980, 13159, 13245, 13432, 13511, 13606, 13827, 13841,
       14050, 14079, 14122, 14278, 14487, 14593, 14634, 14670, 14761,
       14847, 14944, 15005, 15297, 15608, 15732, 15932, 16045, 16202,
       16203]),)
(16522, 16522)
(16404, 16522)
(16404, 16404)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=3.416846513748169s
The HC Re-cluster result: num cluster = 1667(model) // 1655(model_ema) 	 num outliers = 118(model) // 131(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.0878560543060303s
The UCIS result: num clean cluster = 1662(model) 	 num outliers = 237(model)
mdoel:new class are [1663], length of new dataset is 16285
Epoch: [34][0/300]	Time 3.981 (3.981)	Data 1.270 (1.270)	Loss_ce_clean 0.016 	Loss_ct_clean 0.015 	Prec 100.00%
Epoch: [34][50/300]	Time 1.509 (1.913)	Data 0.697 (1.081)	Loss_ce_clean 0.042 	Loss_ct_clean 0.033 	Prec 99.37%
Epoch: [34][100/300]	Time 0.963 (1.637)	Data 0.293 (0.850)	Loss_ce_clean 0.044 	Loss_ct_clean 0.090 	Prec 99.40%
Epoch: [34][150/300]	Time 1.011 (1.447)	Data 0.345 (0.700)	Loss_ce_clean 0.046 	Loss_ct_clean 0.109 	Prec 99.38%
Epoch: [34][200/300]	Time 0.842 (1.309)	Data 0.176 (0.582)	Loss_ce_clean 0.046 	Loss_ct_clean 0.115 	Prec 99.41%
Epoch: [34][250/300]	Time 1.552 (1.315)	Data 0.147 (0.560)	Loss_ce_clean 0.048 	Loss_ct_clean 0.120 	Prec 99.41%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.183)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.721054077148438
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.215)	Data 0.000 (0.058)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.470387697219849
The orignal cluster result: num cluster = 1676(model) // 1662(model_ema) 	 num outliers = 95(model) // 120(model_ema)
Applying hierarchical clustering
[1397  821  983 ...  455  223 1672]
(16522,)
(array([    6,     7,    97,   190,   199,   207,   689,   754,   808,
         911,  1059,  1063,  1098,  1644,  1871,  1902,  2127,  2205,
        2431,  2575,  3271,  3582,  3773,  4334,  4681,  4902,  4921,
        5016,  5065,  5265,  5362,  5418,  5440,  5513,  5534,  5578,
        5631,  5872,  6574,  6939,  7214,  7292,  7389,  8237,  8525,
        8705,  8818,  8893,  9077,  9084,  9312,  9480,  9810,  9978,
       10105, 10154, 10764, 10825, 11116, 11194, 11324, 11553, 11555,
       11750, 11849, 11939, 12412, 12523, 12557, 12658, 12802, 12980,
       13102, 13245, 13511, 13606, 13734, 14050, 14122, 14278, 14487,
       14593, 14680, 14944, 14950, 15076, 15141, 15229, 15340, 15608,
       15732, 15736, 16045, 16307, 16482]),)
(16522, 16522)
(16427, 16522)
(16427, 16427)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=5.3158228397369385s
The HC Re-cluster result: num cluster = 1676(model) // 1662(model_ema) 	 num outliers = 95(model) // 120(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=1.130615472793579s
The UCIS result: num clean cluster = 1666(model) 	 num outliers = 274(model)
mdoel:new class are [1667], length of new dataset is 16248
Epoch: [35][0/300]	Time 2.559 (2.559)	Data 0.781 (0.781)	Loss_ce_clean 0.019 	Loss_ct_clean 0.021 	Prec 100.00%
Epoch: [35][50/300]	Time 1.664 (1.757)	Data 0.969 (0.744)	Loss_ce_clean 0.037 	Loss_ct_clean 0.028 	Prec 99.63%
Epoch: [35][100/300]	Time 1.717 (1.627)	Data 0.903 (0.721)	Loss_ce_clean 0.040 	Loss_ct_clean 0.083 	Prec 99.61%
Epoch: [35][150/300]	Time 1.887 (1.595)	Data 1.217 (0.736)	Loss_ce_clean 0.042 	Loss_ct_clean 0.103 	Prec 99.62%
Epoch: [35][200/300]	Time 0.972 (1.605)	Data 0.307 (0.794)	Loss_ce_clean 0.044 	Loss_ct_clean 0.112 	Prec 99.58%
Epoch: [35][250/300]	Time 0.940 (1.499)	Data 0.270 (0.717)	Loss_ce_clean 0.046 	Loss_ct_clean 0.115 	Prec 99.57%
Extract Features: [100/156]	Time 0.157 (0.168)	Data 0.000 (0.010)	
Mean AP: 41.1%
CMC Scores:
  top-1          60.1%
  top-5          74.0%
  top-10         80.0%
Extract Features: [100/156]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Mean AP: 45.0%
CMC Scores:
  top-1          64.0%
  top-5          76.9%
  top-10         81.9%

 * Finished epoch  35  model no.1 mAP: 41.1% model no.2(mean-net) mAP: 45.0%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.170)	Data 0.000 (0.013)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.986413955688477
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.170)	Data 0.000 (0.014)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.811978578567505
The orignal cluster result: num cluster = 1679(model) // 1670(model_ema) 	 num outliers = 94(model) // 112(model_ema)
Applying hierarchical clustering
[1450  419 1103 ...  702  500 1593]
(16522,)
(array([    6,    97,   190,   199,   680,   689,   754,   911,  1059,
        1063,  1098,  1644,  1902,  2066,  2127,  2208,  2575,  2912,
        3142,  3271,  3582,  3933,  4101,  4334,  4440,  4681,  5016,
        5362,  5440,  5513,  5546,  5578,  5631,  5677,  5848,  6199,
        6447,  6467,  6729,  6965,  7292,  7389,  7612,  8525,  8609,
        8818,  9084,  9312,  9326,  9371,  9399,  9471,  9480,  9719,
        9744,  9810, 10105, 10127, 10346, 10585, 10764, 10825, 11038,
       11116, 11324, 11553, 11750, 11939, 12412, 12449, 12523, 12557,
       12658, 12980, 13102, 13159, 13606, 13657, 13734, 13827, 14050,
       14122, 14278, 14593, 14634, 14847, 15229, 15608, 15732, 16045,
       16202, 16203, 16307, 16442]),)
(16522, 16522)
(16428, 16522)
(16428, 16428)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1463189125061035s
The HC Re-cluster result: num cluster = 1679(model) // 1670(model_ema) 	 num outliers = 94(model) // 112(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8703262805938721s
The UCIS result: num clean cluster = 1674(model) 	 num outliers = 233(model)
mdoel:new class are [1675], length of new dataset is 16289
Epoch: [36][0/300]	Time 0.788 (0.788)	Data 0.118 (0.118)	Loss_ce_clean 0.022 	Loss_ct_clean 0.018 	Prec 100.00%
Epoch: [36][50/300]	Time 0.773 (0.771)	Data 0.103 (0.105)	Loss_ce_clean 0.038 	Loss_ct_clean 0.031 	Prec 99.59%
Epoch: [36][100/300]	Time 0.768 (0.770)	Data 0.102 (0.105)	Loss_ce_clean 0.038 	Loss_ct_clean 0.078 	Prec 99.61%
Epoch: [36][150/300]	Time 0.771 (0.770)	Data 0.105 (0.104)	Loss_ce_clean 0.040 	Loss_ct_clean 0.095 	Prec 99.64%
Epoch: [36][200/300]	Time 0.768 (0.770)	Data 0.102 (0.104)	Loss_ce_clean 0.042 	Loss_ct_clean 0.102 	Prec 99.63%
Epoch: [36][250/300]	Time 0.769 (0.794)	Data 0.104 (0.128)	Loss_ce_clean 0.043 	Loss_ct_clean 0.104 	Prec 99.64%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.169)	Data 0.000 (0.012)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.777811765670776
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.157 (0.167)	Data 0.000 (0.011)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.880214929580688
The orignal cluster result: num cluster = 1690(model) // 1676(model_ema) 	 num outliers = 90(model) // 104(model_ema)
Applying hierarchical clustering
[ 802  411 1447 ... 1183  570 1097]
(16522,)
(array([    7,    97,   199,   754,   911,  1059,  1063,  1098,  1644,
        1796,  2066,  2127,  2205,  2282,  2441,  2758,  3046,  3142,
        3271,  3404,  3582,  3766,  3773,  3933,  4153,  4334,  4902,
        4921,  5016,  5362,  5418,  5440,  5513,  5546,  5848,  5913,
        6068,  6199,  6270,  6472,  6629,  6729,  6774,  6939,  7214,
        7292,  7389,  7528,  7612,  7831,  8237,  8525,  8609,  9084,
        9326,  9399,  9480,  9719, 10298, 10585, 10764, 10825, 11038,
       11503, 11693, 11750, 12044, 12412, 12557, 12802, 13102, 13159,
       13511, 13606, 14122, 14278, 14593, 14623, 14634, 14768, 14847,
       14944, 15076, 15608, 15736, 16045, 16202, 16203, 16467, 16472]),)
(16522, 16522)
(16432, 16522)
(16432, 16432)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.142841100692749s
The HC Re-cluster result: num cluster = 1690(model) // 1676(model_ema) 	 num outliers = 90(model) // 104(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8652312755584717s
The UCIS result: num clean cluster = 1686(model) 	 num outliers = 182(model)
mdoel:new class are [1687], length of new dataset is 16340
Epoch: [37][0/300]	Time 0.781 (0.781)	Data 0.112 (0.112)	Loss_ce_clean 0.015 	Loss_ct_clean 0.016 	Prec 100.00%
Epoch: [37][50/300]	Time 0.769 (0.768)	Data 0.104 (0.103)	Loss_ce_clean 0.036 	Loss_ct_clean 0.028 	Prec 99.48%
Epoch: [37][100/300]	Time 0.770 (0.768)	Data 0.105 (0.103)	Loss_ce_clean 0.038 	Loss_ct_clean 0.077 	Prec 99.57%
Epoch: [37][150/300]	Time 0.769 (0.768)	Data 0.104 (0.103)	Loss_ce_clean 0.041 	Loss_ct_clean 0.095 	Prec 99.56%
Epoch: [37][200/300]	Time 0.774 (0.769)	Data 0.108 (0.103)	Loss_ce_clean 0.043 	Loss_ct_clean 0.103 	Prec 99.56%
Epoch: [37][250/300]	Time 0.768 (0.769)	Data 0.102 (0.103)	Loss_ce_clean 0.044 	Loss_ct_clean 0.108 	Prec 99.56%
Extract Features: [100/156]	Time 0.157 (0.164)	Data 0.000 (0.008)	
Mean AP: 41.7%
CMC Scores:
  top-1          60.4%
  top-5          74.3%
  top-10         79.7%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 44.3%
CMC Scores:
  top-1          62.7%
  top-5          76.1%
  top-10         81.8%

 * Finished epoch  37  model no.1 mAP: 41.7% model no.2(mean-net) mAP: 44.3%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.668382167816162
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.787468671798706
The orignal cluster result: num cluster = 1694(model) // 1682(model_ema) 	 num outliers = 95(model) // 102(model_ema)
Applying hierarchical clustering
[1145  333 1479 ... 1112  402 1545]
(16522,)
(array([   97,   190,   199,   269,   481,   680,   754,   911,  1063,
        1097,  1098,  1246,  1473,  1644,  1916,  1938,  1944,  2205,
        2282,  2319,  2584,  3046,  3271,  3685,  3873,  3963,  4105,
        4257,  4902,  4921,  5016,  5513,  5546,  5631,  5848,  6195,
        6199,  6574,  6729,  6736,  6764,  6957,  7214,  7389,  7612,
        8042,  8104,  8178,  8357,  8471,  8544,  8609,  8799,  8818,
        8824,  8893,  9005,  9399,  9480, 10298, 10346, 10585, 10764,
       10825, 10932, 11038, 11553, 11849, 11939, 12412, 12491, 12980,
       13102, 13159, 13245, 13432, 13507, 13669, 13827, 13841, 14050,
       14122, 14278, 14295, 14306, 14593, 14847, 15005, 15197, 15229,
       15608, 16045, 16202, 16307, 16467]),)
(16522, 16522)
(16427, 16522)
(16427, 16427)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.200900077819824s
The HC Re-cluster result: num cluster = 1694(model) // 1682(model_ema) 	 num outliers = 95(model) // 102(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8680789470672607s
The UCIS result: num clean cluster = 1687(model) 	 num outliers = 223(model)
mdoel:new class are [1688], length of new dataset is 16299
Epoch: [38][0/300]	Time 0.789 (0.789)	Data 0.118 (0.118)	Loss_ce_clean 0.023 	Loss_ct_clean 0.023 	Prec 100.00%
Epoch: [38][50/300]	Time 0.771 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.039 	Loss_ct_clean 0.030 	Prec 99.36%
Epoch: [38][100/300]	Time 0.775 (0.770)	Data 0.110 (0.105)	Loss_ce_clean 0.039 	Loss_ct_clean 0.081 	Prec 99.46%
Epoch: [38][150/300]	Time 0.768 (0.770)	Data 0.103 (0.104)	Loss_ce_clean 0.040 	Loss_ct_clean 0.094 	Prec 99.49%
Epoch: [38][200/300]	Time 0.770 (0.770)	Data 0.104 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.099 	Prec 99.54%
Epoch: [38][250/300]	Time 0.771 (0.770)	Data 0.105 (0.104)	Loss_ce_clean 0.042 	Loss_ct_clean 0.102 	Prec 99.54%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.76231861114502
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.764699220657349
The orignal cluster result: num cluster = 1699(model) // 1691(model_ema) 	 num outliers = 82(model) // 87(model_ema)
Applying hierarchical clustering
[1156  449 1138 ... 1266  518 1351]
(16522,)
(array([    7,   190,   199,   269,   680,   689,  1063,  1473,  1644,
        1723,  2127,  2133,  2282,  3518,  3566,  3685,  3933,  3963,
        4105,  4153,  4257,  4334,  5016,  5068,  5265,  5440,  5513,
        5546,  5578,  5631,  5838,  5848,  6068,  6199,  6569,  6574,
        7389,  7446,  7612,  7825,  8104,  8471,  8544,  8705,  8799,
        8818,  8824,  8893,  9005,  9312,  9480,  9978, 10764, 10825,
       10932, 11324, 11503, 11939, 12412, 12491, 12523, 12557, 12929,
       12980, 13102, 13159, 13245, 13432, 13606, 13669, 13734, 13841,
       14050, 14122, 14278, 14295, 14306, 15052, 15197, 15229, 15686,
       16045]),)
(16522, 16522)
(16440, 16522)
(16440, 16440)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1653151512145996s
The HC Re-cluster result: num cluster = 1699(model) // 1691(model_ema) 	 num outliers = 82(model) // 87(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8821678161621094s
The UCIS result: num clean cluster = 1692(model) 	 num outliers = 224(model)
mdoel:new class are [1693], length of new dataset is 16298
Epoch: [39][0/300]	Time 0.786 (0.786)	Data 0.116 (0.116)	Loss_ce_clean 0.015 	Loss_ct_clean 0.015 	Prec 100.00%
Epoch: [39][50/300]	Time 0.769 (0.770)	Data 0.104 (0.105)	Loss_ce_clean 0.035 	Loss_ct_clean 0.025 	Prec 99.48%
Epoch: [39][100/300]	Time 0.778 (0.770)	Data 0.112 (0.104)	Loss_ce_clean 0.037 	Loss_ct_clean 0.075 	Prec 99.56%
Epoch: [39][150/300]	Time 0.768 (0.770)	Data 0.102 (0.105)	Loss_ce_clean 0.040 	Loss_ct_clean 0.092 	Prec 99.56%
Epoch: [39][200/300]	Time 0.773 (0.770)	Data 0.108 (0.105)	Loss_ce_clean 0.041 	Loss_ct_clean 0.097 	Prec 99.56%
Epoch: [39][250/300]	Time 0.780 (0.770)	Data 0.114 (0.104)	Loss_ce_clean 0.043 	Loss_ct_clean 0.103 	Prec 99.54%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 41.7%
CMC Scores:
  top-1          60.1%
  top-5          74.1%
  top-10         79.4%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 43.8%
CMC Scores:
  top-1          61.7%
  top-5          75.3%
  top-10         81.4%

 * Finished epoch  39  model no.1 mAP: 41.7% model no.2(mean-net) mAP: 43.8%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.69239592552185
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.817058801651001
The orignal cluster result: num cluster = 1704(model) // 1694(model_ema) 	 num outliers = 79(model) // 75(model_ema)
Applying hierarchical clustering
[ 891  910 1248 ...  664  580  829]
(16522,)
(array([   97,   190,   199,   203,   577,   680,   754,   911,  1063,
        1396,  1473,  1644,  1723,  2066,  2127,  2205,  2575,  3088,
        3518,  3774,  3933,  3963,  4257,  4334,  5016,  5338,  5513,
        5546,  5838,  5848,  5872,  6082,  6083,  6195,  6199,  6574,
        6965,  7214,  7389,  7446,  8411,  8452,  8471,  8505,  8544,
        8799,  8818,  8824,  9480,  9978, 10140, 10346, 10764, 11116,
       11324, 12115, 12358, 12401, 12491, 12523, 12557, 12980, 13102,
       13159, 13245, 13541, 13734, 13841, 14122, 14226, 14261, 14278,
       14295, 14306, 14593, 15589, 15608, 16203, 16321]),)
(16522, 16522)
(16443, 16522)
(16443, 16443)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.239130735397339s
The HC Re-cluster result: num cluster = 1704(model) // 1694(model_ema) 	 num outliers = 79(model) // 75(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.857170820236206s
The UCIS result: num clean cluster = 1700(model) 	 num outliers = 161(model)
mdoel:new class are [1701], length of new dataset is 16361
Epoch: [40][0/300]	Time 0.789 (0.789)	Data 0.121 (0.121)	Loss_ce_clean 0.015 	Loss_ct_clean 0.012 	Prec 100.00%
Epoch: [40][50/300]	Time 0.774 (0.769)	Data 0.108 (0.104)	Loss_ce_clean 0.035 	Loss_ct_clean 0.028 	Prec 99.54%
Epoch: [40][100/300]	Time 0.771 (0.770)	Data 0.105 (0.104)	Loss_ce_clean 0.037 	Loss_ct_clean 0.070 	Prec 99.61%
Epoch: [40][150/300]	Time 0.770 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.038 	Loss_ct_clean 0.090 	Prec 99.62%
Epoch: [40][200/300]	Time 0.772 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.098 	Prec 99.60%
Epoch: [40][250/300]	Time 0.771 (0.769)	Data 0.106 (0.104)	Loss_ce_clean 0.043 	Loss_ct_clean 0.102 	Prec 99.58%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.798907279968262
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.786036729812622
The orignal cluster result: num cluster = 1707(model) // 1700(model_ema) 	 num outliers = 69(model) // 75(model_ema)
Applying hierarchical clustering
[1054 1279  253 ...  997  192 1540]
(16522,)
(array([    6,     7,   190,   199,   577,   680,   754,   911,  1059,
        1063,  1473,  1723,  2127,  2282,  2319,  2769,  3324,  3518,
        3582,  3933,  3963,  4257,  4334,  4902,  5338,  5418,  5513,
        5848,  6082,  6083,  6195,  7214,  7371,  7389,  8104,  8232,
        8411,  8471,  8505,  8525,  8544,  8818,  8824,  8893,  9810,
       10140, 10825, 11324, 12115, 12154, 12412, 12491, 12523, 12557,
       13102, 13159, 13245, 13432, 13841, 14122, 14226, 14261, 14306,
       14327, 14670, 15229, 15608, 16202, 16307]),)
(16522, 16522)
(16453, 16522)
(16453, 16453)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2542924880981445s
The HC Re-cluster result: num cluster = 1707(model) // 1700(model_ema) 	 num outliers = 69(model) // 75(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8571066856384277s
The UCIS result: num clean cluster = 1700(model) 	 num outliers = 199(model)
mdoel:new class are [1701], length of new dataset is 16323
Epoch: [41][0/300]	Time 0.786 (0.786)	Data 0.117 (0.117)	Loss_ce_clean 0.007 	Loss_ct_clean 0.008 	Prec 100.00%
Epoch: [41][50/300]	Time 0.773 (0.770)	Data 0.107 (0.104)	Loss_ce_clean 0.036 	Loss_ct_clean 0.029 	Prec 99.56%
Epoch: [41][100/300]	Time 0.780 (0.769)	Data 0.114 (0.104)	Loss_ce_clean 0.039 	Loss_ct_clean 0.073 	Prec 99.54%
Epoch: [41][150/300]	Time 0.771 (0.769)	Data 0.106 (0.104)	Loss_ce_clean 0.040 	Loss_ct_clean 0.088 	Prec 99.54%
Epoch: [41][200/300]	Time 0.770 (0.769)	Data 0.104 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.095 	Prec 99.54%
Epoch: [41][250/300]	Time 0.769 (0.769)	Data 0.104 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.096 	Prec 99.56%
Extract Features: [100/156]	Time 0.157 (0.163)	Data 0.000 (0.007)	
Mean AP: 40.6%
CMC Scores:
  top-1          59.3%
  top-5          73.6%
  top-10         79.3%
Extract Features: [100/156]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Mean AP: 43.7%
CMC Scores:
  top-1          62.0%
  top-5          75.8%
  top-10         81.1%

 * Finished epoch  41  model no.1 mAP: 40.6% model no.2(mean-net) mAP: 43.7%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.749261617660522
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.79729175567627
The orignal cluster result: num cluster = 1712(model) // 1703(model_ema) 	 num outliers = 56(model) // 64(model_ema)
Applying hierarchical clustering
[ 879  512 1574 ...  907  743  669]
(16522,)
(array([    6,   183,   199,   269,   577,   754,  1063,  1644,  1723,
        2205,  2406,  2431,  2881,  3933,  4105,  4257,  5016,  5068,
        5338,  5513,  5631,  5848,  5872,  6083,  7186,  7389,  7446,
        7831,  8045,  8471,  8505,  9332,  9433, 10825, 10933, 11324,
       11553, 11620, 12253, 12412, 12491, 12523, 12929, 13159, 13245,
       13827, 13861, 14226, 14295, 14327, 14369, 14593, 15052, 15841,
       16202, 16307]),)
(16522, 16522)
(16466, 16522)
(16466, 16466)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.205239772796631s
The HC Re-cluster result: num cluster = 1712(model) // 1703(model_ema) 	 num outliers = 56(model) // 64(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8460135459899902s
The UCIS result: num clean cluster = 1707(model) 	 num outliers = 196(model)
mdoel:new class are [1708], length of new dataset is 16326
Epoch: [42][0/300]	Time 0.790 (0.790)	Data 0.121 (0.121)	Loss_ce_clean 0.012 	Loss_ct_clean 0.013 	Prec 100.00%
Epoch: [42][50/300]	Time 0.770 (0.770)	Data 0.105 (0.105)	Loss_ce_clean 0.035 	Loss_ct_clean 0.027 	Prec 99.51%
Epoch: [42][100/300]	Time 0.768 (0.769)	Data 0.103 (0.104)	Loss_ce_clean 0.035 	Loss_ct_clean 0.071 	Prec 99.58%
Epoch: [42][150/300]	Time 0.772 (0.769)	Data 0.106 (0.104)	Loss_ce_clean 0.038 	Loss_ct_clean 0.087 	Prec 99.59%
Epoch: [42][200/300]	Time 0.768 (0.769)	Data 0.103 (0.104)	Loss_ce_clean 0.040 	Loss_ct_clean 0.095 	Prec 99.58%
Epoch: [42][250/300]	Time 0.767 (0.769)	Data 0.102 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.098 	Prec 99.61%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.711226224899292
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.855218887329102
The orignal cluster result: num cluster = 1721(model) // 1707(model_ema) 	 num outliers = 64(model) // 55(model_ema)
Applying hierarchical clustering
[1178  580  505 ...  178 1040  939]
(16522,)
(array([    6,    26,   190,   199,   269,   754,   755,  1000,  1097,
        1433,  1644,  1723,  1916,  2127,  2282,  2575,  2935,  3387,
        3582,  3685,  3933,  4105,  4257,  4334,  4463,  5016,  5240,
        5513,  5631,  5848,  6083,  6574,  7446,  7662,  7923,  8237,
        8505,  8705,  8799,  8818,  8824,  9480, 10180, 10233, 10346,
       10764, 10825, 10932, 11229, 11324, 12491, 12557, 12980, 13102,
       13245, 13280, 13487, 13841, 14278, 14593, 15115, 15197, 16202,
       16321]),)
(16522, 16522)
(16458, 16522)
(16458, 16458)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2242820262908936s
The HC Re-cluster result: num cluster = 1721(model) // 1707(model_ema) 	 num outliers = 64(model) // 55(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8647506237030029s
The UCIS result: num clean cluster = 1718(model) 	 num outliers = 147(model)
mdoel:new class are [1719], length of new dataset is 16375
Epoch: [43][0/300]	Time 0.788 (0.788)	Data 0.118 (0.118)	Loss_ce_clean 0.015 	Loss_ct_clean 0.014 	Prec 100.00%
Epoch: [43][50/300]	Time 0.769 (0.769)	Data 0.103 (0.104)	Loss_ce_clean 0.035 	Loss_ct_clean 0.028 	Prec 99.37%
Epoch: [43][100/300]	Time 0.772 (0.770)	Data 0.106 (0.105)	Loss_ce_clean 0.036 	Loss_ct_clean 0.070 	Prec 99.46%
Epoch: [43][150/300]	Time 0.769 (0.770)	Data 0.104 (0.105)	Loss_ce_clean 0.039 	Loss_ct_clean 0.085 	Prec 99.48%
Epoch: [43][200/300]	Time 0.771 (0.770)	Data 0.106 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.094 	Prec 99.46%
Epoch: [43][250/300]	Time 0.774 (0.770)	Data 0.109 (0.104)	Loss_ce_clean 0.043 	Loss_ct_clean 0.097 	Prec 99.47%
Extract Features: [100/156]	Time 0.157 (0.163)	Data 0.000 (0.007)	
Mean AP: 40.3%
CMC Scores:
  top-1          59.6%
  top-5          74.2%
  top-10         79.6%
Extract Features: [100/156]	Time 0.157 (0.163)	Data 0.000 (0.007)	
Mean AP: 43.3%
CMC Scores:
  top-1          61.8%
  top-5          75.5%
  top-10         80.9%

 * Finished epoch  43  model no.1 mAP: 40.3% model no.2(mean-net) mAP: 43.3%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.703784465789795
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.781189680099487
The orignal cluster result: num cluster = 1730(model) // 1713(model_ema) 	 num outliers = 52(model) // 56(model_ema)
Applying hierarchical clustering
[1180  284  703 ... 1553  686 1519]
(16522,)
(array([    6,   190,   199,  1063,  1473,  1644,  2127,  2205,  2282,
        2575,  2862,  3404,  3518,  3582,  3685,  3933,  4257,  4334,
        4526,  5016,  5440,  5513,  5631,  5838,  5848,  6199,  6574,
        6883,  7214,  8705,  8818,  8824,  9312,  9480,  9810, 10764,
       11229, 11553, 12412, 12491, 12980, 13245, 13473, 13827, 13841,
       13861, 14122, 14278, 14284, 15608, 16202, 16321]),)
(16522, 16522)
(16470, 16522)
(16470, 16470)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.193086624145508s
The HC Re-cluster result: num cluster = 1730(model) // 1713(model_ema) 	 num outliers = 52(model) // 56(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8487358093261719s
The UCIS result: num clean cluster = 1727(model) 	 num outliers = 106(model)
mdoel:new class are [1728], length of new dataset is 16416
Epoch: [44][0/300]	Time 0.786 (0.786)	Data 0.116 (0.116)	Loss_ce_clean 0.017 	Loss_ct_clean 0.017 	Prec 100.00%
Epoch: [44][50/300]	Time 0.770 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.035 	Loss_ct_clean 0.026 	Prec 99.53%
Epoch: [44][100/300]	Time 0.770 (0.769)	Data 0.104 (0.103)	Loss_ce_clean 0.037 	Loss_ct_clean 0.068 	Prec 99.56%
Epoch: [44][150/300]	Time 0.770 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.039 	Loss_ct_clean 0.083 	Prec 99.57%
Epoch: [44][200/300]	Time 0.768 (0.770)	Data 0.102 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.090 	Prec 99.53%
Epoch: [44][250/300]	Time 0.768 (0.769)	Data 0.103 (0.104)	Loss_ce_clean 0.042 	Loss_ct_clean 0.092 	Prec 99.56%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.78147840499878
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.789239883422852
The orignal cluster result: num cluster = 1731(model) // 1724(model_ema) 	 num outliers = 29(model) // 64(model_ema)
Applying hierarchical clustering
[1393  159 1183 ...  215 1525 1397]
(16522,)
(array([    6,   199,   911,  1063,  1644,  2127,  2205,  3582,  3685,
        4257,  4334,  4902,  5016,  5440,  5513,  6083,  9480,  9810,
       11172, 11229, 11256, 11324, 12491, 13102, 13734, 14122, 14278,
       16202, 16307]),)
(16522, 16522)
(16493, 16522)
(16493, 16493)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.245133876800537s
The HC Re-cluster result: num cluster = 1731(model) // 1724(model_ema) 	 num outliers = 29(model) // 64(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8436446189880371s
The UCIS result: num clean cluster = 1726(model) 	 num outliers = 138(model)
mdoel:new class are [1727], length of new dataset is 16384
Epoch: [45][0/300]	Time 0.788 (0.788)	Data 0.118 (0.118)	Loss_ce_clean 0.008 	Loss_ct_clean 0.008 	Prec 100.00%
Epoch: [45][50/300]	Time 0.768 (0.769)	Data 0.103 (0.104)	Loss_ce_clean 0.033 	Loss_ct_clean 0.025 	Prec 99.49%
Epoch: [45][100/300]	Time 0.769 (0.769)	Data 0.103 (0.103)	Loss_ce_clean 0.036 	Loss_ct_clean 0.064 	Prec 99.50%
Epoch: [45][150/300]	Time 0.767 (0.769)	Data 0.102 (0.104)	Loss_ce_clean 0.037 	Loss_ct_clean 0.077 	Prec 99.60%
Epoch: [45][200/300]	Time 0.767 (0.769)	Data 0.102 (0.104)	Loss_ce_clean 0.040 	Loss_ct_clean 0.087 	Prec 99.55%
Epoch: [45][250/300]	Time 0.770 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.090 	Prec 99.58%
Extract Features: [100/156]	Time 0.157 (0.164)	Data 0.000 (0.007)	
Mean AP: 41.5%
CMC Scores:
  top-1          59.9%
  top-5          73.7%
  top-10         80.4%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 42.4%
CMC Scores:
  top-1          60.2%
  top-5          74.5%
  top-10         80.7%

 * Finished epoch  45  model no.1 mAP: 41.5% model no.2(mean-net) mAP: 42.4%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.876282930374146
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.79684853553772
The orignal cluster result: num cluster = 1738(model) // 1733(model_ema) 	 num outliers = 56(model) // 51(model_ema)
Applying hierarchical clustering
[1445   35 1337 ... 1141  351 1669]
(16522,)
(array([  172,   190,   199,   269,   754,   911,  1063,  1246,  1644,
        1916,  2127,  2205,  2584,  3582,  3873,  4257,  4334,  4886,
        5016,  5129,  5265,  5440,  5513,  5872,  6083,  6153,  6199,
        6574,  6957,  7389,  8237,  8818,  8824,  9480,  9810, 10140,
       10346, 10764, 11256, 11553, 12491, 12523, 12557, 12980, 13102,
       13245, 13432, 13827, 13841, 14122, 14226, 14278, 14295, 14593,
       14761, 16202]),)
(16522, 16522)
(16466, 16522)
(16466, 16466)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2244646549224854s
The HC Re-cluster result: num cluster = 1738(model) // 1733(model_ema) 	 num outliers = 56(model) // 51(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8448522090911865s
The UCIS result: num clean cluster = 1735(model) 	 num outliers = 110(model)
mdoel:new class are [1736], length of new dataset is 16412
Epoch: [46][0/300]	Time 0.788 (0.788)	Data 0.117 (0.117)	Loss_ce_clean 0.047 	Loss_ct_clean 0.047 	Prec 97.66%
Epoch: [46][50/300]	Time 0.770 (0.769)	Data 0.105 (0.103)	Loss_ce_clean 0.040 	Loss_ct_clean 0.032 	Prec 99.51%
Epoch: [46][100/300]	Time 0.768 (0.768)	Data 0.103 (0.103)	Loss_ce_clean 0.039 	Loss_ct_clean 0.070 	Prec 99.50%
Epoch: [46][150/300]	Time 0.771 (0.768)	Data 0.105 (0.103)	Loss_ce_clean 0.040 	Loss_ct_clean 0.084 	Prec 99.51%
Epoch: [46][200/300]	Time 0.771 (0.769)	Data 0.105 (0.103)	Loss_ce_clean 0.042 	Loss_ct_clean 0.090 	Prec 99.49%
Epoch: [46][250/300]	Time 0.769 (0.769)	Data 0.104 (0.103)	Loss_ce_clean 0.043 	Loss_ct_clean 0.093 	Prec 99.49%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.884201526641846
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.985097646713257
The orignal cluster result: num cluster = 1737(model) // 1737(model_ema) 	 num outliers = 63(model) // 38(model_ema)
Applying hierarchical clustering
[1448  101 1670 ...  254  312  893]
(16522,)
(array([    6,   190,   199,   577,   911,  1063,  1246,  1473,  1644,
        1944,  2127,  2282,  2319,  2406,  2584,  3582,  3873,  3933,
        4257,  4334,  5016,  5129,  5265,  5338,  5440,  5513,  5631,
        6083,  6199,  6574,  6883,  6957,  8411,  8471,  8505,  8584,
        8697,  8705,  8824,  9312,  9810,  9978, 10933, 11553, 12491,
       12785, 12980, 13102, 13245, 13698, 13827, 13841, 13861, 14226,
       14278, 14295, 14593, 14670, 14763, 14916, 15352, 15498, 16202]),)
(16522, 16522)
(16459, 16522)
(16459, 16459)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1891722679138184s
The HC Re-cluster result: num cluster = 1737(model) // 1737(model_ema) 	 num outliers = 63(model) // 38(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.850167989730835s
The UCIS result: num clean cluster = 1731(model) 	 num outliers = 174(model)
mdoel:new class are [1732], length of new dataset is 16348
Epoch: [47][0/300]	Time 0.782 (0.782)	Data 0.112 (0.112)	Loss_ce_clean 0.012 	Loss_ct_clean 0.011 	Prec 100.00%
Epoch: [47][50/300]	Time 0.765 (0.768)	Data 0.100 (0.102)	Loss_ce_clean 0.029 	Loss_ct_clean 0.022 	Prec 99.68%
Epoch: [47][100/300]	Time 0.769 (0.768)	Data 0.103 (0.103)	Loss_ce_clean 0.035 	Loss_ct_clean 0.060 	Prec 99.54%
Epoch: [47][150/300]	Time 0.768 (0.768)	Data 0.102 (0.103)	Loss_ce_clean 0.039 	Loss_ct_clean 0.079 	Prec 99.53%
Epoch: [47][200/300]	Time 0.772 (0.768)	Data 0.106 (0.103)	Loss_ce_clean 0.040 	Loss_ct_clean 0.085 	Prec 99.53%
Epoch: [47][250/300]	Time 0.776 (0.768)	Data 0.110 (0.103)	Loss_ce_clean 0.042 	Loss_ct_clean 0.090 	Prec 99.54%
Extract Features: [100/156]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Mean AP: 38.3%
CMC Scores:
  top-1          57.4%
  top-5          71.9%
  top-10         78.3%
Extract Features: [100/156]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Mean AP: 41.8%
CMC Scores:
  top-1          60.0%
  top-5          74.7%
  top-10         80.5%

 * Finished epoch  47  model no.1 mAP: 38.3% model no.2(mean-net) mAP: 41.8%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.739116668701172
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.933550596237183
The orignal cluster result: num cluster = 1742(model) // 1740(model_ema) 	 num outliers = 79(model) // 80(model_ema)
Applying hierarchical clustering
[ 918  312 1454 ... 1618  234  766]
(16522,)
(array([    6,   199,   911,  1059,  1063,  1246,  1644,  1878,  2127,
        2133,  2182,  2228,  2406,  2584,  2754,  2922,  2927,  2995,
        3046,  3414,  3873,  3933,  4334,  4409,  4533,  5129,  5332,
        5440,  5513,  5559,  5631,  5888,  6199,  6442,  6466,  6629,
        6883,  6957,  7597,  7632,  7655,  7831,  8299,  8697,  9134,
        9693,  9810,  9897, 10136, 10825, 10933, 11059, 11146, 11166,
       11291, 11553, 12193, 12277, 12349, 12412, 12491, 12665, 13102,
       13229, 13239, 13494, 14052, 14122, 14226, 14278, 14593, 14955,
       15170, 15292, 15451, 15608, 16202, 16436, 16461]),)
(16522, 16522)
(16443, 16522)
(16443, 16443)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.21181058883667s
The HC Re-cluster result: num cluster = 1742(model) // 1740(model_ema) 	 num outliers = 79(model) // 80(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8558893203735352s
The UCIS result: num clean cluster = 1735(model) 	 num outliers = 264(model)
mdoel:new class are [1736], length of new dataset is 16258
Epoch: [48][0/300]	Time 0.790 (0.790)	Data 0.120 (0.120)	Loss_ce_clean 0.016 	Loss_ct_clean 0.016 	Prec 100.00%
Epoch: [48][50/300]	Time 0.768 (0.769)	Data 0.103 (0.103)	Loss_ce_clean 0.031 	Loss_ct_clean 0.024 	Prec 99.63%
Epoch: [48][100/300]	Time 0.769 (0.769)	Data 0.103 (0.103)	Loss_ce_clean 0.034 	Loss_ct_clean 0.060 	Prec 99.65%
Epoch: [48][150/300]	Time 0.771 (0.769)	Data 0.106 (0.104)	Loss_ce_clean 0.035 	Loss_ct_clean 0.072 	Prec 99.66%
Epoch: [48][200/300]	Time 0.767 (0.769)	Data 0.100 (0.104)	Loss_ce_clean 0.037 	Loss_ct_clean 0.079 	Prec 99.67%
Epoch: [48][250/300]	Time 0.768 (0.769)	Data 0.102 (0.104)	Loss_ce_clean 0.039 	Loss_ct_clean 0.082 	Prec 99.67%
==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.80197525024414
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.809046506881714
The orignal cluster result: num cluster = 1750(model) // 1738(model_ema) 	 num outliers = 58(model) // 26(model_ema)
Applying hierarchical clustering
[1400  283 1480 ... 1058   94  520]
(16522,)
(array([   20,   754,   911,  1059,  1063,  1246,  1644,  2127,  2133,
        2182,  2361,  2406,  2584,  2754,  2922,  2927,  3046,  3301,
        3404,  3414,  3873,  3933,  4334,  5332,  5440,  5631,  6199,
        6442,  6883,  6957,  7597,  7632,  7831,  8044,  8299,  8697,
        9312,  9360,  9810,  9897, 10298, 10353, 10825, 11166, 11291,
       11798, 12491, 12665, 12669, 13102, 13229, 13609, 14122, 14226,
       14278, 14593, 16202, 16436]),)
(16522, 16522)
(16464, 16522)
(16464, 16464)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.186440944671631s
The HC Re-cluster result: num cluster = 1750(model) // 1738(model_ema) 	 num outliers = 58(model) // 26(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8464727401733398s
The UCIS result: num clean cluster = 1747(model) 	 num outliers = 109(model)
mdoel:new class are [1748], length of new dataset is 16413
Epoch: [49][0/300]	Time 0.792 (0.792)	Data 0.122 (0.122)	Loss_ce_clean 0.018 	Loss_ct_clean 0.019 	Prec 100.00%
Epoch: [49][50/300]	Time 0.771 (0.770)	Data 0.106 (0.105)	Loss_ce_clean 0.035 	Loss_ct_clean 0.025 	Prec 99.42%
Epoch: [49][100/300]	Time 0.775 (0.770)	Data 0.110 (0.104)	Loss_ce_clean 0.037 	Loss_ct_clean 0.063 	Prec 99.51%
Epoch: [49][150/300]	Time 0.768 (0.769)	Data 0.103 (0.104)	Loss_ce_clean 0.039 	Loss_ct_clean 0.079 	Prec 99.53%
Epoch: [49][200/300]	Time 0.770 (0.769)	Data 0.104 (0.104)	Loss_ce_clean 0.040 	Loss_ct_clean 0.084 	Prec 99.56%
Epoch: [49][250/300]	Time 0.769 (0.769)	Data 0.104 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.085 	Prec 99.59%
Extract Features: [100/156]	Time 0.157 (0.163)	Data 0.000 (0.007)	
Mean AP: 41.4%
CMC Scores:
  top-1          59.5%
  top-5          73.9%
  top-10         79.8%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.006)	
Mean AP: 41.6%
CMC Scores:
  top-1          59.4%
  top-5          74.2%
  top-10         80.4%

 * Finished epoch  49  model no.1 mAP: 41.4% model no.2(mean-net) mAP: 41.6%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.78872036933899
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.883860349655151
The orignal cluster result: num cluster = 1755(model) // 1745(model_ema) 	 num outliers = 60(model) // 77(model_ema)
Applying hierarchical clustering
[1411  316  679 ...  665  122 1673]
(16522,)
(array([  911,  1063,  1246,  1473,  1944,  2182,  2282,  2406,  2431,
        2584,  2754,  2922,  2927,  3046,  3404,  3873,  3933,  4257,
        4334,  4624,  5077,  5332,  5440,  5631,  6199,  6574,  6629,
        6957,  7239,  7389,  7597,  7632,  7831,  7842,  8471,  8697,
        8818,  9810,  9897, 10346, 10825, 10933, 11166, 11291, 11798,
       12414, 12491, 12802, 12980, 13102, 13359, 13734, 13827, 14226,
       14295, 14593, 14896, 15005, 16202, 16436]),)
(16522, 16522)
(16462, 16522)
(16462, 16462)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2495970726013184s
The HC Re-cluster result: num cluster = 1755(model) // 1745(model_ema) 	 num outliers = 60(model) // 77(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8520956039428711s
The UCIS result: num clean cluster = 1753(model) 	 num outliers = 145(model)
mdoel:new class are [1754], length of new dataset is 16377
Epoch: [50][0/300]	Time 0.790 (0.790)	Data 0.119 (0.119)	Loss_ce_clean 0.027 	Loss_ct_clean 0.027 	Prec 99.22%
Epoch: [50][50/300]	Time 0.771 (0.770)	Data 0.106 (0.105)	Loss_ce_clean 0.033 	Loss_ct_clean 0.026 	Prec 99.59%
Epoch: [50][100/300]	Time 0.770 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.034 	Loss_ct_clean 0.060 	Prec 99.61%
Epoch: [50][150/300]	Time 0.771 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.037 	Loss_ct_clean 0.076 	Prec 99.59%
Epoch: [50][200/300]	Time 0.772 (0.769)	Data 0.106 (0.104)	Loss_ce_clean 0.040 	Loss_ct_clean 0.085 	Prec 99.53%
Epoch: [50][250/300]	Time 0.772 (0.769)	Data 0.107 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.087 	Prec 99.55%
Extract Features: [100/156]	Time 0.157 (0.164)	Data 0.000 (0.008)	
Mean AP: 39.5%
CMC Scores:
  top-1          58.2%
  top-5          72.4%
  top-10         79.2%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 41.5%
CMC Scores:
  top-1          59.6%
  top-5          74.7%
  top-10         80.7%

 * Finished epoch  50  model no.1 mAP: 39.5% model no.2(mean-net) mAP: 41.5%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.788808822631836
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.851039409637451
The orignal cluster result: num cluster = 1768(model) // 1752(model_ema) 	 num outliers = 41(model) // 50(model_ema)
Applying hierarchical clustering
[1350  272  895 ...   52   87 1442]
(16522,)
(array([  111,   321,   519,   911,  1063,  1263,  1644,  2406,  2438,
        2679,  3887,  4334,  4539,  5440,  6194,  6199,  6629,  6860,
        7389,  7393,  7842,  7998,  9312,  9810, 10298, 10933, 10973,
       12535, 13102, 13734, 13794, 14112, 14226, 14278, 14593, 15607,
       16086, 16093, 16202, 16235, 16447]),)
(16522, 16522)
(16481, 16522)
(16481, 16481)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1975457668304443s
The HC Re-cluster result: num cluster = 1768(model) // 1752(model_ema) 	 num outliers = 41(model) // 50(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8671541213989258s
The UCIS result: num clean cluster = 1764(model) 	 num outliers = 165(model)
mdoel:new class are [1765], length of new dataset is 16357
Epoch: [51][0/300]	Time 0.784 (0.784)	Data 0.117 (0.117)	Loss_ce_clean 0.011 	Loss_ct_clean 0.011 	Prec 100.00%
Epoch: [51][50/300]	Time 0.776 (0.770)	Data 0.111 (0.105)	Loss_ce_clean 0.036 	Loss_ct_clean 0.028 	Prec 99.40%
Epoch: [51][100/300]	Time 0.769 (0.770)	Data 0.104 (0.104)	Loss_ce_clean 0.037 	Loss_ct_clean 0.063 	Prec 99.55%
Epoch: [51][150/300]	Time 0.766 (0.770)	Data 0.100 (0.104)	Loss_ce_clean 0.040 	Loss_ct_clean 0.078 	Prec 99.48%
Epoch: [51][200/300]	Time 0.766 (0.770)	Data 0.101 (0.104)	Loss_ce_clean 0.041 	Loss_ct_clean 0.084 	Prec 99.53%
Epoch: [51][250/300]	Time 0.789 (0.770)	Data 0.123 (0.104)	Loss_ce_clean 0.042 	Loss_ct_clean 0.086 	Prec 99.55%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 38.8%
CMC Scores:
  top-1          56.8%
  top-5          72.4%
  top-10         78.5%
Extract Features: [100/156]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Mean AP: 41.0%
CMC Scores:
  top-1          59.0%
  top-5          74.2%
  top-10         80.3%

 * Finished epoch  51  model no.1 mAP: 38.8% model no.2(mean-net) mAP: 41.0%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.800979614257812
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.849325895309448
The orignal cluster result: num cluster = 1774(model) // 1763(model_ema) 	 num outliers = 40(model) // 62(model_ema)
Applying hierarchical clustering
[881  61 963 ... 404 582 299]
(16522,)
(array([  321,   911,  1226,  1644,  2127,  2282,  2374,  3046,  3185,
        4257,  4334,  4410,  4624,  5297,  5440,  5807,  5872,  6638,
        6883,  7842,  8237,  8471,  9720,  9810, 10140, 10200, 10298,
       10933, 12980, 13173, 13734, 13827, 14122, 14278, 14295, 15005,
       15899, 16202, 16307, 16467]),)
(16522, 16522)
(16482, 16522)
(16482, 16482)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1955411434173584s
The HC Re-cluster result: num cluster = 1774(model) // 1763(model_ema) 	 num outliers = 40(model) // 62(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8526496887207031s
The UCIS result: num clean cluster = 1769(model) 	 num outliers = 187(model)
mdoel:new class are [1770], length of new dataset is 16335
Epoch: [52][0/300]	Time 0.782 (0.782)	Data 0.113 (0.113)	Loss_ce_clean 0.019 	Loss_ct_clean 0.019 	Prec 100.00%
Epoch: [52][50/300]	Time 0.770 (0.769)	Data 0.104 (0.104)	Loss_ce_clean 0.029 	Loss_ct_clean 0.021 	Prec 99.74%
Epoch: [52][100/300]	Time 0.772 (0.769)	Data 0.106 (0.104)	Loss_ce_clean 0.033 	Loss_ct_clean 0.056 	Prec 99.64%
Epoch: [52][150/300]	Time 0.770 (0.770)	Data 0.105 (0.105)	Loss_ce_clean 0.035 	Loss_ct_clean 0.070 	Prec 99.64%
Epoch: [52][200/300]	Time 0.772 (0.771)	Data 0.106 (0.105)	Loss_ce_clean 0.037 	Loss_ct_clean 0.077 	Prec 99.65%
Epoch: [52][250/300]	Time 0.771 (0.770)	Data 0.105 (0.105)	Loss_ce_clean 0.038 	Loss_ct_clean 0.078 	Prec 99.68%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 37.1%
CMC Scores:
  top-1          56.2%
  top-5          71.3%
  top-10         76.8%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 40.7%
CMC Scores:
  top-1          59.1%
  top-5          74.2%
  top-10         80.2%

 * Finished epoch  52  model no.1 mAP: 37.1% model no.2(mean-net) mAP: 40.7%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.791548013687134
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.210)	Data 0.000 (0.044)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.260782718658447
The orignal cluster result: num cluster = 1783(model) // 1776(model_ema) 	 num outliers = 48(model) // 57(model_ema)
Applying hierarchical clustering
[ 970   79 1243 ...  726  457  310]
(16522,)
(array([  911,  1042,  1063,  2182,  2282,  2526,  2754,  2922,  2927,
        3046,  3404,  3414,  3489,  3577,  4257,  4334,  4624,  5297,
        5332,  5807,  6442,  6629,  6883,  7632,  7655,  7831,  7842,
        8044,  8237,  8299,  8697,  8880,  8959,  9720,  9810, 10298,
       10353, 11291, 12118, 12391, 12665, 13387, 13734, 14278, 14593,
       15170, 15352, 16475]),)
(16522, 16522)
(16474, 16522)
(16474, 16474)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2849552631378174s
The HC Re-cluster result: num cluster = 1783(model) // 1776(model_ema) 	 num outliers = 48(model) // 57(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.9532485008239746s
The UCIS result: num clean cluster = 1779(model) 	 num outliers = 130(model)
mdoel:new class are [1780], length of new dataset is 16392
Epoch: [53][0/300]	Time 0.953 (0.953)	Data 0.175 (0.175)	Loss_ce_clean 0.018 	Loss_ct_clean 0.016 	Prec 100.00%
Epoch: [53][50/300]	Time 0.768 (0.775)	Data 0.103 (0.107)	Loss_ce_clean 0.034 	Loss_ct_clean 0.026 	Prec 99.46%
Epoch: [53][100/300]	Time 0.786 (0.772)	Data 0.121 (0.105)	Loss_ce_clean 0.038 	Loss_ct_clean 0.065 	Prec 99.48%
Epoch: [53][150/300]	Time 0.775 (0.772)	Data 0.110 (0.106)	Loss_ce_clean 0.039 	Loss_ct_clean 0.081 	Prec 99.52%
Epoch: [53][200/300]	Time 0.766 (0.771)	Data 0.101 (0.105)	Loss_ce_clean 0.039 	Loss_ct_clean 0.084 	Prec 99.55%
Epoch: [53][250/300]	Time 0.768 (0.771)	Data 0.103 (0.105)	Loss_ce_clean 0.040 	Loss_ct_clean 0.084 	Prec 99.60%
Extract Features: [100/156]	Time 0.156 (0.247)	Data 0.000 (0.090)	
Mean AP: 39.3%
CMC Scores:
  top-1          57.9%
  top-5          71.7%
  top-10         79.0%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 40.5%
CMC Scores:
  top-1          59.0%
  top-5          73.6%
  top-10         79.8%

 * Finished epoch  53  model no.1 mAP: 39.3% model no.2(mean-net) mAP: 40.5%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.165)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.721956968307495
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.165)	Data 0.000 (0.009)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.876482725143433
The orignal cluster result: num cluster = 1787(model) // 1783(model_ema) 	 num outliers = 40(model) // 62(model_ema)
Applying hierarchical clustering
[1085  102 1720 ...  469  162  863]
(16522,)
(array([  577,   911,  1063,  1266,  1644,  2282,  2862,  2922,  2927,
        3045,  3046,  3414,  3933,  4257,  4334,  5332,  5554,  5631,
        6071,  6883,  7389,  7632,  8299,  8697,  8705,  9509,  9810,
       10825, 11291, 11661, 11798, 12044, 12802, 13102, 13861, 13906,
       14122, 14278, 16321, 16472]),)
(16522, 16522)
(16482, 16522)
(16482, 16482)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2150356769561768s
The HC Re-cluster result: num cluster = 1787(model) // 1783(model_ema) 	 num outliers = 40(model) // 62(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8665101528167725s
The UCIS result: num clean cluster = 1782(model) 	 num outliers = 181(model)
mdoel:new class are [1783], length of new dataset is 16341
Epoch: [54][0/300]	Time 0.786 (0.786)	Data 0.117 (0.117)	Loss_ce_clean 0.026 	Loss_ct_clean 0.025 	Prec 99.22%
Epoch: [54][50/300]	Time 0.771 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.034 	Loss_ct_clean 0.026 	Prec 99.51%
Epoch: [54][100/300]	Time 0.770 (0.770)	Data 0.104 (0.105)	Loss_ce_clean 0.033 	Loss_ct_clean 0.055 	Prec 99.61%
Epoch: [54][150/300]	Time 0.773 (0.770)	Data 0.107 (0.105)	Loss_ce_clean 0.036 	Loss_ct_clean 0.069 	Prec 99.62%
Epoch: [54][200/300]	Time 0.770 (0.770)	Data 0.105 (0.105)	Loss_ce_clean 0.038 	Loss_ct_clean 0.077 	Prec 99.60%
Epoch: [54][250/300]	Time 0.774 (0.770)	Data 0.108 (0.105)	Loss_ce_clean 0.039 	Loss_ct_clean 0.078 	Prec 99.65%
Extract Features: [100/156]	Time 0.156 (0.291)	Data 0.000 (0.135)	
Mean AP: 38.6%
CMC Scores:
  top-1          57.4%
  top-5          72.9%
  top-10         79.2%
Extract Features: [100/156]	Time 0.157 (0.163)	Data 0.000 (0.007)	
Mean AP: 40.3%
CMC Scores:
  top-1          58.8%
  top-5          73.4%
  top-10         79.7%

 * Finished epoch  54  model no.1 mAP: 38.6% model no.2(mean-net) mAP: 40.3%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.797546148300171
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.822721004486084
The orignal cluster result: num cluster = 1792(model) // 1784(model_ema) 	 num outliers = 41(model) // 48(model_ema)
Applying hierarchical clustering
[1077  262 1584 ... 1156   88 1352]
(16522,)
(array([  577,   911,  1063,  1644,  2228,  2282,  2441,  2817,  2862,
        3045,  3566,  3933,  4257,  4334,  4463,  5297,  5338,  5559,
        6071,  6083,  6466,  7389,  8411,  8505,  9720,  9810,  9860,
       10136, 10140, 11050, 11661, 12115, 12277, 13861, 14122, 14295,
       14593, 15170, 15451, 16307, 16321]),)
(16522, 16522)
(16481, 16522)
(16481, 16481)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.2430145740509033s
The HC Re-cluster result: num cluster = 1792(model) // 1784(model_ema) 	 num outliers = 41(model) // 48(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8619682788848877s
The UCIS result: num clean cluster = 1790(model) 	 num outliers = 140(model)
mdoel:new class are [1791], length of new dataset is 16382
Epoch: [55][0/300]	Time 0.785 (0.785)	Data 0.115 (0.115)	Loss_ce_clean 0.013 	Loss_ct_clean 0.014 	Prec 100.00%
Epoch: [55][50/300]	Time 0.772 (0.770)	Data 0.107 (0.105)	Loss_ce_clean 0.036 	Loss_ct_clean 0.028 	Prec 99.46%
Epoch: [55][100/300]	Time 0.766 (0.769)	Data 0.101 (0.104)	Loss_ce_clean 0.036 	Loss_ct_clean 0.061 	Prec 99.57%
Epoch: [55][150/300]	Time 0.807 (0.770)	Data 0.142 (0.104)	Loss_ce_clean 0.037 	Loss_ct_clean 0.073 	Prec 99.62%
Epoch: [55][200/300]	Time 0.770 (0.770)	Data 0.105 (0.104)	Loss_ce_clean 0.039 	Loss_ct_clean 0.079 	Prec 99.64%
Epoch: [55][250/300]	Time 0.771 (0.770)	Data 0.105 (0.105)	Loss_ce_clean 0.040 	Loss_ct_clean 0.081 	Prec 99.64%
Extract Features: [100/156]	Time 0.156 (0.165)	Data 0.000 (0.008)	
Mean AP: 37.4%
CMC Scores:
  top-1          56.9%
  top-5          71.9%
  top-10         78.1%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 40.2%
CMC Scores:
  top-1          58.9%
  top-5          73.5%
  top-10         79.8%

 * Finished epoch  55  model no.1 mAP: 37.4% model no.2(mean-net) mAP: 40.2%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.165)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.834515571594238
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.007)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.836010694503784
The orignal cluster result: num cluster = 1796(model) // 1789(model_ema) 	 num outliers = 45(model) // 43(model_ema)
Applying hierarchical clustering
[ 799  266 1235 ...  667   88  535]
(16522,)
(array([  755,  1063,  1473,  1644,  1723,  2282,  2817,  2922,  2927,
        3414,  4334,  4499,  5068,  5332,  6488,  6629,  6883,  7389,
        7446,  7632,  7831,  7842,  8044,  8237,  8299,  8697,  8705,
        9810, 10205, 11291, 11798, 12491, 12574, 12929, 12980, 13734,
       13800, 13827, 14122, 14226, 14278, 14593, 15052, 16202, 16307]),)
(16522, 16522)
(16477, 16522)
(16477, 16477)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.300171375274658s
The HC Re-cluster result: num cluster = 1796(model) // 1789(model_ema) 	 num outliers = 45(model) // 43(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8579220771789551s
The UCIS result: num clean cluster = 1795(model) 	 num outliers = 93(model)
mdoel:new class are [1796], length of new dataset is 16429
Epoch: [56][0/300]	Time 0.783 (0.783)	Data 0.112 (0.112)	Loss_ce_clean 0.022 	Loss_ct_clean 0.024 	Prec 100.00%
Epoch: [56][50/300]	Time 0.780 (0.770)	Data 0.115 (0.105)	Loss_ce_clean 0.031 	Loss_ct_clean 0.023 	Prec 99.62%
Epoch: [56][100/300]	Time 0.772 (0.771)	Data 0.106 (0.106)	Loss_ce_clean 0.033 	Loss_ct_clean 0.056 	Prec 99.57%
Epoch: [56][150/300]	Time 0.777 (0.771)	Data 0.111 (0.106)	Loss_ce_clean 0.035 	Loss_ct_clean 0.070 	Prec 99.62%
Epoch: [56][200/300]	Time 0.770 (0.771)	Data 0.104 (0.105)	Loss_ce_clean 0.036 	Loss_ct_clean 0.074 	Prec 99.67%
Epoch: [56][250/300]	Time 0.766 (0.770)	Data 0.101 (0.105)	Loss_ce_clean 0.038 	Loss_ct_clean 0.078 	Prec 99.66%
Extract Features: [100/156]	Time 0.157 (0.164)	Data 0.000 (0.008)	
Mean AP: 39.4%
CMC Scores:
  top-1          57.2%
  top-5          73.1%
  top-10         78.8%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 39.9%
CMC Scores:
  top-1          58.6%
  top-5          73.6%
  top-10         79.5%

 * Finished epoch  56  model no.1 mAP: 39.4% model no.2(mean-net) mAP: 39.9%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.868640661239624
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.918298482894897
The orignal cluster result: num cluster = 1793(model) // 1794(model_ema) 	 num outliers = 17(model) // 42(model_ema)
Applying hierarchical clustering
[1085  122 1348 ...  444  183  455]
(16522,)
(array([ 1063,  1644,  2282,  2922,  3933,  4257,  4624,  4959,  6883,
        7389,  7842,  8237,  9810, 10825, 13734, 14593, 16307]),)
(16522, 16522)
(16505, 16522)
(16505, 16505)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.7099335193634033s
The HC Re-cluster result: num cluster = 1793(model) // 1794(model_ema) 	 num outliers = 17(model) // 42(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.880070686340332s
The UCIS result: num clean cluster = 1788(model) 	 num outliers = 149(model)
mdoel:new class are [1789], length of new dataset is 16373
Epoch: [57][0/300]	Time 0.781 (0.781)	Data 0.114 (0.114)	Loss_ce_clean 0.010 	Loss_ct_clean 0.011 	Prec 100.00%
Epoch: [57][50/300]	Time 0.771 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.024 	Loss_ct_clean 0.018 	Prec 99.80%
Epoch: [57][100/300]	Time 0.771 (0.770)	Data 0.105 (0.105)	Loss_ce_clean 0.028 	Loss_ct_clean 0.047 	Prec 99.79%
Epoch: [57][150/300]	Time 0.769 (0.771)	Data 0.104 (0.105)	Loss_ce_clean 0.031 	Loss_ct_clean 0.062 	Prec 99.78%
Epoch: [57][200/300]	Time 0.776 (0.771)	Data 0.111 (0.106)	Loss_ce_clean 0.034 	Loss_ct_clean 0.069 	Prec 99.75%
Epoch: [57][250/300]	Time 0.781 (0.771)	Data 0.115 (0.106)	Loss_ce_clean 0.035 	Loss_ct_clean 0.071 	Prec 99.76%
Extract Features: [100/156]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Mean AP: 37.4%
CMC Scores:
  top-1          56.9%
  top-5          71.4%
  top-10         77.7%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 39.4%
CMC Scores:
  top-1          58.2%
  top-5          73.5%
  top-10         79.3%

 * Finished epoch  57  model no.1 mAP: 37.4% model no.2(mean-net) mAP: 39.4%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.877056360244751
==> Create pseudo labels for unlabeled target domain with model_ema
Extract Features: [100/130]	Time 0.156 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 9.950268745422363
The orignal cluster result: num cluster = 1800(model) // 1799(model_ema) 	 num outliers = 34(model) // 34(model_ema)
Applying hierarchical clustering
[ 749  315 1514 ...  499   57  571]
(16522,)
(array([  911,  1063,  1644,  2584,  2754,  2922,  2927,  3404,  3414,
        3873,  3887,  3933,  4334,  5332,  6883,  6957,  7528,  7632,
        7831,  8299,  8697,  9312,  9810, 10205, 10353, 10825, 11059,
       11291, 11798, 13677, 14593, 15407, 15876, 16202]),)
(16522, 16522)
(16488, 16522)
(16488, 16488)
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
reCluster!use silhouette score and tao=0.0
each uncer num= [] average= nan uncer_average= nan
HC finish! Cost time=2.1442127227783203s
The HC Re-cluster result: num cluster = 1800(model) // 1799(model_ema) 	 num outliers = 34(model) // 34(model_ema)
Applying uncertainty-aware collaborative instance selection
UCIS finish! Cost time=0.8673818111419678s
The UCIS result: num clean cluster = 1795(model) 	 num outliers = 164(model)
mdoel:new class are [1796], length of new dataset is 16358
Epoch: [58][0/300]	Time 0.786 (0.786)	Data 0.117 (0.117)	Loss_ce_clean 0.010 	Loss_ct_clean 0.010 	Prec 100.00%
Epoch: [58][50/300]	Time 0.769 (0.769)	Data 0.104 (0.104)	Loss_ce_clean 0.032 	Loss_ct_clean 0.023 	Prec 99.59%
Epoch: [58][100/300]	Time 0.770 (0.769)	Data 0.105 (0.104)	Loss_ce_clean 0.033 	Loss_ct_clean 0.052 	Prec 99.64%
Epoch: [58][150/300]	Time 0.772 (0.769)	Data 0.107 (0.104)	Loss_ce_clean 0.033 	Loss_ct_clean 0.064 	Prec 99.69%
Epoch: [58][200/300]	Time 0.767 (0.769)	Data 0.103 (0.104)	Loss_ce_clean 0.036 	Loss_ct_clean 0.071 	Prec 99.67%
Epoch: [58][250/300]	Time 0.774 (0.770)	Data 0.108 (0.105)	Loss_ce_clean 0.039 	Loss_ct_clean 0.074 	Prec 99.64%
Extract Features: [100/156]	Time 0.156 (0.163)	Data 0.000 (0.007)	
Mean AP: 36.8%
CMC Scores:
  top-1          56.3%
  top-5          70.6%
  top-10         76.5%
Extract Features: [100/156]	Time 0.157 (0.164)	Data 0.000 (0.007)	
Mean AP: 38.9%
CMC Scores:
  top-1          58.1%
  top-5          72.8%
  top-10         78.8%

 * Finished epoch  58  model no.1 mAP: 36.8% model no.2(mean-net) mAP: 38.9%  best: 53.8%

==> Create pseudo labels for unlabeled target domain with model
Extract Features: [100/130]	Time 0.157 (0.164)	Data 0.000 (0.008)	
Computing jaccard distance...
Jaccard distance computing time cost: 10.134936809539795
==> Create pseudo labels for unlabeled target domain with model_ema
